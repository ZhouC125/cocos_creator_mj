{"version":3,"sources":["HallControl.js"],"names":["HallResources","require","HallControl","cc","Class","publicUserInfo","m_gameLib","m_gameList","statics","instance","ctor","PublicUserInfo","Array","m_goodsList","m_chargeInfoList","getPublicUserInfo","getWXUserInfo","m_wxUserInfo","_onLoginDataCallBack","isSucceed","data","jsonObject","JSON","parse","console","log","item","UserID","getInstance","showGoldTips","userDBID","nDiamond","DiamondAmount","email","NewEmail","encryptPassword","EPassword","faceData","nFaceID","Face","nickName","NewNickName","sex","Sex","nGold","Money","vipLevel","VIPLevel","nFrag","FragNum","bankAmount","BankAmount","code","Code","myCode","MyCode","recommandID","HigherUserID","recommandName","HigherNickName","bindSendDiamond","BindSend","paySendDiamond","PaySend","agentPop","AgentPop","agentAuth","AgentAuth","isNewUser","IsNewUser","nPlayerQualifyingScore","Domain","ENV","env","CURRENCYTYPE","currencyType","removeLoading","requestGameList","requestEXchangeList","requestShoppingList","requestTableInfo","recordPlayerLogToServer","recordList","register_success","checkNewStatus","sys","browserType","setMyWxDataToServer","self","callBackFunc","bolSuccess","myOpenId","WeixinManager","userInfo","openid","wxFaceUrl","avatarUrl","wxNickName","setWxUserInfo","loginFinsh","TSCommon","dispatchEvent","onLoginFinish","loginByIMEI","imei","nickname","headUrl","WxAppID","WxOpenID","showLoading","invitePlayerOpenid","wx","getLaunchOptionsSync","query","inviteOpenId","undefined","gender","wxGender","szData","httpRequest","bind","getGameList","getShoppingList","getEXchangeList","exchangeGold","handle","gameID","httpCallback","loglog","result","r","nm","da","length","itemData","table","i","gameInfo","gm","mmgm","ic","mmp","mt","p","pn","rmb","push","GoldMoney","IsCommend","sgm","SendGoldMoney","firstGame","GameInfo","m_iId","GameID","m_sCn","ChineseName","m_sEn","EnglishName","m_iIv","IconVersion","m_sServeIp","ServerIP","m_iPort","Port","m_sVersion","Version","m_sDir","DownloadRoot","m_sWr","WebRoot","CGameLib","createByHall","success","tableBoardInfo"],"mappings":"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","file":"HallControl.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\hall","sourcesContent":["import { CGameLib } from \"./gamelib/CGameLib\";\r\nimport {WeixinManager} from \"../hall/weixin/WeixinManager\";\r\n//import { Object } from \"../../../creator\";\r\nimport {TSCommon} from \"./TSCommon\";\r\nimport {Domain} from \"./Domain\";\r\nvar HallResources = require(\"HallResources\");\r\nvar HallControl = cc.Class({\r\n    publicUserInfo: null,\r\n    m_gameLib: null,\r\n    m_gameList: null,\r\n    statics: {\r\n        instance: null\r\n    },\r\n   \r\n\r\n    ctor: function () {\r\n        var PublicUserInfo = require('PublicUserInfo');\r\n        this.publicUserInfo = new PublicUserInfo();\r\n\r\n        this.m_gameList = new Array();\r\n        this.m_goodsList = new Array();\r\n        this.m_chargeInfoList = new Array();\r\n    },\r\n\r\n    getPublicUserInfo: function () {\r\n        return this.publicUserInfo;\r\n    },\r\n\r\n    getWXUserInfo: function () {\r\n        return this.m_wxUserInfo;\r\n    },\r\n\r\n    //登录数据返回\r\n    _onLoginDataCallBack: function (isSucceed, data) {\r\n        if (isSucceed == true) {\r\n            //注意如果json数据没有解析字段是默认：undefined \r\n\r\n            // var XmlToJson = require('XmlToJson');\r\n            // var xmlToJson = new XmlToJson();\r\n\r\n            // var jsonData = JSON.stringify(xmlToJson.parse(data));\r\n            \r\n            var jsonObject = JSON.parse(data)\r\n            console.log(\"-----------------LoginByIMei.aspx返回数据-------------------------data---\"+data)\r\n            console.log(jsonObject)\r\n            var item = jsonObject[0];\r\n\r\n            if (item.UserID <= 0) {\r\n                console.log(\"_onLoginDataCallBack fail userDBID <= 0\");\r\n                require(\"HallResources\").getInstance().showGoldTips(\"登录失败\",true,false,150);\r\n                return\r\n            }\r\n\r\n            this.publicUserInfo.userDBID =item.UserID;\r\n            this.publicUserInfo.nDiamond = item.DiamondAmount;\r\n            this.publicUserInfo.email = item.NewEmail;\r\n            this.publicUserInfo.encryptPassword = item.EPassword;\r\n            this.publicUserInfo.faceData = null\r\n            this.publicUserInfo.nFaceID = item.Face;\r\n            this.publicUserInfo.nickName = item.NewNickName;        \r\n            this.publicUserInfo.sex = item.Sex;\r\n            this.publicUserInfo.nGold = item.Money;\r\n            this.publicUserInfo.vipLevel = item.VIPLevel;\r\n            this.publicUserInfo.nFrag = item.FragNum;\r\n            this.publicUserInfo.bankAmount = item.BankAmount;\r\n            this.publicUserInfo.code = item.Code;             \r\n            this.publicUserInfo.myCode = item.MyCode;\r\n            this.publicUserInfo.recommandID = item.HigherUserID;\r\n            this.publicUserInfo.recommandName = item.HigherNickName;\r\n            this.publicUserInfo.bindSendDiamond = item.BindSend;\r\n            this.publicUserInfo.paySendDiamond = item.PaySend;\r\n            this.publicUserInfo.agentPop = item.AgentPop;\r\n            this.publicUserInfo.agentAuth = item.AgentAuth;\r\n            this.publicUserInfo.isNewUser = item.IsNewUser;\r\n            this.publicUserInfo.nPlayerQualifyingScore = 0;\r\n            Domain.ENV = item.env;\r\n            Domain.CURRENCYTYPE = item.currencyType;\r\n            // this.publicUserInfo.userDBID = item.UserID;//item.id;\r\n            // this.publicUserInfo.nDiamond = item.DiamondAmount;//d;\r\n            // this.publicUserInfo.nRoomCard = item.ClubCard;//ca;\r\n            // this.publicUserInfo.email = item.NewEmail;//m;\r\n            // this.publicUserInfo.encryptPassword = item.EPassword;//ep;\r\n            // this.publicUserInfo.faceData = item.f;\r\n            // this.publicUserInfo.nFaceID = item.FaceID;//fid;\r\n            // this.publicUserInfo.nickName = item.NewNickName;//item.n;\r\n            // this.publicUserInfo.sex = item.Sex;//item.s;\r\n            // this.publicUserInfo.nGold = item.Money;//mo;\r\n            // this.publicUserInfo.vipLevel = item.VIPLevel;//vl;\r\n            // this.publicUserInfo.nFrag = item.FragNum;//fr;\r\n            // this.publicUserInfo.bankAmount = item.BankAmount;//ba;\r\n            // this.publicUserInfo.code = item.Code;//code;\r\n            // this.publicUserInfo.myCode = item.MyCode;//mcode;\r\n            // this.publicUserInfo.recommandID = item.huid;\r\n            // this.publicUserInfo.recommandName = item.hname;\r\n            // this.publicUserInfo.bindSendDiamond = item.BindSend;//bs;\r\n            // this.publicUserInfo.paySendDiamond = item.PaySend;//ps;\r\n            // this.publicUserInfo.agentPop = item.AgentPop;//ap;\r\n            // this.publicUserInfo.userWords = item.w;\r\n            // this.publicUserInfo.sBindPhone = item.Tel;\r\n            // this.publicUserInfo.nBeanAmount = item.bean;\r\n            // this.publicUserInfo.nLoveliness = item.cmm;\r\n            console.log(\"encryptPassword = \" + this.publicUserInfo.encryptPassword);\r\n            // this.m_gameLib = CGameLib.getInstance();\r\n            // this.m_gameLib.createByHall(this.publicUserInfo,\"dged.ss2007.com\",34100);\r\n            //this.m_gameLib.createByHall(this.publicUserInfo,\"192.168.0.18\",8900);\r\n            require('HallResources').getInstance().removeLoading();\r\n            //this.loginFinsh();\r\n            this.requestGameList();\r\n            this.requestEXchangeList();\r\n            this.requestShoppingList();\r\n            this.requestTableInfo();\r\n            HallResources.recordPlayerLogToServer(HallResources.recordList.register_success);\r\n            require(\"HallWebRequest\").getInstance().checkNewStatus() \r\n            if(cc.sys.browserType == \"mqqbrowser\" || \"wechatgame\" == cc.sys.browserType){\r\n                this.setMyWxDataToServer();\r\n            }\r\n            \r\n        }\r\n        else {\r\n            console.log(\"_onLoginDataCallBack fail\");\r\n        }\r\n    },\r\n\r\n    setMyWxDataToServer:function(){\r\n        var self = this;\r\n        var callBackFunc = function(bolSuccess,data){\r\n            if (bolSuccess) {\r\n                if (bolSuccess) {\r\n                    require('HallResources').getInstance().removeLoading();\r\n                    console.log(\"-----------------WxUserInfoSet.aspx成功----------------------------\")\r\n                }\r\n            }\r\n        };\r\n        var myOpenId = WeixinManager.getInstance().userInfo.openid;\r\n        var wxFaceUrl = WeixinManager.getInstance().userInfo.avatarUrl;\r\n        var wxNickName = WeixinManager.getInstance().userInfo.nickName;\r\n        self.myOpenId = myOpenId;\r\n        require('HallWebRequest').getInstance().setWxUserInfo(myOpenId,wxFaceUrl,wxNickName,callBackFunc);\r\n    },\r\n    loginFinsh: function () {\r\n        require('HallResources').getInstance().removeLoading();\r\n        // cc.director.loadScene('LoadingScene')\r\n        // cc.director.loadScene('HallPlatformScene');\r\n        var HallResources = require('HallResources');\r\n        TSCommon.dispatchEvent(HallResources.onLoginFinish, null)\r\n    },\r\n\r\n    //点击按钮 用IMEI登录游戏\r\n    loginByIMEI: function (imei, nickname, headUrl, WxAppID, WxOpenID) {\r\n        require('HallResources').getInstance().showLoading();\r\n        var headUrl = (headUrl == null ? \"\" : headUrl);\r\n        var WxAppID = (WxAppID == null ? \"\" : WxAppID);\r\n        var WxOpenID = (WxOpenID == null ? \"\" : WxOpenID);\r\n        var invitePlayerOpenid = \"\";\r\n        if(cc.sys.browserType == \"mqqbrowser\" || \"wechatgame\" == cc.sys.browserType){\r\n            \r\n            invitePlayerOpenid = wx.getLaunchOptionsSync().query.inviteOpenId;\r\n            if(invitePlayerOpenid == null || invitePlayerOpenid == undefined)\r\n            {\r\n                invitePlayerOpenid = \"\";\r\n            } \r\n            console.log(\"获得分享玩家的openid\"+invitePlayerOpenid)\r\n        }\r\n        var gender = -1;\r\n        if(cc.sys.browserType == \"mqqbrowser\" || \"wechatgame\" == cc.sys.browserType){\r\n            var wxGender = WeixinManager.getInstance().userInfo.gender; //0:未知1男2女\r\n            console.log(\"获得微信的性别：\"+wxGender);\r\n            //但是我们后台性别不是这样，0=女 1=男 -1=未知，所以这里转换\r\n            if (wxGender == 2){gender = 0}\r\n            else if(wxGender == 1){gender = 1}\r\n            else if(wxGender == 0){gender = -1}\r\n        }\r\n        // var playerFaceUrl= \"https://wx.qlogo.cn/mmopen/vi_32/6ay6OtX1r4lRcLfJUibkhFo09MfCzbO33mAo7ozvZibtYEwG21ESPwbqJ79Cf6mJkAJKdRqbxwmjBWbO5TIiaROMA/132\";\r\n        var szData = \"IMei=\" + imei + \"&NickName=\" + nickname + \"&PartnerID=30001&Version=1&AppID=&OpenID=&AppType=1&InviterOpenID=\"+invitePlayerOpenid+\"&Gender=\"+gender;\r\n        console.log(\"登录信息szData\"+szData)\r\n       \r\n        require('HallWebRequest').getInstance().httpRequest(\"LoginByIMei.aspx\", szData, this._onLoginDataCallBack.bind(this));\r\n    },\r\n\r\n    //获取游戏列表\r\n    getGameList: function () {\r\n        return this.m_gameList;\r\n    },\r\n\r\n    getShoppingList: function () {\r\n        return this.m_goodsList;\r\n    },\r\n    getEXchangeList: function () {\r\n        return this.m_chargeInfoList;\r\n    },\r\n\r\n    exchangeGold: function (nDiamond,handle,gameID){\r\n        var self = this;\r\n        gameID = gameID || 0;\r\n        if (this.publicUserInfo.nDiamond < nDiamond) {\r\n            if (handle) { handle(11) } \r\n            return\r\n        }\r\n        var szData = \"userid=\"+this.publicUserInfo.userDBID+\"&diamond=\"+nDiamond+\"&GameID=\"+gameID+\"&pwd=\"+self.publicUserInfo.encryptPassword+\"&UseGoods=0&AppType=1\";\r\n        var httpCallback =function (isSucceed,data){\r\n            if(!isSucceed) { \r\n                console.loglog(\"HallControl:exchangeGold() failed\"); \r\n                return;\r\n            }\r\n            require('HallResources').getInstance().removeLoading();\r\n            // var XmlToJson = require('XmlToJson');\r\n            // var xmlToJson = new XmlToJson();\r\n            // var jsonData = JSON.stringify(xmlToJson.parse(data));\r\n            // var jsonObject = JSON.parse(jsonData)\r\n\r\n            var jsonObject = JSON.parse(data)\r\n            console.log(\"-----------------DiamondExchangeGold.aspx返回数据----------------------------\")\r\n            console.log(jsonObject)\r\n\r\n            var result= jsonObject.r //操作结果：1=操作成功  11=钻石不足  12=兑换产品不存在\r\n            self.publicUserInfo.nGold = jsonObject.nm\r\n            self.publicUserInfo.nDiamond = jsonObject.da\r\n            if (handle) { \r\n                handle(result); \r\n            }\r\n        }\r\n        console.log(\"DiamondExchangeGold.aspx\"+\"------------------------------\"+szData);\r\n        require('HallWebRequest').getInstance().httpRequest(\"DiamondExchangeGold.aspx\", szData, httpCallback.bind(this));\r\n    },\r\n\r\n    //获取商城产品列表\r\n    requestShoppingList:function (){    \r\n        var self = this; \r\n        if ((self.m_goodsList!=null) && (self.m_goodsList.length>0)) {\r\n            return;\r\n        }\r\n        var szData = \"partnerid=0&version=0&AppType=1\";\r\n        var httpCallback = function (isSucceed,data){\r\n            if(!isSucceed) { \r\n                console.log(\"HallControl:getShoppingList() failed\");\r\n                return;\r\n            }\r\n            require('HallResources').getInstance().removeLoading();\r\n            // var XmlToJson = require('XmlToJson');\r\n            // var xmlToJson = new XmlToJson();\r\n            // var jsonData = JSON.stringify(xmlToJson.parse(data));\r\n            // var jsonObject = JSON.parse(jsonData)\r\n            // var item = jsonObject.items[0];\r\n            var jsonObject = JSON.parse(data)\r\n            console.log(\"-----------------GetDiamondChargeList.aspx返回数据----------------------------\")\r\n            console.log(jsonObject)\r\n            var itemData = jsonObject.table;\r\n            for (var i = 0;i < itemData.length;i++){\r\n                var item = itemData[i];\r\n\r\n                var gameInfo = [];\r\n                gameInfo.gm = item.gm;\r\n                gameInfo.mmgm = item.mmgm;\r\n                gameInfo.ic = item.ic;\r\n                gameInfo.mmp = item.mmp;\r\n                gameInfo.mt = item.mt;\r\n                gameInfo.p = item.p;\r\n                gameInfo.pn = item.pn;\r\n                gameInfo.rmb = item.rmb;\r\n\r\n                if (gameInfo.mt == 1){\r\n                    self.m_goodsList.push(gameInfo);\r\n                }\r\n            }\r\n        }\r\n        console.log(\"GetDiamondChargeList.aspx\"+\"------------------------------\"+szData);\r\n        require('HallWebRequest').getInstance().httpRequest(\"GetDiamondChargeList.aspx\", szData, httpCallback.bind(this));\r\n    },\r\n\r\n    //获取钻石兑换列表\r\n    requestEXchangeList: function () { \r\n        var self = this; \r\n        var httpCallback = function (isSucceed,data){\r\n            if(!isSucceed) {\r\n                console.log(\"HallControl:requestEXchangeList() failed\");\r\n                return;\r\n            }\r\n            require('HallResources').getInstance().removeLoading();\r\n            // var XmlToJson = require('XmlToJson');\r\n            // var xmlToJson = new XmlToJson();\r\n            // var jsonData = JSON.stringify(xmlToJson.parse(data));\r\n            // var jsonObject = JSON.parse(jsonData)\r\n            // var item = jsonObject.items[0];\r\n            var jsonObject = JSON.parse(data)\r\n            console.log(\"-----------------GetDiamondExchangeList.aspx返回数据----------------------------\")\r\n            console.log(jsonObject)\r\n            var itemData = jsonObject.table;\r\n\r\n            for (var i = 0;i < itemData.length;i++){\r\n                var item = itemData[i];\r\n                var gameInfo = [];\r\n                gameInfo.gm = item.GoldMoney;\r\n                gameInfo.da = item.DiamondAmount;\r\n                gameInfo.ic = item.IsCommend;\r\n                gameInfo.sgm = item.SendGoldMoney;\r\n\r\n                self.m_chargeInfoList.push(gameInfo);\r\n            }  \r\n        }\r\n        require('HallWebRequest').getInstance().httpRequest(\"GetDiamondExchangeList.aspx\", \"AppType=1\", httpCallback.bind(this));\r\n    },\r\n\r\n    //请求游戏列表\r\n    requestGameList: function () {\r\n        var szData = \"PartnerID=10&AppType=1\";\r\n        var self = this;\r\n        require('HallWebRequest').getInstance().httpRequest(\"GetGameList.aspx\", szData, function (isSucceed, data) {\r\n            self.loginFinsh();\r\n            if (isSucceed == true) {\r\n                // var XmlToJson = require('XmlToJson');\r\n                // var xmlToJson = new XmlToJson();\r\n                // var jsonData = JSON.stringify(xmlToJson.parse(data));\r\n                // var jsonObject = JSON.parse(jsonData)\r\n                // var item = jsonObject.items[0];\r\n\r\n                require('HallResources').getInstance().removeLoading();\r\n                var jsonObject = JSON.parse(data)\r\n                console.log(\"-----------------GetGameList.aspx返回数据----------------------------\")\r\n                console.log(jsonObject)\r\n                var itemData = jsonObject.table;\r\n\r\n\r\n                var firstGame = null;\r\n                for (var i = 0;i < itemData.length;i++){\r\n                    var item = itemData[i];\r\n                    var gameInfo = new cc.GameInfo();\r\n                    gameInfo.m_iId = item.GameID;\r\n                    gameInfo.m_sCn = item.ChineseName;\r\n                    gameInfo.m_sEn = item.EnglishName;\r\n                    gameInfo.m_iIv = item.IconVersion;\r\n                    gameInfo.m_sServeIp = item.ServerIP;\r\n                    gameInfo.m_iPort = item.Port;\r\n                    gameInfo.m_sVersion = item.Version;\r\n                    gameInfo.m_sDir = item.DownloadRoot;\r\n                    gameInfo.m_sWr = item.WebRoot;\r\n\r\n                    if (firstGame == null) {\r\n                        firstGame = new cc.GameInfo()\r\n                        firstGame = gameInfo\r\n                    }\r\n\r\n                    self.m_gameList.push(gameInfo);\r\n                }\r\n                if (firstGame != null) {\r\n                    console.log(\"requestAllGameServerList \");\r\n                    self.m_gameLib = CGameLib.getInstance();\r\n                    self.m_gameLib.createByHall(self.publicUserInfo, firstGame.m_sServeIp, firstGame.m_iPort);\r\n                }\r\n\r\n            }\r\n            else {\r\n                console.log(\"requestGameList fail\");\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    //获取牌桌信息\r\n    requestTableInfo:function(){\r\n        var self = this;\r\n        var szData = \"UserID=\" + this.publicUserInfo.userDBID + \"&appType=1\"\r\n        var httpCallback = function(success, data){\r\n            require('HallResources').getInstance().removeLoading();\r\n            if(success){\r\n                var jsonObject = JSON.parse(data);\r\n                self.publicUserInfo.tableBoardInfo = jsonObject.table;\r\n            }\r\n        }\r\n        require('HallWebRequest').getInstance().httpRequest(\"GetUserTableBoard.aspx\", szData, httpCallback);\r\n    }\r\n});\r\n\r\nHallControl.getInstance = function () {\r\n    if (HallControl.instance == null) {\r\n        HallControl.instance = new HallControl();\r\n    }\r\n    return HallControl.instance;\r\n};\r\n\r\n"]}