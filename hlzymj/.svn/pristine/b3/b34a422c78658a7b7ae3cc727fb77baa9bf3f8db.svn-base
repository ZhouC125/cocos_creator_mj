{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game/assets\\scripts\\hall\\game\\GameJudge.js"],"names":["GameDefs","require","gameJudge","handCardIsHaveFourSame","vMjPalyer","vTableNum","Array","asNum","i","MAX_MJ_INDEX","cbHoldCardCount","nV","cbHoldCards","push","length","bIsExist","vCardArray","handCardIsHaveThreeSame","nCurrentMjV","vCardValue","handCardIsHaveOneSameToWave","MAX_WEAVE","tagWeaveItem","showCardSuits","cbWeaveKind","WeaveType","Peng","cbCardData","CanShunLeft","cbCard","cbLaizi","HONG_ZHONG","cbCardIndex","CanShunMid","CanShunRight","handCardIsHaveThreeLaiZiPi","laizipiValue","handCardIsHaveTwoLaiZiPi","module","exports"],"mappings":"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","file":"GameJudge.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game","sourcesContent":["var GameDefs = require(\"GameDefs\");\r\n\r\n//游戏判定逻辑\r\nvar gameJudge = {\r\n\r\n};\r\n\r\n\r\n//判定手上是否有四个一样的牌\r\ngameJudge.handCardIsHaveFourSame = function(vMjPalyer){\r\n    var vTableNum = new Array();\r\n    var asNum = new Array();\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        asNum[i] = 0;\r\n    }\r\n\r\n    for(var i = 0; i < vMjPalyer.cbHoldCardCount; i++){\r\n        var nV = vMjPalyer.cbHoldCards[i];\r\n        if(nV < GameDefs.MAX_MJ_INDEX){\r\n            asNum[nV] = asNum[nV] + 1;\r\n        }\r\n    }\r\n\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        if(asNum[i] == 4){\r\n            vTableNum.push(i);\r\n        }\r\n    }\r\n\r\n    if(vTableNum.length > 0){\r\n        return {\r\n            bIsExist:true,\r\n            vCardArray : vTableNum,\r\n        }\r\n    }\r\n\r\n    return {\r\n        bIsExist:false,\r\n        vCardArray : vTableNum,\r\n    }\r\n}\r\n\r\n//判定手上是否有三个一样的牌\r\ngameJudge.handCardIsHaveThreeSame = function(vMjPalyer,nCurrentMjV){\r\n    var asNum = new Array();\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        asNum[i] = 0;\r\n    }\r\n\r\n    for(var i = 0; i < vMjPalyer.cbHoldCardCount; i++){\r\n        var nV = vMjPalyer.cbHoldCards[i];\r\n        if(nV < GameDefs.MAX_MJ_INDEX){\r\n            asNum[nV] = asNum[nV] + 1;\r\n        }\r\n    }\r\n\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        if(asNum[i] == 3 && i == nCurrentMjV){\r\n            return {\r\n                bIsExist : true,\r\n                vCardValue : i,\r\n            }\r\n        }\r\n    }\r\n\r\n    return {\r\n        bIsExist : false,\r\n        vCardValue : -1,\r\n    }\r\n}\r\n\r\n//判定手上是否有一张并且已经碰过的牌\r\ngameJudge.handCardIsHaveOneSameToWave = function(vMjPalyer){\r\n    var vTableNum = new Array();\r\n\r\n    var asNum = new Array();\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        asNum[i] = 0;\r\n    }\r\n\r\n    for(var i = 0; i < vMjPalyer.cbHoldCardCount; i++){\r\n        var nV = vMjPalyer.cbHoldCards[i];\r\n        if(nV < GameDefs.MAX_MJ_INDEX){\r\n            asNum[nV] = asNum[nV] + 1;\r\n        }\r\n    }\r\n\r\n    for(var i = 0; i < GameDefs.MAX_WEAVE; i++){\r\n        var tagWeaveItem = vMjPalyer.showCardSuits[i];\r\n        if(tagWeaveItem.cbWeaveKind == GameDefs.WeaveType.Peng && asNum[tagWeaveItem.cbCardData[0]] == 1){\r\n            vTableNum.push(tagWeaveItem.cbCardData[0]);\r\n        }\r\n    }\r\n\r\n    if(vTableNum.length > 0){\r\n        return {\r\n            bIsExist : true,\r\n            vCardArray : vTableNum,\r\n        }\r\n    }\r\n\r\n    return {\r\n        bIsExist : false,\r\n        vCardArray : vTableNum,\r\n    }\r\n}\r\n\r\n\r\ngameJudge.CanShunLeft = function(cbCard,cbHoldCards,cbHoldCardCount,cbLaizi){\r\n\t//赖子不能吃\r\n\t// if(cbCard == cbLaizi) {\r\n\t// \treturn false\r\n\t// }\r\n\r\n\tif(cbCard >= GameDefs.HONG_ZHONG) {\r\n        return false\r\n    }\r\n\r\n\tif(cbCard % 9 > 6) {\r\n        return false;\r\n    }\r\n\t\t\r\n\r\n    var cbCardIndex = new Array();\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        cbCardIndex[i] = 0;\r\n    }\r\n\t\r\n\r\n\tfor(var i = 0; i < cbHoldCardCount; i++){\r\n\t\tcbCardIndex[cbHoldCards[i]] = cbCardIndex[cbHoldCards[i]] + 1;\r\n    }\r\n\r\n\t// if(cbCardIndex[cbCard+1]>0 && cbCardIndex[cbCard+2]>0 && (cbCard+1) != cbLaizi && (cbCard+2) != cbLaizi){\r\n\t// \treturn true\r\n    // }\r\n\r\n\tif (cbCardIndex[cbCard+1] > 0 && cbCardIndex[cbCard+2] > 0 ){\r\n        return true\r\n    }\r\n\r\n\treturn false\r\n}\r\n\r\ngameJudge.CanShunMid = function(cbCard,cbHoldCards,cbHoldCardCount,cbLaizi){\r\n\t//赖子不能吃\r\n\t// if(cbCard == cbLaizi) {\r\n\t// \treturn false\r\n\t// }\r\n\r\n\tif(cbCard >= GameDefs.HONG_ZHONG) {\r\n        return false\r\n    }\r\n\r\n\tif(cbCard % 9 == 8 || cbCard % 9 == 0) {\r\n        return false\r\n    }\r\n\r\n\r\n    var cbCardIndex = new Array();\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        cbCardIndex[i] = 0;\r\n    }\r\n    \r\n    \r\n    for(var i = 0; i < cbHoldCardCount; i++){\r\n        cbCardIndex[cbHoldCards[i]] = cbCardIndex[cbHoldCards[i]] + 1;\r\n    }\r\n\r\n\r\n\t// if(cbCardIndex[cbCard + 1] > 0 && cbCardIndex[cbCard - 1]>0 && (cbCard+1) != cbLaizi && (cbCard-1) != cbLaizi){\r\n    //     return true\r\n    // }\r\n\t\r\n\r\n\tif (cbCardIndex[cbCard + 1] > 0 && cbCardIndex[cbCard - 1] > 0){\r\n        return true;\r\n    }\r\n\t\t\r\n\treturn false\r\n}\r\n\r\ngameJudge.CanShunRight = function(cbCard,cbHoldCards,cbHoldCardCount,cbLaizi){\r\n\t//赖子不能吃\r\n\t// if(cbCard == cbLaizi) {\r\n\t// \treturn false\r\n\t// }\r\n\r\n\tif(cbCard >= GameDefs.HONG_ZHONG){\r\n\t\treturn false\r\n    }\r\n\r\n\tif(cbCard % 9 < 2){\r\n\t\treturn false\r\n    }\r\n\r\n    var cbCardIndex = new Array();\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        cbCardIndex[i] = 0; \r\n    }\r\n    \r\n    for(var i = 0; i < cbHoldCardCount; i++){\r\n        cbCardIndex[cbHoldCards[i]] = cbCardIndex[cbHoldCards[i]]+1\r\n    }\r\n\r\n\t// if(cbCardIndex[cbCard-1] > 0 && cbCardIndex[cbCard-2] > 0 && (cbCard-1) != cbLaizi && (cbCard-2) != cbLaizi ) {\r\n\t// \treturn true\r\n    // }\r\n\r\n\tif (cbCardIndex[cbCard-1] > 0 && cbCardIndex[cbCard-2] > 0){\r\n        return true\r\n    }\r\n\r\n\treturn false\r\n}\r\n\r\n//是否有三张一样的癞子皮\r\ngameJudge.handCardIsHaveThreeLaiZiPi = function(vMjPalyer, laizipiValue){\r\n    var asNum = new Array();\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        asNum[i] = 0;\r\n    }\r\n\r\n    for(var i = 0; i < vMjPalyer.cbHoldCardCount; i++){\r\n        var nV = vMjPalyer.cbHoldCards[i];\r\n        if(nV < GameDefs.MAX_MJ_INDEX){\r\n            asNum[nV] = asNum[nV] + 1;\r\n        }\r\n    }\r\n\r\n    if(asNum[laizipiValue] == 3){\r\n        return {\r\n            bIsExist : true,\r\n            vCardValue : laizipiValue,\r\n        }\r\n    }\r\n\r\n    return {\r\n        bIsExist : false,\r\n        vCardValue : -1,\r\n    }\r\n}\r\n\r\n//是否有两张一样的癞子皮\r\ngameJudge.handCardIsHaveTwoLaiZiPi = function(vMjPalyer, laizipiValue, nCurrentMjV){\r\n    var asNum = new Array();\r\n    for(var i = 0; i < GameDefs.MAX_MJ_INDEX; i++){\r\n        asNum[i] = 0;\r\n    }\r\n\r\n    for(var i = 0; i < vMjPalyer.cbHoldCardCount; i++){\r\n        var nV = vMjPalyer.cbHoldCards[i];\r\n        if(nV < GameDefs.MAX_MJ_INDEX){\r\n            asNum[nV] = asNum[nV] + 1;\r\n        }\r\n    }\r\n\r\n    if(asNum[laizipiValue] == 2 && laizipiValue == nCurrentMjV){\r\n        return {\r\n            bIsExist : true,\r\n            vCardValue : laizipiValue,\r\n        }\r\n    }\r\n\r\n    return {\r\n        bIsExist : false,\r\n        vCardValue : -1,\r\n    }\r\n}\r\n\r\nmodule.exports = gameJudge"]}