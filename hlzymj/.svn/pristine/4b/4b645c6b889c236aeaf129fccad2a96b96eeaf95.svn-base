{"version":3,"sources":["ListenCardLayer.js"],"names":["GameCfg","require","cc","Class","extends","Component","properties","listenFont","default","type","Font","onLoad","init","tingCardList","tingFan","tingLeft","m_tingCardList","Array","m_tingFan","m_tingLeft","reloadUI","onDestroy","setlaiziValue","laiziValue","m_laiziValue","startX","startY","distanceX","tingcardsNode","node","getChildByName","removeAllChildren","i","length","mjNode","Node","setScale","sprite","addComponent","Sprite","spriteFrame","parent","getComponent","get_face_li_SpriteFrame","x","y","addChild","color","Color","laiziNode","m_mj_hh_li_laizi","zhangNode","setAnchorPoint","p","zhangLabel","Label","font","string","bg2Node","width","setContentSize","size","bg3Node","getContentSize"],"mappings":"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","file":"ListenCardLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\desk","sourcesContent":["\r\nimport { TSCommon } from \"../../TSCommon\";\r\n\r\nvar GameCfg = require(\"GameCfg\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        listenFont: {\r\n            default: null,\r\n            type: cc.Font,\r\n        }\r\n    },\r\n\r\n    //监听将牌抬起的消息\r\n    onLoad: function () {\r\n\r\n        // var self = this;\r\n        // cc.loader.loadRes(\"texture/game/tips/listen_blue\", cc.Atlas, function (error, font) {\r\n        //     self.m_listenFont = font;\r\n\r\n        //     this.reloadUI();\r\n        // })\r\n    },\r\n\r\n    //听牌数据会发生变化的时间是 打出去了某一张 以及自己出牌时候 将牌给抬起的时候\r\n    init: function (tingCardList, tingFan, tingLeft) {\r\n        this.m_tingCardList = tingCardList || new Array();\r\n        this.m_tingFan = tingFan;\r\n        this.m_tingLeft = tingLeft;\r\n\r\n        this.reloadUI();\r\n    },\r\n\r\n    onDestroy: function () {\r\n\r\n    },\r\n\r\n    setlaiziValue: function (laiziValue) {\r\n        this.m_laiziValue = laiziValue;\r\n    },\r\n\r\n    reloadUI: function () {\r\n        var startX = -414\r\n        var startY = -197\r\n        var distanceX = 47;\r\n        var tingcardsNode = this.node.getChildByName(\"ting_cards\");\r\n\r\n        tingcardsNode.removeAllChildren();\r\n\r\n        for (var i = 0; i < this.m_tingCardList.length; i++) {\r\n            var mjNode = new cc.Node();\r\n            mjNode.setScale(0.5);\r\n            var sprite = mjNode.addComponent(cc.Sprite);\r\n            sprite.spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").get_face_li_SpriteFrame(\"mj1\", this.m_tingCardList[i]);\r\n\r\n            mjNode.x = startX + i * distanceX;\r\n\r\n            mjNode.y = startY;\r\n            tingcardsNode.addChild(mjNode);\r\n\r\n            if(this.m_tingLeft[i] == 0){\r\n                mjNode.color = new cc.Color(137, 137, 137);\r\n            }\r\n\r\n            //如果这张牌是癞子 则加上癞子角标\r\n            if (this.m_tingCardList[i] == this.m_laiziValue) {\r\n                var laiziNode = new cc.Node();\r\n\r\n                var sprite = laiziNode.addComponent(cc.Sprite);\r\n                sprite.spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_hh_li_laizi;\r\n\r\n                laiziNode.x = 15.5;\r\n                laiziNode.y = 18.5;\r\n                mjNode.addChild(laiziNode);\r\n            }\r\n\r\n\r\n            var zhangNode = new cc.Node();\r\n            zhangNode.setAnchorPoint(cc.p(0.5, 0.5));\r\n\r\n            var zhangLabel = zhangNode.addComponent(cc.Label);\r\n            zhangLabel.font = this.listenFont;\r\n            zhangLabel.string = this.m_tingLeft[i] + \"张\";\r\n\r\n            zhangNode.x = mjNode.x;\r\n            zhangNode.y = mjNode.y + 35;\r\n            tingcardsNode.addChild(zhangNode);\r\n        }\r\n\r\n        var bg2Node = this.node.getChildByName(\"bg_2\");\r\n        var width = 82 / 2 * this.m_tingCardList.length + (this.m_tingCardList.length + 1) * 6;\r\n        bg2Node.setContentSize(cc.size(width, 90));\r\n\r\n        var bg3Node = this.node.getChildByName(\"bg_3\");\r\n        bg3Node.x = bg2Node.x + bg2Node.getContentSize().width;\r\n        bg3Node.y = bg2Node.y;\r\n    },\r\n\r\n});\r\n"]}