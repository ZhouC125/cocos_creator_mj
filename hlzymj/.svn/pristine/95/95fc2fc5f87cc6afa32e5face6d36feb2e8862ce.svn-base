{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\activity\\consecutiveVictories/assets\\scripts\\hall\\activity\\consecutiveVictories\\ConsecutiveVictoriesItem.js"],"names":["HallResources","require","ConsecutiveVictoriesItem","cc","Class","extends","Component","properties","progressing","default","type","Sprite","progressingBg","winCount","Label","winReward","canGetRewardBtn","Button","onLoad","setProgressing","bol","node","active","initData","data","CanAward","IsGetAward","hasCount","WinCount","string","AwardAmount","onClickRewardBtn","self","callBackFunc","bolSuccess","getInstance","removeLoading","jsonObject","JSON","parse","console","log","backData","retcode","RetCode","awardAmount","goldData","getPublicUserInfo","nGold","parseInt","TSCommon","dispatchEvent","onGoldOrDiamondChanged","onShowFlyMessage","parent","getComponent","updateConsecutiveVictoriesData","openConsecutiveVictoriesReward","getContinuityWinGetAward","module","exports"],"mappings":"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","file":"ConsecutiveVictoriesItem.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\activity\\consecutiveVictories","sourcesContent":["import {TSCommon} from \"TSCommon\";\r\nvar HallResources = require(\"HallResources\");\r\nvar ConsecutiveVictoriesItem = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        progressing: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n        progressingBg: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n        winCount: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        winReward: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        canGetRewardBtn: {\r\n            default: null,\r\n            type: cc.Button,\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad: function () {\r\n    },\r\n\r\n    setProgressing: function (bol) {\r\n        this.progressing.node.active = bol;\r\n        this.progressingBg.node.active = bol;\r\n    },\r\n\r\n    initData:function(data){\r\n        if ((data.CanAward == 1)&&(data.IsGetAward == 0)){\r\n            this.canGetRewardBtn.node.active = true;\r\n        } \r\n        this.hasCount = data.WinCount;\r\n        this.winCount.string = data.WinCount+\"连胜奖励\";\r\n        this.winReward.string = \"x\"+data.AwardAmount;\r\n    },\r\n\r\n    onClickRewardBtn:function(){\r\n        var self = this;\r\n        var callBackFunc = function(bolSuccess,data){\r\n            if (bolSuccess) {\r\n                HallResources.getInstance().removeLoading();\r\n                var jsonObject = JSON.parse(data)\r\n                console.log(\"-----------------ContinuityWinGetAward.aspx返回数据----------------------------\")\r\n                console.log(jsonObject)\r\n                var backData = jsonObject;\r\n                var retcode = backData.RetCode;\r\n                var awardAmount = backData.AwardAmount;\r\n                if (retcode == 1){\r\n                    var goldData = require(\"HallControl\").getInstance().getPublicUserInfo().nGold\r\n                    require(\"HallControl\").getInstance().getPublicUserInfo().nGold = parseInt(awardAmount) + parseInt(goldData);\r\n\r\n                    TSCommon.dispatchEvent(HallResources.onGoldOrDiamondChanged,true);\r\n                    TSCommon.dispatchEvent(HallResources.onShowFlyMessage,[\"+\"+awardAmount,\"texture/hallRes/roomInfo/gold\"]);\r\n                    self.node.parent.parent.parent.getComponent(\"HallPlatformInfo\").updateConsecutiveVictoriesData();\r\n                    self.node.parent.parent.parent.getComponent(\"HallPlatformInfo\").openConsecutiveVictoriesReward(self.hasCount);\r\n                }\r\n                else if(retcode == 11) {\r\n                    console.log(\"密码错误\");\r\n                }\r\n                else if(retcode == 12) {\r\n                    console.log(\"未满足连胜条件\");\r\n                }\r\n                else if(retcode == 13) {\r\n                    console.log(\"重复领取\");\r\n                }\r\n            \r\n               \r\n            }\r\n        };\r\n        require('HallWebRequest').getInstance().getContinuityWinGetAward(this.hasCount,callBackFunc);\r\n    }\r\n});\r\n\r\nmodule.exports = ConsecutiveVictoriesItem;"]}