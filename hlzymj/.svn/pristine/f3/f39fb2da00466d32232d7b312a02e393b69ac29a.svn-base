{"version":3,"sources":["ConsecutiveVictoriesRewardLayer.js"],"names":["HallResources","require","ConsecutiveVictoriesRewardLayer","cc","Class","extends","Component","properties","playerName","default","type","Label","playerTime","playerHead","Sprite","winCount","onLoad","initData","self","winAddCount","loader","loadRes","SpriteFrame","err","spriteFrame","weixinUserInfo","WeixinManager","getInstance","userInfo","avatarUrl","imgurl","load","texture","publicUserInfo","getPublicUserInfo","string","nickName","testDate","Date","time","toLocaleString","onClickSharetBtn","winShareImgUrl","shareWin_3","shareWin_5","shareWin_7","shareWin_9","wx","shareAppMessage","title","imageUrl","success","res","console","log","shareTickets","undefined","TSCommon","dispatchEvent","onShowFlyMessage","closeLayer","fail","onClickNextBtn","node","active","module","exports"],"mappings":"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","file":"ConsecutiveVictoriesRewardLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\activity\\consecutiveVictories","sourcesContent":["import {TSCommon} from \"TSCommon\";\r\nvar HallResources = require(\"HallResources\");\r\nimport {WeixinManager} from \"../../../hall/weixin/WeixinManager\";\r\nvar ConsecutiveVictoriesRewardLayer = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        playerName: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        playerTime: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        playerHead: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n        winCount: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad: function () {\r\n    },\r\n\r\n\r\n    initData:function(winCount)\r\n    {\r\n        var self = this;\r\n        this.winAddCount = winCount\r\n        cc.loader.loadRes(\"texture/activityRes/consecutiveVictories/winCount_\"+winCount,cc.SpriteFrame,function(err,spriteFrame){\r\n            if(!err)\r\n            {   \r\n                self.winCount.spriteFrame = spriteFrame;\r\n            }\r\n        });\r\n\r\n        var weixinUserInfo = WeixinManager.getInstance().userInfo;\r\n        if(weixinUserInfo && weixinUserInfo.avatarUrl){\r\n            var imgurl=weixinUserInfo.avatarUrl+\"?aaa=aa.jpg\";\r\n            cc.loader.load(imgurl, function(err, texture){\r\n                self.playerHead.spriteFrame = new cc.SpriteFrame(texture);\r\n            });\r\n        }\r\n        var publicUserInfo = require(\"HallControl\").getInstance().getPublicUserInfo();\r\n        this.playerName.string = publicUserInfo.nickName;\r\n\r\n        var testDate = new Date();\r\n        var time = testDate.toLocaleString( ); //获取日期与时间\r\n        this.playerTime.string = time;\r\n    },\r\n\r\n    onClickSharetBtn:function(){\r\n        var self = this;\r\n\r\n        var winShareImgUrl = \"\"\r\n        if (self.winAddCount == 3){\r\n            winShareImgUrl = HallResources.shareWin_3;\r\n        }else if (self.winAddCount == 5){\r\n            winShareImgUrl = HallResources.shareWin_5;\r\n        }else if (self.winAddCount == 7){\r\n            winShareImgUrl = HallResources.shareWin_7;\r\n        }else if (self.winAddCount == 8){\r\n            winShareImgUrl = HallResources.shareWin_9;\r\n        }\r\n        wx.shareAppMessage({\r\n            title: \"戳虾子，我已经连胜\"+self.winAddCount+\"盘,本群谁能与我一战！。\",\r\n            imageUrl: winShareImgUrl,\r\n            success(res){\r\n                console.log(\"转发成功!!!\")\r\n                if(res.shareTickets == null || res.shareTickets == undefined || res.shareTickets == \"\"){ //没有群信息，说明分享的是个人\r\n                    TSCommon.dispatchEvent(HallResources.onShowFlyMessage,[\"请分享到群聊\"]);\r\n                }else{ //有群信息\r\n                    console.log(\"下面是群消息数据!!!\")\r\n                    console.log(res);\r\n                    self.closeLayer();\r\n                }\r\n            },\r\n            fail(res){\r\n                console.log(\"转发失败!!!\")\r\n            } \r\n        })\r\n       \r\n    },\r\n\r\n    onClickNextBtn:function(){\r\n        this.closeLayer();\r\n    },\r\n\r\n    closeLayer:function()\r\n    {\r\n        this.node.active = false;\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n\r\nmodule.exports = ConsecutiveVictoriesRewardLayer;"]}