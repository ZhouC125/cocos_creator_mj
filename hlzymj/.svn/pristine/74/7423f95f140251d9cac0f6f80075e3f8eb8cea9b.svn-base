{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\mall/assets\\scripts\\hall\\mall\\MallLayer.js"],"names":["HallResources","require","MallLayer","cc","Class","extends","Component","properties","bg","default","type","Node","goldToggle","Toggle","diamondToggle","mallList","ScrollView","onLoad","node","on","EventType","TOUCH_START","onTouch","showGoldNode","showDiamondNode","event","poisition","touch","getLocation","locationInNode","convertToNodeSpace","s","getContentSize","rect","width","height","rectContainsPoint","closeAndChangeScaleAction","start","self","action1","scaleTo","action2","fadeOut","action3","callFunc","active","TSCommon","dispatchEvent","onChangeShadow","sequence","runAction","clickCloseBtn","getInstance","playCloseEffect","isChecked","getComponent","initData","sys","os","OS_IOS","parent","openIosPlatformShare","module","exports"],"mappings":"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","file":"MallLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\mall","sourcesContent":["import {TSCommon} from \"TSCommon\";\r\nvar HallResources = require(\"HallResources\");\r\nvar MallLayer = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bg: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        goldToggle: {\r\n            default: null,\r\n            type: cc.Toggle,\r\n        },\r\n        diamondToggle: {\r\n            default: null,\r\n            type: cc.Toggle,\r\n        },\r\n        mallList:{\r\n            default: null,\r\n            type: cc.ScrollView,\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad: function () {\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouch, this);\r\n        this.goldToggle.node.on('toggle', this.showGoldNode, this);\r\n        this.diamondToggle.node.on('toggle', this.showDiamondNode, this);\r\n    },\r\n\r\n    onTouch: function (event) {\r\n        var poisition = event.touch.getLocation();\r\n        var locationInNode = this.bg.convertToNodeSpace(poisition);\r\n        var s = this.bg.getContentSize();\r\n        var rect = cc.rect(0, 0, s.width, s.height);\r\n        if (cc.rectContainsPoint(rect, locationInNode)) {\r\n            // this.node.active = true;\r\n        }\r\n        else {\r\n            // this.node.active = false;\r\n            this.closeAndChangeScaleAction();\r\n        }\r\n    },\r\n\r\n    start: function () {\r\n\r\n    },\r\n\r\n    closeAndChangeScaleAction(){\r\n        var self = this;\r\n        // self.node.active = false;\r\n        var action1 = cc.scaleTo(0.2, 0.3, 0.3);\r\n        var action2 =cc.fadeOut(0.01);\r\n        \r\n        var action3 = cc.callFunc(function(){\r\n            self.node.active = false;\r\n            TSCommon.dispatchEvent(HallResources.onChangeShadow,false);\r\n        });\r\n        var sequence = cc.sequence(action1, action2, action3);\r\n        this.node.runAction(sequence);\r\n    },\r\n\r\n    clickCloseBtn: function () {\r\n        HallResources.getInstance().playCloseEffect();\r\n        // this.node.active = false;\r\n        this.closeAndChangeScaleAction();\r\n    },\r\n\r\n\r\n    showGoldNode:function(){\r\n        this.goldToggle.isChecked = true;\r\n        this.diamondToggle.isChecked = false;\r\n        this.mallList.getComponent(\"MallScrollList\").initData(1);\r\n    },\r\n\r\n    showDiamondNode:function(){\r\n        \r\n        if(cc.sys.os == cc.sys. OS_IOS){\r\n            this.closeAndChangeScaleAction();\r\n            this.node.parent.getComponent(\"HallPlatformInfo\").openIosPlatformShare();\r\n        }\r\n        else{\r\n            this.goldToggle.isChecked = false;\r\n            this.diamondToggle.isChecked = true;\r\n            this.mallList.getComponent(\"MallScrollList\").initData(2);\r\n        }\r\n    },\r\n    // update (dt) {},\r\n    \r\n});\r\n\r\nmodule.exports = MallLayer;"]}