{"version":3,"sources":["GameResultLayer.js"],"names":["GameLibSink","require","GameDefs","Resources","cc","Class","extends","Component","properties","PengGangPrefab","default","type","Prefab","START_TAG","onLoad","node","on","Node","EventType","TOUCH_START","onTouch","windowSize","view","getVisibleSize","getChildByName","setContentSize","onDestroy","stopLeaveTimer","event","setWinStructInfo","stWinStruct","playersInfo","stPlayerName","playerAvators","eatParisSpriteFrame","cardSpriteFrame","roomInfo","cbLaizi","leftTime","m_stWinStruct","m_playersInfo","m_stPlayerName","m_playerAvators","m_spriteFrame","m_cardSpriteFrame","m_roomInfo","m_cbLaizi","m_leftTime","m_leaveTimerStop","loadUI","addAvatarAndName","items","i","nPlayerCount","children","active","scoreLabel","getComponent","Label","isSystemFontUsed","nScore","string","self","loader","loadRes","Atlas","error","font","addPairsEatAndPeng","addHuPaiInfo","getIsShare","startLeaveTimer","getSpriteFrameNameByValue","value","get_frameName","nameLabel","addAvatorFace","index","imgurl","load","url","err","texture","Sprite","spriteFrame","SpriteFrame","startX","startY","distanceX","isHuArray","cbWinChair","j","childrenCount","MAX_WEAVE","getChildByTag","removeChildByTag","nWeaveCount","weaveItem","showCardSuits","pairsItem","instantiate","RangeCardLayer","init","cbWeaveKind","cbCardData","x","y","setScale","addChild","cbHoldCardCount","frameName","cbHoldCards","getSpriteFrame","nMingGangArray","nAnGangArray","nXuGangArray","nFangGangArray","PLAYER_COUNT","length","WeaveType","MingGang","XuGang","AnGang","FangGang","cbHuType","HUTYPE_STRING","cbEndType","EndType","Zimo","Fangpao","cbFangpaoChair","gangNum","addCardWall","MAX_LINE_NUM","scale","wallScrollView","viewSize","getContentSize","contentNode","m_fixY","removeAllChildren","cbWall","leftMjNode","sprite","addComponent","frame","Math","floor","height","ScrollView","scrollToTop","leavetimerNode","callback","TSCommon","performWithDelay","getInstance","getGameLib","leaveGameRoom","onLeaveGame","DeskScene","parent","G","matchGameReady","publicUserInfo","getPublicUserInfo","szData","userDBID","httpCallback","success","data","removeLoading","jsonObject","JSON","parse","table","parseInt","IsShareAward","sharBtn","httpRequest","onShareGame","sys","browserType","HallResources","wx","shareAppMessage","title","imageUrl","resultShareImgUrl","res","console","log","onShareFinish","fail","encryptPassword","RetCode","showRewardTips","AwardAmount","refreshGold","onStartGame","getIsPrivateRoom","goldGameReady","GameCfg","dispatchEvent","GAME_RESTART","isReady"],"mappings":"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","file":"GameResultLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\gameOver","sourcesContent":["var GameLibSink = require(\"GameLibSink\");\r\nvar GameDefs = require(\"GameDefs\");\r\nimport { TSCommon } from \"../../TSCommon\";\r\nvar Resources = require(\"Resources\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        PengGangPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n\r\n        START_TAG: 1000,\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouch, this, true);\r\n\r\n        var windowSize=cc.view.getVisibleSize();\r\n        this.node.getChildByName(\"bg\").setContentSize(windowSize);\r\n    },\r\n\r\n    onDestroy: function () {\r\n        this.stopLeaveTimer();\r\n    },\r\n\r\n    onTouch: function (event) {\r\n        //this.node.stop\r\n    },\r\n\r\n    setWinStructInfo(stWinStruct, playersInfo, stPlayerName,  playerAvators, eatParisSpriteFrame, cardSpriteFrame, roomInfo, cbLaizi, leftTime) {\r\n        this.m_stWinStruct = stWinStruct;\r\n        this.m_playersInfo = playersInfo;\r\n        this.m_stPlayerName = stPlayerName;\r\n        this.m_playerAvators = playerAvators;\r\n        this.m_spriteFrame = eatParisSpriteFrame;\r\n        this.m_cardSpriteFrame = cardSpriteFrame;\r\n        this.m_roomInfo = roomInfo;\r\n\r\n        this.m_cbLaizi = cbLaizi;\r\n\r\n        this.m_leftTime = leftTime;\r\n\r\n        this.m_leaveTimerStop = false;\r\n    },\r\n\r\n\r\n    loadUI: function () {\r\n\r\n\r\n\r\n        this.addAvatarAndName();\r\n\r\n        var items = this.node.getChildByName(\"items\");\r\n\r\n        for (var i = 0; i < 4; i++) {\r\n            if (i >= this.m_roomInfo.nPlayerCount) {\r\n                items.children[i].active = false;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < this.m_roomInfo.nPlayerCount; i++) {\r\n            var scoreLabel = items.children[i].getChildByName(\"player_score\");\r\n            scoreLabel.getComponent(cc.Label).isSystemFontUsed = false;\r\n            if (this.m_stWinStruct.nScore[i] >= 0) {\r\n                scoreLabel.getComponent(cc.Label).string = \"+\" + this.m_stWinStruct.nScore[i];\r\n            }\r\n            else {\r\n                scoreLabel.getComponent(cc.Label).string = this.m_stWinStruct.nScore[i];\r\n            }\r\n        }\r\n\r\n        var self = this;\r\n        cc.loader.loadRes(\"texture/game/gameOver/lose\", cc.Atlas, function (error, font) {\r\n            for (var i = 0; i < self.m_roomInfo.nPlayerCount; i++) {\r\n                var scoreLabel = items.children[i].getChildByName(\"player_score\");\r\n                if (self.m_stWinStruct.nScore[i] < 0) {\r\n                    scoreLabel.getComponent(cc.Label).font = font\r\n                }\r\n            }\r\n\r\n        })\r\n\r\n        cc.loader.loadRes(\"texture/game/gameOver/win\", cc.Atlas, function (error, font) {\r\n            for (var i = 0; i < self.m_roomInfo.nPlayerCount; i++) {\r\n                var scoreLabel = items.children[i].getChildByName(\"player_score\");\r\n                if (self.m_stWinStruct.nScore[i] >= 0) {\r\n                    scoreLabel.getComponent(cc.Label).font = font\r\n                }\r\n            }\r\n        })\r\n\r\n        this.addPairsEatAndPeng();\r\n\r\n        this.addHuPaiInfo();\r\n\r\n\r\n        // this.addCardWall();\r\n\r\n        this.getIsShare();\r\n\r\n        this.startLeaveTimer();\r\n    },\r\n\r\n    getSpriteFrameNameByValue: function (value) {\r\n        return Resources.get_frameName(\"hh_li_\", value);\r\n    },\r\n\r\n    //增加头像和名字\r\n    addAvatarAndName: function () {\r\n        var items = this.node.getChildByName(\"items\");\r\n        for (var i = 0; i < this.m_roomInfo.nPlayerCount; i++) {\r\n            var nameLabel = items.children[i].getChildByName(\"player_name\");\r\n            nameLabel.getComponent(cc.Label).string = this.m_stPlayerName[i];        \r\n        }    \r\n        \r\n\r\n        var self = this;\r\n        var addAvatorFace = function(index){\r\n            if(index >= self.m_roomInfo.nPlayerCount){\r\n                return;\r\n            }\r\n            var imgurl = self.m_playerAvators[index];\r\n            if(imgurl){\r\n                cc.loader.load({ url: imgurl, type: \"jpg\" }, function (err, texture) {\r\n                    if(!err){\r\n                        items.children[index].getChildByName(\"face_icon\").getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);                                       \r\n                    }     \r\n                    addAvatorFace(index + 1);               \r\n                });\r\n            }\r\n            else{\r\n                addAvatorFace(index + 1);\r\n            }\r\n        }\r\n\r\n        addAvatorFace(0);\r\n    },\r\n\r\n    addPairsEatAndPeng: function () {\r\n        var items = this.node.getChildByName(\"items\");\r\n\r\n        var startX = -370;\r\n        var startY = 0;\r\n        var distanceX = 100;\r\n\r\n        var isHuArray = [0, 0, 0, 0];\r\n        for (var i = 0; i < 4; i++) {\r\n            if (i == this.m_stWinStruct.cbWinChair) {\r\n                isHuArray[i] = 1;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 4; i++) {\r\n            for (var j = 0; j < items.children[i].getChildByName(\"holds\").childrenCount; j++) {\r\n                items.children[i].getChildByName(\"holds\").children[j].active = false;\r\n            }\r\n            for (var j = 0; j < GameDefs.MAX_WEAVE; j++) {\r\n                if(items.children[i].getChildByTag(this.START_TAG + i * 10 + j)){\r\n                    items.children[i].removeChildByTag(this.START_TAG + i * 10 + j);\r\n                }               \r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 4; i++) {\r\n            for (var j = 0; j < this.m_playersInfo[i].nWeaveCount; j++) {\r\n                var weaveItem = this.m_playersInfo[i].showCardSuits[j];\r\n                var pairsItem = cc.instantiate(this.PengGangPrefab);\r\n                var RangeCardLayer = pairsItem.getComponent('RangeCardLayer');\r\n                RangeCardLayer.init(weaveItem.cbWeaveKind, weaveItem.cbCardData, 1, this.m_spriteFrame);\r\n                pairsItem.x = startX + (j) * distanceX;\r\n                pairsItem.y = startY - 10;\r\n                pairsItem.active = true;\r\n                pairsItem.setScale(0.6)\r\n                items.children[i].addChild(pairsItem, 1, this.START_TAG + i * 10 + j);\r\n            }\r\n\r\n            for (var j = 0; j < this.m_playersInfo[i].cbHoldCardCount; j++) {\r\n                items.children[i].getChildByName(\"holds\").children[j].active = true;\r\n                var frameName = this.getSpriteFrameNameByValue(this.m_playersInfo[i].cbHoldCards[j])\r\n                items.children[i].getChildByName(\"holds\").children[j].getComponent(cc.Sprite).spriteFrame = this.m_cardSpriteFrame.getSpriteFrame(frameName);\r\n                items.children[i].getChildByName(\"holds\").children[j].x = startX + (this.m_playersInfo[i].nWeaveCount) * distanceX - distanceX / 2 + (j) * 45;\r\n                items.children[i].getChildByName(\"holds\").children[j].y = 0;\r\n\r\n                if (isHuArray[i] == 1 && j == this.m_playersInfo[i].cbHoldCardCount - 1) {\r\n                    items.children[i].getChildByName(\"holds\").children[j].x += 45;\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n\r\n    addHuPaiInfo: function () {\r\n\r\n        var items = this.node.getChildByName(\"items\");\r\n\r\n        var isHuArray = [0, 0, 0, 0];\r\n        for (var i = 0; i < 4; i++) {\r\n            if (i == this.m_stWinStruct.cbWinChair) {\r\n                isHuArray[i] = 1;\r\n            }\r\n        }\r\n\r\n        var nMingGangArray = [0, 0, 0, 0];\r\n        var nAnGangArray = [0, 0, 0, 0];\r\n        var nXuGangArray = [0, 0, 0, 0];\r\n        var nFangGangArray = [0, 0, 0, 0];\r\n\r\n        for (var i = 0; i < GameDefs.PLAYER_COUNT; i++) {\r\n            for (var j = 0; j < this.m_playersInfo[i].showCardSuits.length; j++) {\r\n                if (this.m_playersInfo[i].showCardSuits[j].cbWeaveKind == GameDefs.WeaveType.MingGang) {\r\n                    nMingGangArray[i]++;\r\n                }\r\n                else if (this.m_playersInfo[i].showCardSuits[j].cbWeaveKind == GameDefs.WeaveType.XuGang) {\r\n                    nXuGangArray[i]++;\r\n                }\r\n                else if (this.m_playersInfo[i].showCardSuits[j].cbWeaveKind == GameDefs.WeaveType.AnGang) {\r\n                    nAnGangArray[i]++;\r\n                }\r\n                else if (this.m_playersInfo[i].showCardSuits[j].cbWeaveKind == GameDefs.WeaveType.FangGang) {\r\n                    nFangGangArray[i]++;\r\n                }\r\n            }\r\n        }\r\n\r\n        /*\r\n         for(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n             var strHupaiInfo = items.children[i].getChildByName(\"hutypeLabel\").getComponent(cc.Label).string;\r\n \r\n             if(nMingGangArray[i] > 0){\r\n                 if(nMingGangArray[i] > 1){\r\n                     strHupaiInfo += \"接杠*\" + nMingGangArray[i] + \" \";\r\n                 }\r\n                 else{\r\n                     strHupaiInfo += \"接杠\" + \" \";\r\n                 }\r\n             }\r\n             \r\n             if(nAnGangArray[i] > 0){\r\n                 if(nAnGangArray[i] > 1){\r\n                     strHupaiInfo += \"暗杠*\" + nMingGangArray[i] + \" \";\r\n                 }\r\n                 else{\r\n                     strHupaiInfo += \"暗杠\" + \" \";\r\n                 }\r\n             }\r\n \r\n             if(nXuGangArray[i] > 0){\r\n                 if(nXuGangArray[i] > 1){\r\n                     strHupaiInfo += \"续杠*\" + nMingGangArray[i] + \" \";\r\n                 }\r\n                 else{\r\n                     strHupaiInfo += \"续杠\" + \" \";\r\n                 }\r\n             }\r\n \r\n             if(nFangGangArray[i] > 0){\r\n                 if(nFangGangArray[i] > 1){\r\n                     strHupaiInfo += \"放杠*\" + nMingGangArray[i] + \" \";\r\n                 }\r\n                 else{\r\n                     strHupaiInfo += \"放杠\" + \" \";\r\n                 }\r\n             }\r\n \r\n             items.children[i].getChildByName(\"hutypeLabel\").getComponent(cc.Label).string = strHupaiInfo;\r\n         }\r\n         */\r\n\r\n        for (var i = 0; i < 4; i++) {\r\n            if (i == this.m_stWinStruct.cbWinChair && this.m_stWinStruct.cbHuType > 0) {\r\n                items.children[i].getChildByName(\"game_hu_type\").getComponent(cc.Label).string = GameDefs.HUTYPE_STRING[this.m_stWinStruct.cbHuType - 1]\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 4; i++) {\r\n            items.children[i].getChildByName(\"game_over_status\").getComponent(cc.Label).string = \"\";\r\n            if (this.m_stWinStruct.cbEndType == GameDefs.EndType.Zimo) {\r\n                if (isHuArray[i] == 1) {\r\n                    items.children[i].getChildByName(\"game_over_status\").getComponent(cc.Label).string = \"自摸\";\r\n                    items.children[i].getChildByName(\"game_over_status\").x = items.children[i].getChildByName(\"holds\").children[this.m_playersInfo[i].cbHoldCardCount - 1].x\r\n                }\r\n            }\r\n            else if (this.m_stWinStruct.cbEndType == GameDefs.EndType.Fangpao) {\r\n                if (isHuArray[i] == 1) {\r\n                    items.children[i].getChildByName(\"game_over_status\").getComponent(cc.Label).string = \"接炮\";\r\n                }\r\n\r\n                if (i == this.m_stWinStruct.cbFangpaoChair) {\r\n                    items.children[i].getChildByName(\"game_over_status\").getComponent(cc.Label).string = \"放炮\";\r\n                }\r\n\r\n                items.children[i].getChildByName(\"game_over_status\").x = items.children[i].getChildByName(\"holds\").children[this.m_playersInfo[i].cbHoldCardCount - 1].x\r\n            }\r\n            else {\r\n                items.children[i].getChildByName(\"game_over_status\").getComponent(cc.Label).string = \"流局\";\r\n            }\r\n        }\r\n\r\n\r\n\r\n\r\n        for (var i = 0; i < GameDefs.PLAYER_COUNT; i++) {\r\n            var gangNum = 0;//this.m_playersInfo[i].cbCountLaiziGang + this.m_playersInfo[i].cbCountHZGang;\r\n            if (gangNum <= 0) {\r\n                items.children[i].getChildByName(\"gangfan_label\").active = false;\r\n            }\r\n            else {\r\n                items.children[i].getChildByName(\"gangfan_label\").active = true;\r\n                for (var j = 0; j < items.children[i].getChildByName(\"gangcards\").childrenCount; j++) {\r\n                    if (j < gangNum) {\r\n                        items.children[i].getChildByName(\"gangcards\").children[j].active = true;\r\n                        var frameName = this.getSpriteFrameNameByValue(this.m_cbLaizi)\r\n                        items.children[i].getChildByName(\"gangcards\").children[j].getComponent(cc.Sprite).spriteFrame = this.m_cardSpriteFrame.getSpriteFrame(frameName);\r\n                    }\r\n                    else {\r\n                        items.children[i].getChildByName(\"gangcards\").children[j].active = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    //增加牌墙\r\n    addCardWall: function () {\r\n        var MAX_LINE_NUM = 23;\r\n        var scale = 0.6;\r\n\r\n        var wallScrollView = this.node.getChildByName(\"mj_lefts\");\r\n        var viewSize = wallScrollView.getChildByName(\"view\").getContentSize();\r\n        var contentNode = wallScrollView.getChildByName(\"view\").getChildByName(\"content\");\r\n\r\n        if (this.m_roomInfo.nPlayerCount == 3 && !this.m_fixY) {\r\n            wallScrollView.y += 100;\r\n            this.m_fixY = true;\r\n        }\r\n\r\n        contentNode.removeAllChildren();\r\n        var startX = -590;\r\n        var startY = -43;\r\n        for (var i = 0; i < this.m_stWinStruct.cbWall.length; i++) {\r\n\r\n            var leftMjNode = new cc.Node();\r\n            leftMjNode.active = true;\r\n            var sprite = leftMjNode.addComponent(cc.Sprite);\r\n            var frameName = this.getSpriteFrameNameByValue(this.m_stWinStruct.cbWall[i]);\r\n            var frame = this.m_cardSpriteFrame.getSpriteFrame(frameName);\r\n            sprite.spriteFrame = frame;\r\n            leftMjNode.setScale(scale);\r\n            leftMjNode.x = startX + (i % 26) * 79 * scale;\r\n            leftMjNode.y = startY - Math.floor((i) / 26) * leftMjNode.getContentSize().height * scale - 10;\r\n\r\n            contentNode.addChild(leftMjNode);\r\n        }\r\n\r\n        wallScrollView.getComponent(cc.ScrollView).scrollToTop(0.05);\r\n    },\r\n\r\n\r\n    startLeaveTimer: function () {\r\n        var leavetimerNode = this.node.getChildByName(\"leave_timer\");\r\n        leavetimerNode.getComponent(cc.Label).string = this.m_leftTime;\r\n\r\n        var self = this;\r\n        var callback = function () {\r\n            if (self.m_leaveTimerStop) {\r\n                return;\r\n            }\r\n            self.m_leftTime -= 1;\r\n            leavetimerNode.getComponent(cc.Label).string = self.m_leftTime\r\n\r\n            if (self.m_leftTime > 0) {\r\n                TSCommon.performWithDelay(self, callback, 1);\r\n            }\r\n            else {\r\n                require('GameLibSink').getInstance().getGameLib().leaveGameRoom();\r\n            }\r\n        }\r\n\r\n        TSCommon.performWithDelay(this, callback, 1);\r\n    },\r\n\r\n    stopLeaveTimer: function () {\r\n        this.m_leaveTimerStop = true;\r\n    },\r\n\r\n    onLeaveGame: function (event) {\r\n        var DeskScene = this.node.parent.getComponent(\"DeskScene\");\r\n        // if(DeskScene.IsCXZ()){\r\n        //     G.goldGameReady = 3;\r\n        // }\r\n        // else{\r\n        //     G.goldGameReady = 4;\r\n        // }\r\n        G.matchGameReady = false;\r\n        require('GameLibSink').getInstance().getGameLib().leaveGameRoom();\r\n    },\r\n\r\n\r\n    //获取是否已经分享过奖励\r\n    getIsShare:function(){\r\n        var publicUserInfo = require(\"HallControl\").getInstance().getPublicUserInfo();\r\n        var szData = \"UserID=\"+ publicUserInfo.userDBID + \"&apptype=1\";\r\n        var self = this;\r\n        var httpCallback = function(success, data){\r\n            require('HallResources').getInstance().removeLoading();\r\n            if(success){            \r\n                var jsonObject = JSON.parse(data).table[0];\r\n                if(parseInt(jsonObject.IsShareAward) == 1){\r\n                    var sharBtn = self.node.getChildByName(\"share_btn\");\r\n                    sharBtn.getChildByName(\"share_tips\").active = false;\r\n                }\r\n            }\r\n        }\r\n        require('HallWebRequest').getInstance().httpRequest(\"WxDailyShareAwardGetInfo.aspx\", szData, httpCallback);\r\n    },\r\n\r\n    //分享游戏\r\n    onShareGame: function (event) {\r\n        if (cc.sys.browserType == \"mqqbrowser\" || \"wechatgame\" == cc.sys.browserType) {\r\n            var self = this;\r\n            var HallResources = require(\"HallResources\");\r\n            if (cc.sys.browserType == \"mqqbrowser\" || \"wechatgame\" == cc.sys.browserType) {\r\n                wx.shareAppMessage({\r\n\r\n                    title: \"打晃晃，做土豪。湖北人自己的游戏，弟兄伙滴来一把！\",\r\n                    imageUrl: HallResources.resultShareImgUrl,\r\n                    success(res) {\r\n                        console.log(\"转发成功!!!\")\r\n                        self.onShareFinish();\r\n                    },\r\n                    fail(res) {\r\n                        console.log(\"转发失败!!!\")\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    },\r\n\r\n    //直接领取奖励\r\n    onShareFinish: function () {\r\n        var publicUserInfo = require(\"HallControl\").getInstance().getPublicUserInfo();\r\n        var szData = \"UserID=\" + publicUserInfo.userDBID + \"&EPassword=\" + publicUserInfo.encryptPassword + \"&apptype=1\";\r\n\r\n        var self = this;\r\n        var httpCallback = function(success, data){\r\n            require('HallResources').getInstance().removeLoading();\r\n            if(success){\r\n                var jsonObject = JSON.parse(data);\r\n                if(parseInt(jsonObject.RetCode) == 1){\r\n                    Resources.showRewardTips(\"+\" + jsonObject.AwardAmount, true);\r\n                    self.node.parent.getComponent(\"DeskScene\").getGameLib().refreshGold();\r\n                    var sharBtn = self.node.getChildByName(\"share_btn\");\r\n                    sharBtn.getChildByName(\"share_tips\").active = false;\r\n                }\r\n                \r\n            }\r\n        }\r\n\r\n        require('HallWebRequest').getInstance().httpRequest(\"WxDailyShareAwardGetAward.aspx\", szData, httpCallback);\r\n    },\r\n\r\n\r\n    onStartGame: function (event) {\r\n        var DeskScene = this.node.parent.getComponent(\"DeskScene\");\r\n\r\n        if(DeskScene && DeskScene.getIsPrivateRoom()){\r\n            G.matchGameReady = true;\r\n            G.goldGameReady = null;\r\n            require('GameLibSink').getInstance().getGameLib().leaveGameRoom();\r\n        }\r\n        else{\r\n\r\n            G.matchGameReady = false;\r\n            this.node.active = false;\r\n            var GameCfg = require(\"GameCfg\");\r\n            TSCommon.dispatchEvent(GameCfg.GAME_RESTART, {isReady : true});\r\n        } \r\n    },\r\n\r\n});\r\n"]}