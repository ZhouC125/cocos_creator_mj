{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\desk/assets\\scripts\\hall\\game\\desk\\MoreSettingLayer.js"],"names":["GameCfg","require","cc","Class","extends","Component","properties","bg","default","type","Node","settingLayer","helperLayer","onLoad","init","node","on","EventType","TOUCH_START","onTouch","size","getContentSize","prePos","getPosition","setPosition","p","x","width","y","active","event","point","touch","getLocation","convertPoint","convertToNodeSpace","rect","height","rectContainsPoint","hide","start","show","stopAllActions","self","destPos","moveTo","runAction","onMoveEnd","callFunc","sequence","onLeaveClicked","DeskScene","parent","getComponent","getIsPrivateRoom","G","matchGameReady","goldGameReady","getInstance","getGameLib","leaveGameRoom","onChangedDeskClicked","autoSit","TSCommon","dispatchEvent","GAME_RESTART","isReady","onHelpClicekd","onRobotClicked","NOTIFICATION_ROBOT","onSettingClicked","setLeaveBtnEnabled","bEnabled","getChildByName","Button","interactable","setChangedDeskBtnEnabled"],"mappings":"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","file":"MoreSettingLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\desk","sourcesContent":["import {TSCommon} from \"../../TSCommon\";\r\nvar GameCfg = require(\"GameCfg\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bg: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        settingLayer: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        helperLayer: {\r\n            default: null,\r\n            type: cc.Node,\r\n        }\r\n    },\r\n\r\n    //界面载入\r\n    onLoad: function () {\r\n        this.init();\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouch, this);\r\n    },\r\n\r\n    init: function () {\r\n\r\n        var size = this.bg.getContentSize();\r\n\r\n        this.prePos = this.node.getPosition();\r\n\r\n        this.node.setPosition(cc.p(this.prePos.x - size.width, this.prePos.y))\r\n\r\n        this.settingLayer.active = false;\r\n\r\n        this.helperLayer.active = false;\r\n    },\r\n\r\n    onTouch: function (event) {\r\n        var point = event.touch.getLocation();\r\n        var convertPoint = this.bg.convertToNodeSpace(point);\r\n        var size = this.bg.getContentSize();\r\n        var rect = cc.rect(0, 0, size.width, size.height);\r\n\r\n        if (!cc.rectContainsPoint(rect, convertPoint)) {\r\n            this.hide();\r\n        }\r\n    },\r\n\r\n    start: function () {\r\n\r\n    },\r\n\r\n\r\n    show: function () {\r\n\r\n        this.node.active = true;\r\n\r\n        this.node.stopAllActions();\r\n\r\n        var self = this;\r\n\r\n        //运行动画\r\n        var size = this.bg.getContentSize();\r\n\r\n        var destPos = cc.p(this.prePos.x, this.prePos.y);\r\n\r\n        var moveTo = cc.moveTo(0.2, destPos);\r\n\r\n        this.node.runAction(moveTo);\r\n    },\r\n\r\n    hide: function () {\r\n        //运行隐藏动画\r\n        this.node.stopAllActions();\r\n\r\n        var self = this;\r\n\r\n        var size = this.bg.getContentSize();\r\n\r\n        var destPos = cc.p(this.prePos.x - size.width, this.prePos.y);\r\n\r\n        var moveTo = cc.moveTo(0.2, destPos);\r\n\r\n        var onMoveEnd = function () {\r\n            self.node.active = false;\r\n        }\r\n        var callFunc = cc.callFunc(onMoveEnd, this)\r\n\r\n        var sequence = cc.sequence(moveTo, callFunc);\r\n\r\n        this.node.runAction(sequence);\r\n    },\r\n\r\n\r\n    onLeaveClicked: function () {\r\n        var DeskScene = this.node.parent.getComponent(\"DeskScene\");\r\n        \r\n        if(DeskScene.getIsPrivateRoom()){\r\n            G.matchGameReady = true;\r\n            G.goldGameReady = null;\r\n        }\r\n        else{\r\n            G.matchGameReady = false;\r\n            // if(DeskScene.IsCXZ()){\r\n            //     G.goldGameReady = 3;\r\n            // }\r\n            // else{\r\n            //     G.goldGameReady = 4;\r\n            // }\r\n        }\r\n        \r\n        // cc.log(\"onLeaveClicked -----\");\r\n        require('GameLibSink').getInstance().getGameLib().leaveGameRoom();\r\n        this.hide();\r\n    },\r\n\r\n    onChangedDeskClicked: function () {\r\n        require('GameLibSink').getInstance().getGameLib().autoSit();\r\n        TSCommon.dispatchEvent(GameCfg.GAME_RESTART, {isReady : false});\r\n        this.hide();\r\n    },\r\n\r\n    onHelpClicekd: function () {\r\n        this.helperLayer.active = true;\r\n\r\n        this.hide();\r\n    },\r\n\r\n    onRobotClicked: function () {\r\n        //如果游戏未开始 则不能托管\r\n\r\n        // var sendCMD = require(\"sendCMD\");\r\n        // sendCMD.sendCMD_PO_ROBOTPLAYSTART()\r\n        TSCommon.dispatchEvent(GameCfg.NOTIFICATION_ROBOT, null);\r\n        this.hide();\r\n    },\r\n\r\n    onSettingClicked: function () {\r\n        this.settingLayer.active = true;\r\n        // var action =cc.fadeIn(0.01);\r\n        // var action2 = cc.scaleTo(0.2, 1, 1);\r\n        // var sequence = cc.sequence(action, action2);\r\n        // this.settingLayer.runAction(sequence);\r\n        this.hide();\r\n    },\r\n\r\n    //设置离开按钮enable属性\r\n    setLeaveBtnEnabled:function(bEnabled){\r\n        this.node.getChildByName(\"leave_game_btn\").getComponent(cc.Button).interactable = bEnabled;\r\n    },\r\n\r\n    //设置换桌按enable属性\r\n    setChangedDeskBtnEnabled:function(bEnabled){\r\n        this.node.getChildByName(\"change_desk_btn\").getComponent(cc.Button).interactable = bEnabled;\r\n    },\r\n\r\n\r\n\r\n});\r\n"]}