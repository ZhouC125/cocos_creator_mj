{"version":3,"sources":["Chatting.js"],"names":["Resources","require","GameCfg","cc","Class","extends","Component","properties","bg","default","type","Node","onLoad","init","node","on","EventType","TOUCH_START","onTouch","size","getContentSize","prePos","getPosition","setPosition","p","x","width","y","event","log","point","touch","getLocation","convertPoint","convertToNodeSpace","rect","height","rectContainsPoint","hide","show","active","stopAllActions","self","destPos","moveTo","runAction","onMoveEnd","callFunc","sequence","sendChat","lpszMsg","nResult","getInstance","getGameLib","sendTableChat","GameCmds","SEND_TABLE_CHAT_OFFLINE","SEND_TABLE_CHAT_NULL_CONTENT","SEND_TABLE_CHAT_BUSY","TSCommon","dispatchEvent","sendChatEnd","onSendFaceClicked","faceID","msg","onSendWordsClicked","wordID","QUICK_SEND_CHATS"],"mappings":"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","file":"Chatting.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\chat","sourcesContent":["import {GameCmds} from \"../../gamelib/room/GameCmds\"\r\nimport {TSCommon} from \"../../TSCommon\";\r\nvar Resources = require(\"Resources\");\r\nvar GameCfg = require(\"GameCfg\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bg:{\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n    },\r\n\r\n    \r\n    //界面载入\r\n    onLoad: function () {\r\n        this.init();\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouch, this);\r\n    },\r\n\r\n    init:function(){\r\n\r\n        var size = this.bg.getContentSize();\r\n\r\n        this.prePos = this.node.getPosition();\r\n\r\n        this.node.setPosition(cc.p(this.prePos.x + size.width, this.prePos.y))\r\n\r\n    },\r\n\r\n    onTouch: function (event) {\r\n        cc.log(\"onTouch\");\r\n        var point = event.touch.getLocation();\r\n\r\n        var convertPoint = this.bg.convertToNodeSpace(point);\r\n\r\n        var size = this.bg.getContentSize();\r\n        \r\n        var rect = cc.rect(0, 0, size.width, size.height);\r\n\r\n        if (!cc.rectContainsPoint(rect, convertPoint)) {          \r\n            this.hide();\r\n        }\r\n    },\r\n\r\n    show: function(){\r\n        this.node.active = true;\r\n\r\n        this.node.stopAllActions();\r\n\r\n        var self = this;\r\n\r\n        //运行动画\r\n        var size = this.bg.getContentSize();\r\n\r\n        var destPos = cc.p(this.prePos.x, this.prePos.y);\r\n\r\n        var moveTo = cc.moveTo(0.2, destPos);\r\n\r\n        this.node.runAction(moveTo);\r\n    },\r\n\r\n    hide: function(){\r\n        this.node.stopAllActions();\r\n\r\n        var self = this;\r\n\r\n        var size = this.bg.getContentSize();\r\n\r\n        var destPos = cc.p(this.prePos.x + size.width, this.prePos.y);\r\n\r\n        var moveTo = cc.moveTo(0.2, destPos);\r\n\r\n        var onMoveEnd = function () {\r\n            self.node.active = false;           \r\n        }\r\n        var callFunc = cc.callFunc(onMoveEnd, this)\r\n\r\n        var sequence = cc.sequence(moveTo, callFunc);\r\n\r\n        this.node.runAction(sequence);\r\n    },\r\n\r\n    sendChat:function(lpszMsg){\r\n\r\n        var nResult = require('GameLibSink').getInstance().getGameLib().sendTableChat(lpszMsg);\r\n        this.node.active = false;\r\n\r\n        if(nResult == GameCmds.SEND_TABLE_CHAT_OFFLINE){\r\n\r\n        }\r\n        else if(nResult == GameCmds.SEND_TABLE_CHAT_NULL_CONTENT){\r\n\r\n        }\r\n        else if(nResult == GameCmds.SEND_TABLE_CHAT_BUSY){\r\n\r\n        }\r\n        else{\r\n            TSCommon.dispatchEvent(GameCfg.sendChatEnd, null);\r\n        }\r\n\r\n        return nResult;\r\n    },\r\n\r\n    onSendFaceClicked:function(event, faceID){\r\n        // console.log(\"faceID =====\"+faceID);\r\n\r\n        var msg = \"--:\" + (faceID - 1);\r\n        this.sendChat(msg);\r\n\r\n        this.hide();\r\n\r\n    },\r\n\r\n    onSendWordsClicked: function(event, wordID){\r\n        // console.log(\"wordID =====\" + wordID);\r\n        var msg = Resources.QUICK_SEND_CHATS[wordID];\r\n        this.sendChat(msg);\r\n\r\n        this.hide();\r\n\r\n    },\r\n\r\n\r\n});\r\n"]}