{"version":3,"sources":["inviteFriendLayer.js"],"names":["HallResources","require","inviteFriendLayer","cc","Class","extends","Component","properties","bg","default","type","Node","getRewardBtn","Button","getRewardGrayBtn","inviteBtnPrefab","Prefab","startTime","Label","endTime","hasGet","onLoad","node","on","EventType","TOUCH_START","onTouch","inviteCount","event","poisition","touch","getLocation","locationInNode","convertToNodeSpace","s","getContentSize","rect","width","height","rectContainsPoint","closeAndChangeScaleAction","initData","data","string","initFriendData","self","imageUrl","img","tbData","x","y","bGetGift","openIdFriendList","openIdFriendData","myOpenId","i","length","InviteeOpenID","callbackFunc","console","log","shareToFriend","InviterOpenID","IsInviterGift","push","gold","InviterGiftAmount","fun","bolSuccess","getInstance","removeLoading","jsonObject","JSON","parse","table","headUrl","WxFaceUrl","imgurl","invitePrefab","instantiate","parent","getComponent","setPosition","getWxUserInfo","active","start","clickGetRewardBtn","requestTableInfo","callFunc","RetCode","shift","goldData","getPublicUserInfo","nGold","parseInt","AwardAmount","TSCommon","dispatchEvent","onGoldOrDiamondChanged","onShowFlyMessage","getWxInviteAwardGetAward","sys","browserType","myopenId","WeixinManager","userInfo","openid","wx","shareAppMessage","query","title","shareImgUrl","success","res","fail","clickSummonFriendsBtn","showToast","clickCloseBtn","playCloseEffect","action1","scaleTo","action2","fadeOut","action3","onChangeShadow","sequence","runAction","setHasGetDesk","bol","module","exports"],"mappings":"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","file":"inviteFriendLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\activity\\inviteFriend","sourcesContent":["\r\nimport {WeixinManager} from \"../../../hall/weixin/WeixinManager\";\r\nimport {TSCommon} from \"../../TSCommon\";\r\nvar HallResources = require(\"HallResources\");\r\nvar inviteFriendLayer = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bg: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        getRewardBtn: {\r\n            default: null,\r\n            type: cc.Button,\r\n        },\r\n        getRewardGrayBtn: {\r\n            default: null,\r\n            type: cc.Button,\r\n        },\r\n        inviteBtnPrefab:{\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        startTime: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        endTime: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        hasGet: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad: function () {\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouch, this);\r\n        this.inviteCount = 0;\r\n    },\r\n\r\n    onTouch: function (event) {\r\n        var poisition = event.touch.getLocation();\r\n        var locationInNode = this.bg.convertToNodeSpace(poisition);\r\n        var s = this.bg.getContentSize();\r\n        var rect = cc.rect(0, 0, s.width, s.height);\r\n        if (cc.rectContainsPoint(rect, locationInNode)) {\r\n            // this.node.active = true;\r\n        }\r\n        else {\r\n            // this.node.active = false;\r\n            this.closeAndChangeScaleAction();\r\n        }\r\n    },\r\n\r\n    initData:function(data)\r\n    {   \r\n        this.startTime.string = data.startTime;\r\n        this.endTime.string = data.endTime;\r\n        \r\n    },\r\n\r\n    initFriendData:function(data)\r\n    {\r\n        var self = this;\r\n        this.imageUrl = data.img;\r\n        var tbData = [];\r\n        tbData[0] = [];\r\n        tbData[1] = [];\r\n        tbData[2] = [];\r\n        tbData[0].x = -330;\r\n        tbData[0].y = 40;\r\n        tbData[1].x = -145;\r\n        tbData[1].y = -20;\r\n        tbData[2].x = 25;\r\n        tbData[2].y = 80;\r\n        var bGetGift = false;\r\n        var openIdFriendList = \"\";\r\n        self.openIdFriendData = [];\r\n        self.myOpenId = \"\";\r\n        for (var i = 0;i < data.length;i++){\r\n            if(data[i].InviteeOpenID == \"undefined\" || data[i].InviteeOpenID == null || data[i].InviteeOpenID == \"\"){\r\n                //如果没有被邀请的好友的openID,说明不需要去拿到好友头像，而且按钮需要分享功能\r\n                tbData[i].callbackFunc = function(){\r\n                    console.log(\"点击第\"+i+\"个\");\r\n                    self.shareToFriend();\r\n                };\r\n            }else{\r\n                self.myOpenId = data[i].InviterOpenID;\r\n                if (openIdFriendList == \"\")\r\n                {\r\n                    openIdFriendList = data[i].InviteeOpenID;\r\n                }else{\r\n                    openIdFriendList = openIdFriendList + \",\" + data[i].InviteeOpenID;\r\n                }\r\n                \r\n                //有邀请好友ID，并且没有领取过\r\n                bGetGift = bGetGift || (data[i].IsInviterGift == 0);\r\n                if (data[i].IsInviterGift == 0){\r\n                    self.openIdFriendData.push(data[i].InviteeOpenID)\r\n                }\r\n            }\r\n            tbData[i].gold = data[i].InviterGiftAmount;\r\n            \r\n        }\r\n        \r\n        \r\n        self.data = data;\r\n        self.tbData = tbData;\r\n\r\n        var fun = function(bolSuccess,data){\r\n            if (bolSuccess) {\r\n                if (bolSuccess) {\r\n                    HallResources.getInstance().removeLoading();\r\n                    var jsonObject = JSON.parse(data)\r\n                    console.log(\"-----------------WxUserInfoGet.aspx返回数据----------------------------\")\r\n                    console.log(jsonObject)\r\n                    for (var i = 0;i<jsonObject.table.length;i++)\r\n                    {\r\n                        var headUrl = jsonObject.table[i].WxFaceUrl + \"?aaa=aa.jpg\";\r\n                        self.tbData[i].imgurl = headUrl;\r\n                    }\r\n                }\r\n            }\r\n            for (var i = 0;i<self.data.length;i++)\r\n            {\r\n                var invitePrefab = cc.instantiate(self.inviteBtnPrefab);\r\n                invitePrefab.parent = self.node;\r\n                invitePrefab.getComponent(\"inviteFriendItem\").initData(self.tbData[i]);   \r\n                invitePrefab.setPosition(self.tbData[i].x,self.tbData[i].y); \r\n            }\r\n        }\r\n        console.log(\"被邀请者的id列表\"+openIdFriendList)\r\n        require('HallWebRequest').getInstance().getWxUserInfo(openIdFriendList,fun);\r\n\r\n        if(bGetGift){\r\n            //按钮设置为可以点击\r\n            self.getRewardGrayBtn.node.active = false;\r\n            self.getRewardBtn.node.active = true;\r\n        };\r\n    },\r\n\r\n    start: function () {\r\n\r\n    },\r\n\r\n    clickGetRewardBtn:function (){\r\n\r\n        require(\"HallControl\").getInstance().requestTableInfo();\r\n        var self = this;\r\n        var callFunc = function(bolSuccess,data){\r\n            if (bolSuccess) {\r\n                if (bolSuccess) {\r\n                    HallResources.getInstance().removeLoading();\r\n                    var jsonObject = JSON.parse(data)\r\n                    console.log(\"-----------------WxUserInfoGet.aspx返回数据----------------------------\")\r\n                    console.log(jsonObject)\r\n                    if (jsonObject.RetCode == 1){\r\n                        self.openIdFriendData.shift()\r\n                        if (self.openIdFriendData.length == 0){\r\n                            self.getRewardGrayBtn.node.active = true;\r\n                             self.getRewardBtn.node.active = false;\r\n                        }\r\n                        var goldData = require(\"HallControl\").getInstance().getPublicUserInfo().nGold\r\n                        require(\"HallControl\").getInstance().getPublicUserInfo().nGold = parseInt(jsonObject.AwardAmount) + parseInt(goldData);\r\n    \r\n                        TSCommon.dispatchEvent(HallResources.onGoldOrDiamondChanged,true);\r\n                        TSCommon.dispatchEvent(HallResources.onShowFlyMessage,[\"+\"+jsonObject.AwardAmount,\"texture/hallRes/roomInfo/gold\"]);\r\n                    }\r\n                    else if(jsonObject.RetCode == 11) {\r\n                        console.log(\"没有邀请关系\");\r\n                    }\r\n                    else if(jsonObject.RetCode == 12) {\r\n                        console.log(\"重复领取\");\r\n                    }\r\n                    else if(jsonObject.RetCode == 13) {\r\n                        console.log(\"领奖账户不存在\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (self.openIdFriendData.length > 0){\r\n            require('HallWebRequest').getInstance().getWxInviteAwardGetAward(self.myOpenId,self.openIdFriendData[0],callFunc);\r\n        }\r\n    },\r\n\r\n    shareToFriend:function (){\r\n        if(cc.sys.browserType == \"mqqbrowser\" || \"wechatgame\" == cc.sys.browserType){\r\n            //主动拉起分享接口\r\n            var myopenId = WeixinManager.getInstance().userInfo.openid;\r\n                wx.shareAppMessage({\r\n                    query: \"inviteOpenId=\"+myopenId,\r\n                    title: \"牌都跟你码好了，快来打晃晃撒！\",\r\n                    imageUrl: HallResources.shareImgUrl,\r\n                    success(res){\r\n                        console.log(\"转发成功!!!\")\r\n                    },\r\n                    fail(res){\r\n                        console.log(\"转发失败!!!\")\r\n                    } \r\n                })\r\n        }\r\n    },\r\n\r\n    clickSummonFriendsBtn:function (){\r\n        wx.shareAppMessage({\r\n            query: \"inviteOpenId=\"+myopenId,\r\n            title: \"牌都跟你码好了，快来打晃晃撒！\",\r\n            imageUrl: HallResources.shareImgUrl,\r\n            success(res){\r\n                console.log(\"转发成功!!!\");\r\n                wx.showToast({\r\n                    title: '转发成功',\r\n                })\r\n            },\r\n            fail(res){\r\n                console.log(\"转发失败!!!\");\r\n            } \r\n        });\r\n    },\r\n\r\n    clickCloseBtn: function () {\r\n        HallResources.getInstance().playCloseEffect();\r\n        // this.node.active = false;\r\n        this.closeAndChangeScaleAction();\r\n    },\r\n\r\n    closeAndChangeScaleAction(){\r\n        var self = this;\r\n        // self.node.active = false;\r\n        var action1 = cc.scaleTo(0.2, 0.3, 0.3);\r\n        var action2 =cc.fadeOut(0.01);\r\n        \r\n        var action3 = cc.callFunc(function(){\r\n            self.node.active = false;\r\n            TSCommon.dispatchEvent(HallResources.onChangeShadow,false);\r\n        });\r\n        var sequence = cc.sequence(action1, action2, action3);\r\n        this.node.runAction(sequence);\r\n    },\r\n\r\n    setHasGetDesk:function(bol){\r\n        this.hasGet.active = bol;\r\n    },\r\n    // update (dt) {},\r\n});\r\n\r\nmodule.exports = inviteFriendLayer;"]}