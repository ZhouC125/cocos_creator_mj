{"version":3,"sources":["PlayerCardLayer.js"],"names":["GameDefs","require","Resources","GameCfg","cc","Class","extends","Component","properties","PengGangPrefab","default","type","Prefab","gangMoreSelectPrefab","arrowSpriteFrame","SpriteFrame","ArrowTag","m_nQueYiMenStyleType","onLoad","setTouchMjEnable","init","holdCardRootNode","node","getChildByName","threeMjValueList","Array","m_saveMjGroupCard","m_actionState","PlayerAction","paNothing","m_selfOriginalPosY","children","y","m_selfOriginalPosX","x","parent","on","Node","EventType","TOUCH_START","onTouchBegan","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","onCancel","event","m_nPos","pos","touch","getLocation","m_touchMoved","m_touchPoint","touchIndex","i","childrenCount","convertPos","convertToNodeSpace","size","getContentSize","rect","width","height","contains","active","m_TouchIndex","prePos","getPreviousLocation","touchMj","touchMjPos","p","getPosition","pDistanceSQ","offsetVec","m_moveMj","desPos","sprite","addComponent","Sprite","spriteFrame","getComponent","setAnchorPoint","addChild","Math","abs","cardValue","removeFromParent","getIsGameChangeMjing","getIsGameRunning","TSCommon","dispatchEvent","unSelectedMj","retsetAllHandCardPos","onChooseMjClicked","onMjClicked","canOutCard","undefined","sendCMD_PO_OUTCARD","removeAllCardArrow","isFirstOutCard","recordFirstOutCardToServer","vCardList","NOTIFICATION_LISTENCARD","setScale","resetAllHandCardPosWithNoDiff","holdCardsNode","m_playerMjs","cbHoldCardCount","setCanOutCard","setPlayerMj","PlayerMj","setmjLaiziValue","laiziValue","m_laiziValue","setmjLaizipiValue","laizipiValue","m_laizipiValue","setPlayerPos","nPos","setActionState","actionState","setPlayerMjFrameByNode","bolMove","getLastHandCard","MAX_HOLD_CARD","doCards","bFreshPutCard","bolHu","putPairsAndEatMj","isHandCardNeedRefresh","putSelfHandCards","putRightHandCards","putTopHandCards","putLeftHandCards","setEndCardPosByPosAndStated","saveHandCards","setGrayForCannotUpCard","getOneMj","mjCardValue","preCount","length","cbHoldCards","get_face_li_SpriteFrame","removeAllChildren","playCommonEffect","vOutCardList","m_stSceneData","vTingList","j","index","cbOutCard","arrowNode","arrowSprite","push","setQueYiMenMjGray","bIsSetPos","addPos","paGang","paOutCard","cardCount","holdCards","bRefresh","paPeng","paEat","bFind","holdCardCount","getStyleBySort","self","sort","a","b","startX","distanceX","MAX_MJ_INDEX","getChildByTag","clickIndex","holds","getCanUpCardBySelectCount","selectedMj","recordFirstClickCardToServer","isFirst","cbOutCards","HallResources","recordPlayerLogToServer","recordList","click_card","click_discard","gangMoresCardToast","gangInfoArray","selectEatNode","onGangSelectFinish","startY","gangMoreSelectItem","instantiate","gangMoreSelectItemView","spriteAtlas","mj1_face_dao","showUI","removeEatOrGangMoresCardToast","getRangeSpriteFrameByPos","mj1_face_suit_y","mj1_face_suit_z","log","getCardSpriteFrame","mjFrame","m_pengGangArray","pengGangRootNode","pairsItem","cardSuit","distanceY","scale","nWeaveCount","showCardSuits","cbWeaveKind","WeaveType","AnGang","XuGang","MingGang","RangeCardLayer","cbCardData","setMjGray","mjNode","color","Color","gameOver","showHandCardOnGameOver","foreName","name","get_frameName","getSpriteFrame","getIsWinner","cleanAllMjs","offset","getWanTiaoTongCount","typeCountList","wanCount","tiaoCount","tongCount","nType","getMjColor","getChooseMjTypeByCount","bolChooseDingQue","upThreeCardByType","tipUpType","upCount","insertThreeCard","cbList","nTempList","moveHeight","nRandom","getOneRandom","pMjOrginPosY","action","delayTime","action2","callFunc","sp","runAction","moveTo","sequence","deleteThreeMjRefresh","leg","targetKeys","getThreeUpCradList","splice","count","setQueYiMenStyleType","nStyleType","bol","indexOf"],"mappings":";;;;;;AAEA;;AAFA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,YAAYD,QAAQ,WAAR,CAAhB;;AAEA,IAAIE,UAAUF,QAAQ,SAAR,CAAd;AACAG,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;;AAER;AACAC,wBAAgB;AACZC,qBAAS,IADG;AAEZC,kBAAMP,GAAGQ;AAFG,SAHR;;AAQR;AACAC,8BAAsB;AAClBH,qBAAS,IADS;AAElBC,kBAAMP,GAAGQ;AAFS,SATd;;AAcRE,0BAAkB;AACdJ,qBAAS,IADK;AAEdC,kBAAMP,GAAGW;AAFK,SAdV;;AAmBRC,kBAAU,IAnBF;AAoBRC,8BAAqB,CAAC;AApBd,KAHP;;AA2BLC,YAAQ,kBAAY;AAChB,aAAKC,gBAAL,GAAwB,IAAxB;;AAEA,aAAKC,IAAL;;AAEA,YAAIC,mBAAmB,KAAKC,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAvB;AAEH,KAlCI;;AAoCLH,UAAM,gBAAY;;AAEd,aAAKI,gBAAL,GAAwB,IAAIC,KAAJ,EAAxB;AACA,aAAKC,iBAAL,GAAyB,IAAID,KAAJ,EAAzB;;AAEA,aAAKE,aAAL,GAAqB3B,SAAS4B,YAAT,CAAsBC,SAA3C;;AAEA,YAAIR,mBAAmB,KAAKC,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAvB;;AAEA,aAAKO,kBAAL,GAA0BT,iBAAiBU,QAAjB,CAA0B,CAA1B,EAA6BC,CAAvD;;AAEA,aAAKC,kBAAL,GAA0BZ,iBAAiBU,QAAjB,CAA0B,CAA1B,EAA6BG,CAAvD;;AAEA,aAAKZ,IAAL,CAAUa,MAAV,CAAiBC,EAAjB,CAAoBhC,GAAGiC,IAAH,CAAQC,SAAR,CAAkBC,WAAtC,EAAmD,KAAKC,YAAxD,EAAsE,IAAtE;;AAEA,aAAKlB,IAAL,CAAUa,MAAV,CAAiBC,EAAjB,CAAoBhC,GAAGiC,IAAH,CAAQC,SAAR,CAAkBG,UAAtC,EAAkD,KAAKC,WAAvD,EAAoE,IAApE;;AAEA,aAAKpB,IAAL,CAAUa,MAAV,CAAiBC,EAAjB,CAAoBhC,GAAGiC,IAAH,CAAQC,SAAR,CAAkBK,SAAtC,EAAiD,KAAKC,UAAtD,EAAkE,IAAlE;;AAEA,aAAKtB,IAAL,CAAUa,MAAV,CAAiBC,EAAjB,CAAoBhC,GAAGiC,IAAH,CAAQC,SAAR,CAAkBO,YAAtC,EAAoD,KAAKC,QAAzD,EAAmE,IAAnE;AACH,KAxDI;;AA4DLN,kBAAc,sBAAUO,KAAV,EAAiB;AAC3B,YAAI,KAAKC,MAAL,IAAe,CAAnB,EAAsB;AAClB;AACH;;AAGD,YAAIC,MAAMF,MAAMG,KAAN,CAAYC,WAAZ,EAAV;;AAEA,YAAI9B,mBAAmB,KAAKC,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAvB;;AAEA,aAAK6B,YAAL,GAAoB,KAApB;;AAEA,aAAKC,YAAL,GAAoBJ,GAApB;;AAEA,YAAIK,aAAa,CAAC,CAAlB;;AAEA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIlC,iBAAiBmC,aAArC,EAAoDD,GAApD,EAAyD;AACrD,gBAAIE,aAAapC,iBAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BG,kBAA7B,CAAgDT,GAAhD,CAAjB;AACA,gBAAIU,OAAOtC,iBAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BK,cAA7B,EAAX;;AAEA,gBAAIC,OAAOzD,GAAGyD,IAAH,CAAQ,CAAR,EAAW,CAAX,EAAcF,KAAKG,KAAnB,EAA0BH,KAAKI,MAA/B,CAAX;;AAEA,gBAAIF,KAAKG,QAAL,CAAcP,UAAd,KAA6BpC,iBAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BU,MAA7B,IAAuC,IAAxE,EAA8E;AAC1EX,6BAAaC,CAAb;AACA;AACH;AAEJ;;AAED,aAAKW,YAAL,GAAoBZ,UAApB;AACH,KA1FI;;AA4FLZ,iBAAa,qBAAUK,KAAV,EAAiB;;AAG1B,YAAI,KAAKC,MAAL,IAAe,CAAnB,EAAsB;AAClB;AACH;;AAED,YAAIC,MAAMF,MAAMG,KAAN,CAAYC,WAAZ,EAAV;;AAEA,YAAIgB,SAASpB,MAAMG,KAAN,CAAYkB,mBAAZ,EAAb;;AAEA,YAAI/C,mBAAmB,KAAKC,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAvB;AACA,YAAI,KAAK2C,YAAL,IAAqB,CAAC,CAA1B,EAA6B;AACzB,gBAAIG,UAAUhD,iBAAiBU,QAAjB,CAA0B,KAAKmC,YAA/B,CAAd;AACA,gBAAII,aAAalE,GAAGmE,CAAH,CAAKF,QAAQG,WAAR,EAAL,CAAjB;;AAEA,gBAAIpE,GAAGqE,WAAH,CAAexB,GAAf,EAAoB,KAAKI,YAAzB,IAAyC,GAA7C,EAAkD;AAC9C,qBAAKD,YAAL,GAAoB,IAApB;AACH,aAFD,MAGK;AACD,qBAAKA,YAAL,GAAoB,KAApB;AACH;;AAED,gBAAIsB,YAAYtE,GAAGmE,CAAH,CAAKtB,IAAIf,CAAJ,GAAQiC,OAAOjC,CAApB,EAAuBe,IAAIjB,CAAJ,GAAQmC,OAAOnC,CAAtC,CAAhB;;AAEA,gBAAI,KAAKoB,YAAT,EAAuB;AACnB,oBAAI,CAAC,KAAKuB,QAAV,EAAoB;AAChB,yBAAKA,QAAL,GAAgB,IAAIvE,GAAGiC,IAAP,EAAhB;;AAEA,wBAAIuC,SAAS,KAAKtD,IAAL,CAAUa,MAAV,CAAiBuB,kBAAjB,CAAoCY,UAApC,CAAb;;AAEA,wBAAIO,SAAS,KAAKF,QAAL,CAAcG,YAAd,CAA2B1E,GAAG2E,MAA9B,CAAb;AACAF,2BAAOG,WAAP,GAAqBX,QAAQY,YAAR,CAAqB7E,GAAG2E,MAAxB,EAAgCC,WAArD;AACA,yBAAKL,QAAL,CAAczC,CAAd,GAAkB0C,OAAO1C,CAAzB;AACA,yBAAKyC,QAAL,CAAc3C,CAAd,GAAkB4C,OAAO5C,CAAzB;AACA,yBAAK2C,QAAL,CAAcO,cAAd,CAA6B9E,GAAGmE,CAAH,CAAK,CAAL,EAAQ,GAAR,CAA7B;AACA,yBAAKjD,IAAL,CAAUa,MAAV,CAAiBgD,QAAjB,CAA0B,KAAKR,QAA/B,EAAyC,CAAzC;AACH,iBAXD,MAYK;AACD,wBAAIE,SAAS,KAAKF,QAAL,CAAcM,YAAd,CAA2B7E,GAAG2E,MAA9B,CAAb;AACA,yBAAKJ,QAAL,CAAczC,CAAd,IAAmBwC,UAAUxC,CAA7B;AACA,yBAAKyC,QAAL,CAAc3C,CAAd,IAAmB0C,UAAU1C,CAA7B;AACH;;AAED,oBAAI,CAACoD,KAAKC,GAAL,CAAS,KAAKV,QAAL,CAAczC,CAAd,GAAkBoC,WAAWpC,CAAtC,IAA2C,EAA3C,IAAiDkD,KAAKC,GAAL,CAAS,KAAKV,QAAL,CAAc3C,CAAd,GAAkBsC,WAAWtC,CAAtC,IAA2C,EAA7F,KACA,KAAK2C,QAAL,CAAc3C,CAAd,GAAkBsC,WAAWtC,CAAX,GAAe,EADrC,EACyC;AACrC,yBAAK2C,QAAL,CAAcW,SAAd,GAA0BjB,QAAQiB,SAAlC;AACH;AACJ;AAEJ;AACJ,KA/II;;AAiJL1C,gBAAY,oBAAUG,KAAV,EAAiB;;AAEzB,YAAI,KAAKC,MAAL,IAAe,CAAnB,EAAsB;AAClB;AACH;;AAED,YAAI3B,mBAAmB,KAAKC,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAvB;;AAEA,YAAI+D,SAAJ;AACA,YAAI,KAAKX,QAAT,EAAmB;AACfW,wBAAY,KAAKX,QAAL,CAAcW,SAA1B;AACA,iBAAKX,QAAL,CAAcY,gBAAd;AACA,iBAAKZ,QAAL,GAAgB,IAAhB;AACH;AACD,YAAI,KAAKrD,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,WAA9B,EAA2CO,oBAA3C,EAAJ,EACA,CACC,CAFD,MAEK;AACD,gBAAI,CAAC,KAAKlE,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,WAA9B,EAA2CQ,gBAA3C,EAAL,EACI;AACP;;AAEDC,2BAASC,aAAT,CAAuBxF,QAAQyF,YAA/B,EAA6C,IAA7C;;AAEA,YAAI,KAAK1B,YAAL,IAAqB,CAAC,CAA1B,EAA6B;AACzB,iBAAK2B,oBAAL;AACH,SAFD,MAGK;AACA;AACD,gBAAI,KAAKvE,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,WAA9B,EAA2CO,oBAA3C,EAAJ,EACI;AACI,qBAAKM,iBAAL,CAAuB,KAAK5B,YAA5B;AACA,qBAAKA,YAAL,GAAoB,CAAC,CAArB;AACA;AACH;;AAEL,gBAAI,CAAC,KAAKd,YAAV,EACI,KAAK2C,WAAL,CAAiB,KAAK7B,YAAtB,EADJ,KAEK;;AAED,oBAAI,KAAK8B,UAAT,EAAqB;AACjB,wBAAIV,aAAaW,SAAjB,EAA4B;AACxBhG,gCAAQ,SAAR,EAAmBiG,kBAAnB,CAAsCZ,SAAtC;AACA,6BAAKa,kBAAL;;AAEA,4BAAG,KAAKC,cAAL,EAAH,EAAyB;AACrB,iCAAKC,0BAAL;AACH;;AAED,4BAAIC,YAAY,EAAhB;AACAA,kCAAUhB,SAAV,GAAsBA,SAAtB;AACAI,2CAASC,aAAT,CAAuBxF,QAAQoG,uBAA/B,EAAwDD,SAAxD;;AAEAjF,yCAAiBU,QAAjB,CAA0B,KAAKmC,YAA/B,EAA6CsC,QAA7C,CAAsD,CAAtD;AACAnF,yCAAiBU,QAAjB,CAA0B,KAAKmC,YAA/B,EAA6ClC,CAA7C,GAAiD,KAAKF,kBAAtD;AACH;AACJ;AACJ;AACJ;;AAED,aAAKoC,YAAL,GAAoB,CAAC,CAArB;AACH,KA7MI;;AA+MLpB,cAAU,kBAAUC,KAAV,EAAiB;AACvB,YAAI,KAAKC,MAAL,IAAe,CAAnB,EAAsB;AAClB;AACH;;AAED,aAAKJ,UAAL;AACH,KArNI;;AAuNL;AACA6D,mCAA+B,yCAAY;AACvC,YAAIC,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAImD,cAAclD,aAAlC,EAAiDD,GAAjD,EAAsD;AAClDmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BrB,CAA1B,GAA8BqB,IAAI,EAAJ,GAAS,KAAKtB,kBAA5C;AACAyE,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BvB,CAA1B,GAA8B,KAAKF,kBAAnC;AACA4E,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BiD,QAA1B,CAAmC,CAAnC;AACH;AACJ,KA/NI;;AAiOL;AACAX,0BAAsB,gCAAY;AAC9B,YAAIa,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAImD,cAAclD,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD,gBAAI,KAAKyC,UAAL,IAAmBzC,KAAK,KAAKoD,WAAL,CAAiBC,eAAjB,GAAmC,CAA/D,EAAkE;AAC9DF,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BrB,CAA1B,GAA8BwE,cAAc3E,QAAd,CAAuBwB,IAAI,CAA3B,EAA8BrB,CAA9B,GAAkC,GAAhE;AACAwE,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BiD,QAA1B,CAAmC,CAAnC;AACAE,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BvB,CAA1B,GAA8B,KAAKF,kBAAnC;AACH,aAJD,MAKK;AACD4E,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BrB,CAA1B,GAA8BqB,IAAI,EAAJ,GAAS,KAAKtB,kBAA5C;AACAyE,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BvB,CAA1B,GAA8B,KAAKF,kBAAnC;AACA4E,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BiD,QAA1B,CAAmC,CAAnC;AACH;AAEJ;AACJ,KAjPI;;AAmPL;AACAK,mBAAe,uBAAUb,UAAV,EAAsB;AACjC,aAAKA,UAAL,GAAkBA,UAAlB;AACH,KAtPI;;AAwPL;AACAc,iBAAa,qBAAUC,QAAV,EAAoB;AAC7B,aAAKJ,WAAL,GAAmBI,QAAnB;AACH,KA3PI;;AA6PLC,qBAAiB,yBAAUC,UAAV,EAAsB;AACnC,aAAKC,YAAL,GAAoBD,UAApB;AACH,KA/PI;;AAiQLE,uBAAmB,2BAAUC,YAAV,EAAwB;AACvC,aAAKC,cAAL,GAAsBD,YAAtB;AACH,KAnQI;;AAqQLE,kBAAc,sBAAUC,IAAV,EAAgB;AAC1B,aAAKvE,MAAL,GAAcuE,IAAd;AACH,KAvQI;;AAyQL;AACAC,oBAAgB,wBAAUC,WAAV,EAAuB;;AAEnC,aAAK9F,aAAL,GAAqB8F,WAArB;AACH,KA7QI;;AA+QL;AACAC,4BAAwB,gCAAUpG,IAAV,EAAgB0D,WAAhB,EAA6BM,SAA7B,EAAwC;AAC5DhE,aAAK2C,MAAL,GAAc,IAAd;AACA3C,aAAK2D,YAAL,CAAkB7E,GAAG2E,MAArB,EAA6BC,WAA7B,GAA2CA,WAA3C;AACA1D,aAAKgE,SAAL,GAAiBA,SAAjB;AACAhE,aAAKqG,OAAL,GAAe,KAAf;AACH,KArRI;;AAuRLC,qBAAiB,2BAAY;AACzB,YAAIhB,eAAJ;AACA,YAAG,KAAKD,WAAR,EAAoB;AAChBC,8BAAkB,KAAKD,WAAL,CAAiBC,eAAnC;AACA,gBAAIF,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;;AAEA,gBAAI,KAAKyB,MAAL,IAAe,CAAnB,EAAsB;AAClB,uBAAO0D,cAAc3E,QAAd,CAAuB6E,kBAAkB,CAAzC,CAAP;AACH,aAFD,MAGK;AACD,uBAAOF,cAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBjB,eAAhD,CAAP;AACH;AACJ,SAVD,MAWI;AACA,mBAAO,IAAP;AACH;AACJ,KAvSI;;AAySLkB,aAAS,iBAAUC,aAAV,EAAwBC,KAAxB,EAA+B;AACpC,YAAI,KAAKrB,WAAL,IAAoB,IAAxB,EAA8B;AAC1B;AACH;;AAED,aAAKsB,gBAAL;;AAEA,YAAI,CAACF,aAAL,EAAmB;AACf,gBAAI,CAAC,KAAKG,qBAAL,EAAL,EAAmC;AAC/B;AACH;AACJ;;AAED,YAAI,KAAKlF,MAAL,IAAe,CAAnB,EAAsB;AAClB,iBAAKmF,gBAAL;AACH,SAFD,MAGK,IAAI,KAAKnF,MAAL,IAAe,CAAnB,EAAsB;AACvB,iBAAKoF,iBAAL;AACH,SAFI,MAGA,IAAI,KAAKpF,MAAL,IAAe,CAAnB,EAAsB;AACvB,iBAAKqF,eAAL;AACH,SAFI,MAGA,IAAI,KAAKrF,MAAL,IAAe,CAAnB,EAAsB;AACvB,iBAAKsF,gBAAL;AACH;;AAED,aAAKC,2BAAL,CAAiC,IAAjC;;AAEA,aAAKC,aAAL;;AAEA,YAAIR,KAAJ,EACI,KAAKS,sBAAL,CAA4B,KAA5B;AAEP,KA1UI;;AA4ULC,cAAU,kBAAUC,WAAV,EAAuB;AAC7B,YAAIC,WAAW,KAAKlH,iBAAL,CAAuBmH,MAAtC;AACA,YAAID,YAAY,CAAhB,EAAmB;AACf;AACH;;AAED,YAAID,cAAc,KAAKhC,WAAL,CAAiBmC,WAAjB,CAA6B,KAAKnC,WAAL,CAAiBC,eAAjB,GAAmC,CAAhE,CAAlB;;AAEA,YAAIF,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,YAAI,KAAKyB,MAAL,IAAe,CAAnB,EAAsB;AAClB,gBAAI0D,cAAc3E,QAAd,CAAuB6G,QAAvB,CAAJ,EAAsC;AAClClC,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiC3E,MAAjC,GAA0C,IAA1C;AACA,oBAAIe,cAAc,KAAK1D,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+C8D,uBAA/C,CAAuE,KAAvE,EAA8EJ,WAA9E,CAAlB;AACA,qBAAKjB,sBAAL,CAA4BhB,cAAc3E,QAAd,CAAuB6G,QAAvB,CAA5B,EAA8D5D,WAA9D,EAA2E2D,WAA3E;AACAjC,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiC5G,CAAjC,GAAqC,KAAKF,kBAA1C;AACA4E,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiCpC,QAAjC,CAA0C,CAA1C;AACAE,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiCI,iBAAjC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA9I,0BAAU+I,gBAAV,CAA2B,aAA3B;;AAEA;AACA,oBAAIC,eAAe,KAAK5H,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,WAA9B,EAA2CkE,aAA3C,CAAyDC,SAA5E;;AAEA,qBAAI,IAAIC,IAAI,CAAZ,EAAeA,KAAKT,QAApB,EAA8BS,GAA9B,EAAkC;AAC9B,yBAAK,IAAIC,QAAQ,CAAjB,EAAoBA,QAAQJ,aAAaL,MAAzC,EAAiDS,OAAjD,EAA0D;AACtD,4BAAIJ,aAAaI,KAAb,EAAoBC,SAApB,IAAiC7C,cAAc3E,QAAd,CAAuBsH,CAAvB,EAA0B/D,SAA/D,EAA0E;AACtE,gCAAIkE,YAAY,IAAIpJ,GAAGiC,IAAP,EAAhB;AACAmH,sCAAUvF,MAAV,GAAmB,IAAnB;AACA,gCAAIwF,cAAcD,UAAU1E,YAAV,CAAuB1E,GAAG2E,MAA1B,CAAlB;AACA0E,wCAAYzE,WAAZ,GAA0B,KAAKlE,gBAA/B;AACA,gCAAI6C,OAAO+C,cAAc3E,QAAd,CAAuBsH,CAAvB,EAA0BzF,cAA1B,EAAX;AACA4F,sCAAUtH,CAAV,GAAcyB,KAAKG,KAAL,GAAa,CAA3B;AACA0F,sCAAUxH,CAAV,GAAc2B,KAAKI,MAAL,GAAc,CAAd,GAAkByF,UAAU5F,cAAV,GAA2BG,MAA3B,GAAoC,CAAtD,GAA0D,EAAxE;AACA2C,0CAAc3E,QAAd,CAAuBsH,CAAvB,EAA0BlE,QAA1B,CAAmCqE,SAAnC,EAA8C,CAA9C,EAAiD,KAAKxI,QAAL,GAAgBqI,CAAjE;AACH;AACJ;AACJ;AAEJ;AAEJ,SAlDD,MAmDK,IAAI,KAAKrG,MAAL,IAAe,CAAnB,EAAsB;AACvB,gBAAI0D,cAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBe,QAAzB,GAAoC,CAA3D,CAAJ,EAAmE;AAC/DlC,8BAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBe,QAAzB,GAAoC,CAA3D,EAA8D3E,MAA9D,GAAuE,IAAvE;AACH;AACJ,SAJI,MAKA;AACD,gBAAIyC,cAAc3E,QAAd,CAAuB6G,QAAvB,CAAJ,EAAsC;AAClClC,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiC3E,MAAjC,GAA0C,IAA1C;AACH;AACJ;;AAGD,YAAI,KAAKjB,MAAL,IAAe,CAAnB,EAAsB;AAClB,gBAAI0D,cAAc3E,QAAd,CAAuB6G,QAAvB,KAAoClC,cAAc3E,QAAd,CAAuB6G,WAAW,CAAlC,CAAxC,EAA8E;AAC1ElC,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiC1G,CAAjC,GAAqCwE,cAAc3E,QAAd,CAAuB6G,WAAW,CAAlC,EAAqC1G,CAArC,GAAyC,GAA9E;AACH;AACJ,SAJD,MAKK,IAAI,KAAKc,MAAL,IAAe,CAAnB,EAAsB;AACvB,gBAAI0D,cAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBe,QAAzB,GAAoC,CAA3D,KAAiElC,cAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBe,QAAhD,CAArE,EAAgI;AAC5HlC,8BAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBe,QAAzB,GAAoC,CAA3D,EAA8D1G,CAA9D,GAAkEwE,cAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBe,QAAhD,EAA0D1G,CAA1D,GAA8D,EAAhI;AACAwE,8BAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBe,QAAzB,GAAoC,CAA3D,EAA8D5G,CAA9D,GAAkE0E,cAAc3E,QAAd,CAAuB/B,SAAS6H,aAAT,GAAyBe,QAAhD,EAA0D5G,CAA1D,GAA8D,EAAhI;AACH;AACJ,SALI,MAMA,IAAI,KAAKgB,MAAL,IAAe,CAAnB,EAAsB;AACvB,gBAAI0D,cAAc3E,QAAd,CAAuB6G,QAAvB,KAAoClC,cAAc3E,QAAd,CAAuB6G,WAAW,CAAlC,CAAxC,EAA8E;AAC1ElC,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiC1G,CAAjC,GAAqCwE,cAAc3E,QAAd,CAAuB6G,WAAW,CAAlC,EAAqC1G,CAArC,GAAyC,EAA9E;AACH;AAEJ,SALI,MAMA,IAAI,KAAKc,MAAL,IAAe,CAAnB,EAAsB;;AAEvB,gBAAI0D,cAAc3E,QAAd,CAAuB6G,QAAvB,KAAoClC,cAAc3E,QAAd,CAAuB6G,WAAW,CAAlC,CAAxC,EAA8E;;AAE1ElC,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiC1G,CAAjC,GAAqCwE,cAAc3E,QAAd,CAAuB6G,WAAW,CAAlC,EAAqC1G,CAArC,GAAyC,EAA9E;AACAwE,8BAAc3E,QAAd,CAAuB6G,QAAvB,EAAiC5G,CAAjC,GAAqC0E,cAAc3E,QAAd,CAAuB6G,WAAW,CAAlC,EAAqC5G,CAArC,GAAyC,EAA9E;AACH;AACJ;;AAED,aAAKN,iBAAL,CAAuBgI,IAAvB,CAA4Bf,WAA5B;AACA,YAAI,KAAK3F,MAAL,IAAe,CAAnB,EACI,KAAK2G,iBAAL;AACP,KAjbI;;AAmbLpB,iCAA6B,qCAAUqB,SAAV,EAAqB;AAC9C,YAAI,CAACA,SAAL,EACI;;AAEJ,YAAIC,SAAS,CAAC,CAAC,GAAD,EAAM,CAAN,CAAD,EAAW,CAAC,CAAC,CAAF,EAAK,EAAL,CAAX,EAAqB,CAAC,CAAC,EAAF,EAAM,CAAN,CAArB,EAA+B,CAAC,CAAC,CAAF,EAAK,CAAC,EAAN,CAA/B,CAAb;;AAEA,YAAI,KAAKlI,aAAL,IAAsB3B,SAAS4B,YAAT,CAAsBC,SAA5C,IAAyD,KAAKF,aAAL,IAAsB3B,SAAS4B,YAAT,CAAsBkI,MAArG,IACA,KAAKnI,aAAL,IAAsB3B,SAAS4B,YAAT,CAAsBmI,SADhD,EAC2D;AACvD;AACH;;AAED,YAAIC,YAAY,KAAKrD,WAAL,CAAiBC,eAAjC;AACA,YAAIqD,YAAY,KAAK3I,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAhB;;AAGA,YAAI,KAAKyB,MAAL,IAAe,CAAnB,EAAsB;AAClB,iBAAK,IAAIO,IAAI,CAAb,EAAgBA,IAAI0G,UAAUzG,aAA9B,EAA6CD,GAA7C,EAAkD;AAC9C0G,0BAAUlI,QAAV,CAAmBwB,CAAnB,EAAsBrB,CAAtB,GAA0BqB,IAAI,EAAJ,GAAS,KAAKtB,kBAAxC;AACAgI,0BAAUlI,QAAV,CAAmBwB,CAAnB,EAAsBvB,CAAtB,GAA0B,KAAKF,kBAA/B;AACAmI,0BAAUlI,QAAV,CAAmBwB,CAAnB,EAAsBiD,QAAtB,CAA+B,CAA/B;AAEH;;AAEDyD,sBAAUlI,QAAV,CAAmBiI,YAAY,CAA/B,EAAkC9H,CAAlC,GAAsC+H,UAAUlI,QAAV,CAAmBiI,YAAY,CAA/B,EAAkC9H,CAAlC,GAAsC2H,OAAO,KAAK7G,MAAL,GAAc,CAArB,EAAwB,CAAxB,CAA5E;AACAiH,sBAAUlI,QAAV,CAAmBiI,YAAY,CAA/B,EAAkChI,CAAlC,GAAsCiI,UAAUlI,QAAV,CAAmBiI,YAAY,CAA/B,EAAkChI,CAAlC,GAAsC6H,OAAO,KAAK7G,MAAL,GAAc,CAArB,EAAwB,CAAxB,CAA5E;AACH,SAVD,MAYK,IAAI,KAAKA,MAAL,IAAe,CAAnB,EAAsB;AACvBiH,sBAAUlI,QAAV,CAAmB/B,SAAS6H,aAAT,GAAyBmC,SAA5C,EAAuD9H,CAAvD,GAA2D+H,UAAUlI,QAAV,CAAmB/B,SAAS6H,aAAT,GAAyBmC,SAA5C,EAAuD9H,CAAvD,GAA2D2H,OAAO,KAAK7G,MAAL,GAAc,CAArB,EAAwB,CAAxB,CAAtH;AACAiH,sBAAUlI,QAAV,CAAmB/B,SAAS6H,aAAT,GAAyBmC,SAA5C,EAAuDhI,CAAvD,GAA2DiI,UAAUlI,QAAV,CAAmB/B,SAAS6H,aAAT,GAAyBmC,SAA5C,EAAuDhI,CAAvD,GAA2D6H,OAAO,KAAK7G,MAAL,GAAc,CAArB,EAAwB,CAAxB,CAAtH;AACH,SAHI,MAIA;AACDiH,sBAAUlI,QAAV,CAAmBiI,YAAY,CAA/B,EAAkC9H,CAAlC,GAAsC+H,UAAUlI,QAAV,CAAmBiI,YAAY,CAA/B,EAAkC9H,CAAlC,GAAsC2H,OAAO,KAAK7G,MAAL,GAAc,CAArB,EAAwB,CAAxB,CAA5E;AACAiH,sBAAUlI,QAAV,CAAmBiI,YAAY,CAA/B,EAAkChI,CAAlC,GAAsCiI,UAAUlI,QAAV,CAAmBiI,YAAY,CAA/B,EAAkChI,CAAlC,GAAsC6H,OAAO,KAAK7G,MAAL,GAAc,CAArB,EAAwB,CAAxB,CAA5E;AACH;AAEJ,KAvdI;;AAydLkF,yBAzdK,mCAydmB;AACpB,YAAIgC,WAAW,KAAf,CADoB,CACI;;AAExB,YAAI,KAAKxI,iBAAL,CAAuBmH,MAAvB,IAAiC,KAAKlC,WAAL,CAAiBC,eAAlD,IACA,KAAKa,WAAL,IAAoBzH,SAAS4B,YAAT,CAAsBuI,MAD1C,IACoD,KAAK1C,WAAL,IAAoBzH,SAAS4B,YAAT,CAAsBwI,KADlG,EACyG;AACrGF,uBAAW,IAAX;AACH,SAHD,MAIK;AACD;AACA,gBAAIG,QAAQ,KAAZ;AACA,iBAAK,IAAI9G,IAAI,CAAb,EAAgBA,IAAI,KAAKoD,WAAL,CAAiBC,eAArC,EAAsDrD,GAAtD,EAA2D;AACvD8G,wBAAQ,KAAR;AACA,qBAAK,IAAIhB,IAAI,CAAb,EAAgBA,IAAI,KAAK3H,iBAAL,CAAuBmH,MAA3C,EAAmDQ,GAAnD,EAAwD;AACpD,wBAAI,KAAK1C,WAAL,CAAiBmC,WAAjB,CAA6BvF,CAA7B,KAAmC,KAAK7B,iBAAL,CAAuB2H,CAAvB,CAAvC,EAAkE;AAC9DgB,gCAAQ,IAAR;AACA;AACH;AACJ;;AAED,oBAAI,CAACA,KAAL,EAAY;AACRH,+BAAW,IAAX;AACA;AACH;AACJ;AACJ;AACD;AACA,eAAOA,QAAP;AACH,KApfI;AAsfL1B,iBAtfK,2BAsfW;AACZ,aAAK9G,iBAAL,GAAyB,EAAzB;AACA,YAAI,KAAKiF,WAAL,CAAiBC,eAAjB,GAAmC,CAAvC,EAA0C;AACtC,iBAAK,IAAIrD,IAAI,CAAb,EAAgBA,IAAI,KAAKoD,WAAL,CAAiBC,eAArC,EAAsDrD,GAAtD,EAA2D;AACvD,qBAAK7B,iBAAL,CAAuB6B,CAAvB,IAA4B,KAAKoD,WAAL,CAAiBmC,WAAjB,CAA6BvF,CAA7B,CAA5B;AACH;AACJ;AACJ,KA7fI;;AA8fL;AACA4E,sBAAkB,4BAAY;AAC1B,YAAI8B,YAAY,IAAIxI,KAAJ,EAAhB;AACA,YAAI6I,gBAAgB,KAAK3D,WAAL,CAAiBC,eAArC;AACA,aAAK,IAAIrD,IAAI,CAAb,EAAgBA,IAAI+G,aAApB,EAAmC/G,GAAnC,EAAwC;;AAEpC0G,sBAAU1G,CAAV,IAAepD,QAAQoK,cAAR,CAAuB,KAAK5D,WAAL,CAAiBmC,WAAjB,CAA6BvF,CAA7B,CAAvB,EAAuD,KAAKtC,oBAA5D,CAAf;AACH;;AAED,YAAIuJ,OAAO,IAAX;AACAP,kBAAUQ,IAAV,CAAe,UAAUC,CAAV,EAAaC,CAAb,EAAgB;;AAE3B,gBAAID,KAAKC,CAAT,EAAY;AACR;AACA;AACA;AACA;;AAEA,uBAAOD,IAAIC,CAAX;AACH;;AAED,mBAAO,CAAP;AACH,SAZD;;AAcA,YAAIjE,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;;AAEA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAI+G,aAApB,EAAmC/G,GAAnC,EAAwC;AACpC0G,sBAAU1G,CAAV,IAAc0G,UAAU1G,CAAV,IAAa,GAA3B;AACH;;AAED,aAAK,IAAIA,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7CmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,KAAnC;AACH;;AAED,YAAI2G,SAAS,KAAK3I,kBAAlB;AACA,YAAI4I,YAAY,EAAhB;;AAGA,aAAK,IAAItH,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7C,gBAAIA,IAAI+G,aAAJ,IAAqBL,UAAU1G,CAAV,IAAevD,SAAS8K,YAAjD,EAA+D;AAC3D,oBAAI9F,cAAc,KAAK1D,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+C8D,uBAA/C,CAAuE,KAAvE,EAA8EkB,UAAU1G,CAAV,CAA9E,CAAlB;AACA,qBAAKmE,sBAAL,CAA4BhB,cAAc3E,QAAd,CAAuBwB,CAAvB,CAA5B,EAAuDyB,WAAvD,EAAoEiF,UAAU1G,CAAV,CAApE;AACAmD,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BrB,CAA1B,GAA8B0I,SAAUrH,CAAD,GAAMsH,SAA7C;AACAnE,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BvB,CAA1B,GAA8B,KAAKF,kBAAnC;AACA4E,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BiD,QAA1B,CAAmC,CAAnC;;AAEAE,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0ByF,iBAA1B;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA,oBAAIE,eAAe,KAAK5H,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,WAA9B,EAA2CkE,aAA3C,CAAyDC,SAA5E;;AAEA,qBAAK,IAAIE,QAAQ,CAAjB,EAAoBA,QAAQJ,aAAaL,MAAzC,EAAiDS,OAAjD,EAA0D;AACtD,wBAAIJ,aAAaI,KAAb,EAAoBC,SAApB,IAAiCU,UAAU1G,CAAV,CAArC,EAAmD;AAC/C,4BAAIiG,YAAY,IAAIpJ,GAAGiC,IAAP,EAAhB;AACAmH,kCAAUvF,MAAV,GAAmB,IAAnB;AACA,4BAAIwF,cAAcD,UAAU1E,YAAV,CAAuB1E,GAAG2E,MAA1B,CAAlB;AACA0E,oCAAYzE,WAAZ,GAA0B,KAAKlE,gBAA/B;AACA,4BAAI6C,OAAO+C,cAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BK,cAA1B,EAAX;AACA4F,kCAAUtH,CAAV,GAAcyB,KAAKG,KAAL,GAAa,CAA3B;AACA0F,kCAAUxH,CAAV,GAAc2B,KAAKI,MAAL,GAAc,CAAd,GAAkByF,UAAU5F,cAAV,GAA2BG,MAA3B,GAAoC,CAAtD,GAA0D,EAAxE;AACA2C,sCAAc3E,QAAd,CAAuBwB,CAAvB,EAA0B4B,QAA1B,CAAmCqE,SAAnC,EAA8C,CAA9C,EAAiD,KAAKxI,QAAL,GAAgBuC,CAAjE;AACH;AACJ;AACJ,aA/CD,MAgDK;AACDmD,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,KAAnC;AACH;AACJ;AACD,aAAK0F,iBAAL;AACH,KA1lBI;;AA4lBLvB,uBAAmB,6BAAY;AAC3B,YAAIkC,gBAAgB,KAAK3D,WAAL,CAAiBC,eAArC;;AAEA,YAAIF,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;;AAEA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7CmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,KAAnC;AACH;;AAED,aAAK,IAAIV,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;;AAE7CmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BrB,CAA1B,GAA8B,MAAOqB,CAAD,GAAM,CAA1C;AACAmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BvB,CAA1B,GAA8B,MAAOuB,CAAD,GAAM,EAA1C;;AAEA,gBAAIA,KAAKvD,SAAS6H,aAAT,GAAyByC,aAAlC,EAAiD;AAC7C5D,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,IAAnC;AACH,aAFD,MAGK;AACDyC,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,KAAnC;AACH;AACJ;AACJ,KAjnBI;;AAmnBLoE,qBAAiB,2BAAY;AACzB,YAAIiC,gBAAgB,KAAK3D,WAAL,CAAiBC,eAArC;AACA,YAAIF,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;;AAEA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7CmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,KAAnC;AACH;;AAED,aAAK,IAAIV,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7C,gBAAIA,IAAI+G,aAAR,EAAuB;AACnB5D,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,IAAnC;AACAyC,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BrB,CAA1B,GAA8B,MAAOqB,CAAD,GAAM,EAA1C;AACH,aAHD,MAIK;AACDmD,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,KAAnC;AACH;AACJ;AACJ,KApoBI;;AAsoBLqE,sBAAkB,4BAAY;AAC1B,YAAIgC,gBAAgB,KAAK3D,WAAL,CAAiBC,eAArC;AACA,YAAIF,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;;AAEA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7CmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,KAAnC;AACH;;AAED,aAAK,IAAIV,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7CmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BrB,CAA1B,GAA8B,CAAC,GAAD,GAAQqB,CAAD,GAAM,CAA3C;AACAmD,0BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BvB,CAA1B,GAA8B,MAAOuB,CAAD,GAAM,EAA1C;;AAEA,gBAAIA,IAAI+G,aAAR,EAAuB;AACnB5D,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,IAAnC;AACH,aAFD,MAGK;AACDyC,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BU,MAA1B,GAAmC,KAAnC;AACH;AACJ;AACJ,KAzpBI;;AA2pBL;AACAkC,wBAAoB,8BAAY;AAC5B,YAAI,KAAKnD,MAAL,IAAe,CAAnB,EAAsB;AAClB;AACH;;AAED,YAAI0D,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7C,gBAAIjC,OAAOoF,cAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BwH,aAA1B,CAAwC,KAAK/J,QAAL,GAAgBuC,CAAxD,CAAX;AACA,gBAAIjC,IAAJ,EAAU;AACNA,qBAAKiE,gBAAL,CAAsB,IAAtB;AACH;AACJ;AACJ,KAxqBI;;AA0qBLQ,iBAAa,qBAAUiF,UAAV,EAAsB;;AAE/B,YAAIC,QAAQ,KAAK3J,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAZ;AACA,YAAID,OAAO2J,MAAMlJ,QAAN,CAAeiJ,UAAf,CAAX;;AAEA,YAAI1F,YAAYhE,KAAKgE,SAArB;;AAEA,YAAIgE,QAAQ0B,UAAZ;;AAEAtF,2BAASC,aAAT,CAAuBxF,QAAQyF,YAA/B,EAA6C,IAA7C;;AAEA,YAAIU,YAAY,EAAhB;AACAA,kBAAUhB,SAAV,GAAsBA,SAAtB;AACAI,2BAASC,aAAT,CAAuBxF,QAAQoG,uBAA/B,EAAwDD,SAAxD;;AAEA,YAAIhF,KAAKU,CAAL,IAAU,KAAKF,kBAAnB,EAAuC;AACnC,gBAAI,KAAKoJ,yBAAL,EAAJ;AACA;AACA,qBAAK,IAAI3H,IAAI,CAAb,EAAgBA,IAAI0H,MAAMzH,aAA1B,EAAyCD,GAAzC,EAA8C;AAC1C,wBAAI,KAAKyC,UAAL,IAAmBzC,KAAK,KAAKoD,WAAL,CAAiBC,eAAjB,GAAmC,CAA/D,EAAkE;AAC9DqE,8BAAMlJ,QAAN,CAAewB,CAAf,EAAkBrB,CAAlB,GAAsB+I,MAAMlJ,QAAN,CAAewB,IAAI,CAAnB,EAAsBrB,CAAtB,GAA0B,GAAhD;AACA+I,8BAAMlJ,QAAN,CAAewB,CAAf,EAAkBvB,CAAlB,GAAsB,KAAKF,kBAA3B;AACAmJ,8BAAMlJ,QAAN,CAAewB,CAAf,EAAkBiD,QAAlB,CAA2B,CAA3B;AACH,qBAJD,MAKK;AACDyE,8BAAMlJ,QAAN,CAAewB,CAAf,EAAkBrB,CAAlB,GAAsBqB,IAAI,EAAJ,GAAS,KAAKtB,kBAApC;AACAgJ,8BAAMlJ,QAAN,CAAewB,CAAf,EAAkBvB,CAAlB,GAAsB,KAAKF,kBAA3B;AACAmJ,8BAAMlJ,QAAN,CAAewB,CAAf,EAAkBiD,QAAlB,CAA2B,CAA3B;AACH;AAEJ;;AAEDlF,iBAAKU,CAAL,GAASV,KAAKU,CAAL,GAAS,EAAlB;AACAV,iBAAKkF,QAAL,CAAc,GAAd;;AAGAd,+BAASC,aAAT,CAAuBxF,QAAQgL,UAA/B,EAA2C7F,SAA3C;AACApF,sBAAU+I,gBAAV,CAA2B,mBAA3B;;AAGA,gBAAG,KAAK7C,cAAL,EAAH,EAAyB;AACrB,qBAAKgF,4BAAL;AACH;;AAED;;AAEA,iBAAK,IAAI7H,IAAI,CAAb,EAAgBA,IAAI0H,MAAMzH,aAA1B,EAAyCD,GAAzC,EAA8C;AAC1C,oBAAIjC,QAAQ2J,MAAMlJ,QAAN,CAAewB,CAAf,CAAZ,EAA+B;AAC3B+F,4BAAQ/F,CAAR;AACA;AACH;AACJ;;AAED,gBAAI+F,SAAS,CAAC,CAAd,EAAiB;AACb,qBAAK,IAAI/F,IAAI+F,QAAQ,CAArB,EAAwB/F,IAAI0H,MAAMzH,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD0H,0BAAMlJ,QAAN,CAAewB,CAAf,EAAkBrB,CAAlB,IAAuB,EAAvB;AACH;AACJ;AACJ,SA3CD,MA4CK;;AAED,gBAAI,KAAK8D,UAAT,EAAqB;AACjB/F,wBAAQ,SAAR,EAAmBiG,kBAAnB,CAAsCZ,SAAtC;;AAEAhE,qBAAKkF,QAAL,CAAc,CAAd;AACAlF,qBAAKU,CAAL,GAASV,KAAKU,CAAL,GAAS,EAAlB;AACA,qBAAKmE,kBAAL;;AAEA,oBAAG,KAAKC,cAAL,EAAH,EAAyB;AACrB,yBAAKC,0BAAL;AACH;AACJ,aAVD,MAWK;AACD;AACA,qBAAK,IAAI9C,IAAI,CAAb,EAAgBA,IAAI0H,MAAMzH,aAA1B,EAAyCD,GAAzC,EAA8C;;AAE1C0H,0BAAMlJ,QAAN,CAAewB,CAAf,EAAkBrB,CAAlB,GAAsBqB,IAAI,EAAJ,GAAS,KAAKtB,kBAApC;AACAgJ,0BAAMlJ,QAAN,CAAewB,CAAf,EAAkBvB,CAAlB,GAAsB,KAAKF,kBAA3B;AACAmJ,0BAAMlJ,QAAN,CAAewB,CAAf,EAAkBiD,QAAlB,CAA2B,CAA3B;AACH;AACJ;AACJ;AACJ,KA5vBI;;AA8vBL;AACAJ,oBAAe,0BAAU;AACrB,YAAIiF,UAAU,IAAd;AACA,aAAI,IAAI9H,IAAI,CAAZ,EAAeA,IAAI,KAAKoD,WAAL,CAAiB2E,UAAjB,CAA4BzC,MAA/C,EAAuDtF,GAAvD,EAA2D;AACvD,gBAAG,KAAKoD,WAAL,CAAiB2E,UAAjB,CAA4B/H,CAA5B,IAAiCvD,SAAS8K,YAA1C,IAA0D,KAAKnE,WAAL,CAAiB2E,UAAjB,CAA4B/H,CAA5B,KAAkC,CAA/F,EAAiG;AAC7F8H,0BAAU,KAAV;AACA;AACH;AACJ;;AAED,eAAOA,OAAP;AACH,KAzwBI;;AA2wBL;AACAD,kCAA6B,wCAAU;AACnC,YAAIG,gBAAgBtL,QAAQ,eAAR,CAApB;AACAsL,sBAAcC,uBAAd,CAAsCD,cAAcE,UAAd,CAAyBC,UAA/D;AACH,KA/wBI;;AAixBL;AACArF,gCAA2B,sCAAU;AACjC,YAAIkF,gBAAgBtL,QAAQ,eAAR,CAApB;AACAsL,sBAAcC,uBAAd,CAAsCD,cAAcE,UAAd,CAAyBE,aAA/D;AACH,KArxBI;;AAuxBLC,wBAAoB,4BAAUC,aAAV,EAAyB;AACzC,YAAIC,gBAAgB,KAAKxK,IAAL,CAAUC,cAAV,CAAyB,kBAAzB,CAApB;AACAuK,sBAAc9C,iBAAd;;AAEA,YAAI+C,qBAAqB,SAArBA,kBAAqB,GAAY;AACjCD,0BAAc9C,iBAAd;AACH,SAFD;;AAIA,YAAI4B,SAAS,CAAC,GAAd;AACA,YAAIoB,SAAS,GAAb;AACA,YAAInB,YAAY,GAAhB;;AAEA,aAAK,IAAItH,IAAI,CAAb,EAAgBA,IAAIsI,cAAchD,MAAlC,EAA0CtF,GAA1C,EAA+C;AAC3C,gBAAI0I,qBAAqB7L,GAAG8L,WAAH,CAAe,KAAKrL,oBAApB,CAAzB;AACA,gBAAIsL,yBAAyBF,mBAAmBhH,YAAnB,CAAgC,sBAAhC,CAA7B;;AAEA,gBAAImH,cAAc,KAAK9K,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+CoH,YAAjE;AACAF,mCAAuB/K,IAAvB,CAA4BpB,SAAS4B,YAAT,CAAsBkI,MAAlD,EAA0D+B,cAActI,CAAd,CAA1D,EAA4EwI,kBAA5E,EAAgGK,WAAhG;AACAD,mCAAuBG,MAAvB;AACAR,0BAAc3G,QAAd,CAAuB8G,kBAAvB;;AAEAA,+BAAmB/J,CAAnB,GAAuB0I,SAAUrH,CAAD,GAAMsH,SAAtC;AACAoB,+BAAmBjK,CAAnB,GAAuBgK,MAAvB;AACH;AACJ,KA/yBI;;AAizBL;AACAO,mCAA+B,yCAAY;AACvC,YAAIT,gBAAgB,KAAKxK,IAAL,CAAUC,cAAV,CAAyB,kBAAzB,CAApB;AACAuK,sBAAc9C,iBAAd;AAEH,KAtzBI;;AAwzBLwD,4BAxzBK,sCAwzBsB;AACvB,YAAI,KAAKxJ,MAAL,IAAe,CAAf,IAAoB,KAAKA,MAAL,IAAe,CAAvC,EAA0C;AACtC,mBAAO,KAAK1B,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+CoH,YAAtD;AACH,SAFD,MAGK,IAAI,KAAKrJ,MAAL,IAAe,CAAnB,EAAsB;AACvB,mBAAO,KAAK1B,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+CwH,eAAtD;AACH,SAFI,MAGA,IAAI,KAAKzJ,MAAL,IAAe,CAAnB,EAAsB;AACvB,mBAAO,KAAK1B,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+CyH,eAAtD;AACH,SAFI,MAGA;AACDtM,eAAGuM,GAAH,CAAO,2BAAP;AACH;AACJ,KAr0BI;;;AAu0BLC,wBAAoB,8BAAY;AAC5B,eAAO,KAAKC,OAAZ;AACH,KAz0BI;;AA20BL;AACA5E,sBAAkB,4BAAY;AAC1B,YAAI,KAAK6E,eAAL,IAAwB,IAA5B,EAAkC;AAC9B,iBAAKA,eAAL,GAAuB,IAAIrL,KAAJ,EAAvB;AACH;AACD,YAAIsL,mBAAmB,KAAKzL,IAAL,CAAUC,cAAV,CAAyB,WAAzB,CAAvB;;AAEA,YAAIyL,YAAY,IAAhB;AACA,YAAIC,WAAW,IAAf;AACA,YAAIrC,SAAS,IAAb;AACA,YAAIoB,SAAS,IAAb;AACA,YAAInB,YAAY,IAAhB;AACA,YAAIqC,YAAY,IAAhB;;AAEA,YAAIC,QAAQ,CAAZ;;AAEA,YAAI,KAAKnK,MAAL,IAAe,CAAnB,EAAsB;AAClB4H,qBAAS,GAAT;AACAoB,qBAAS,CAAC,GAAV;;AAEAnB,wBAAY,CAAC,GAAb;AACAqC,wBAAY,CAAZ;AACH,SAND,MAOK,IAAI,KAAKlK,MAAL,IAAe,CAAnB,EAAsB;AACvB4H,qBAAS,GAAT;AACAoB,qBAAS,CAAC,GAAV;;AAEAnB,wBAAY,CAAC,EAAb;AACAqC,wBAAY,CAAC,GAAb;;AAEAC,oBAAQ,GAAR;AACH,SARI,MASA,IAAI,KAAKnK,MAAL,IAAe,CAAnB,EAAsB;AACvB4H,qBAAS,CAAC,GAAV;AACAoB,qBAAS,GAAT;AACAnB,wBAAY,GAAZ;AACAqC,wBAAY,CAAZ;AACAC,oBAAQ,GAAR;AACH,SANI,MAOA,IAAI,KAAKnK,MAAL,IAAe,CAAnB,EAAsB;AACvB4H,qBAAS,CAAC,GAAV;AACAoB,qBAAS,CAAC,EAAV;;AAEAnB,wBAAY,EAAZ;AACAqC,wBAAY,GAAZ;AACAC,oBAAQ,GAAR;AACH;;AAED;AACA,aAAK,IAAI5J,IAAI,CAAb,EAAgBA,IAAI,KAAKoD,WAAL,CAAiByG,WAArC,EAAkD7J,GAAlD,EAAuD;AACnD0J,uBAAW,KAAKtG,WAAL,CAAiB0G,aAAjB,CAA+B9J,CAA/B,CAAX;;AAEA;AACA,gBAAI0J,SAASK,WAAT,IAAwBtN,SAASuN,SAAT,CAAmBC,MAA3C,IAAqDP,SAASK,WAAT,IAAwBtN,SAASuN,SAAT,CAAmBE,MAAhG,IACAR,SAASK,WAAT,IAAwBtN,SAASuN,SAAT,CAAmBG,QAD/C,EACyD,CACxD;AACD,gBAAI,KAAKZ,eAAL,CAAqBvJ,CAArB,KAA2B,IAA/B,EAAqC;AACjCyJ,4BAAY5M,GAAG8L,WAAH,CAAe,KAAKzL,cAApB,CAAZ;AACA,oBAAIkN,iBAAiBX,UAAU/H,YAAV,CAAuB,gBAAvB,CAArB;AACA0I,+BAAevM,IAAf,CAAoB6L,SAASK,WAA7B,EAA0CL,SAASW,UAAnD,EAA+D,KAAK5K,MAApE,EAA4E,KAAKwJ,wBAAL,EAA5E,EAHiC,CAG4E;AAC7GO,iCAAiB5H,QAAjB,CAA0B6H,SAA1B;AACAA,0BAAUxG,QAAV,CAAmB2G,KAAnB;AACAH,0BAAU9K,CAAV,GAAc0I,SAAUrH,CAAD,GAAMsH,SAA7B;AACAmC,0BAAUhL,CAAV,GAAcgK,SAAUzI,CAAD,GAAM2J,SAA7B;AACA,qBAAKJ,eAAL,CAAqBvJ,CAArB,IAA0ByJ,SAA1B;AACH,aATD,MAUK;AACD,oBAAIW,iBAAiB,KAAKb,eAAL,CAAqBvJ,CAArB,EAAwB0B,YAAxB,CAAqC,gBAArC,CAArB;AACA0I,+BAAevM,IAAf,CAAoB6L,SAASK,WAA7B,EAA0CL,SAASW,UAAnD,EAA+D,KAAK5K,MAApE,EAA4E,KAAKwJ,wBAAL,EAA5E,EAFC,CAE4G;AAChH;AACJ;AACJ,KAl5BI;;AAo5BLqB,eAAU,qBAAU;AAChBC,eAAOC,KAAP,GAAe,IAAI3N,GAAG4N,KAAP,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,CAAf;AACH,KAt5BI;;AAw5BL;AACAC,cAAU,oBAAY;AAClB,aAAKC,sBAAL;AACH,KA35BI;;AA65BL;AACAA,4BAAwB,kCAAY;;AAEhC,YAAI5D,gBAAgB,KAAK3D,WAAL,CAAiBC,eAArC;;AAEA,YAAIvF,mBAAmB,KAAKC,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAvB;;AAEA,YAAIqJ,SAASvJ,iBAAiBU,QAAjB,CAA0B,CAA1B,EAA6BG,CAA1C;AACA,YAAI8J,SAAS3K,iBAAiBU,QAAjB,CAA0B,CAA1B,EAA6BC,CAA1C;AACA,YAAI6I,YAAY,EAAhB;AACA,YAAIqC,YAAY,EAAhB;AACA,YAAIiB,WAAW,EAAf;AACA,YAAIhB,QAAQ,CAAZ;AACA,YAAI,KAAKnK,MAAL,IAAe,CAAnB,EAAsB;AAClBmL,uBAAW,SAAX;AACAtD,wBAAY,EAAZ;AACAqC,wBAAY,CAAZ;;AAEAtC,qBAAS,CAAC,GAAV;AAEH,SAPD,MAQK,IAAI,KAAK5H,MAAL,IAAe,CAAnB,EAAsB;AACvBmL,uBAAW,YAAX;AACAhB,oBAAQ,GAAR;AACAtC,wBAAY,CAAC,CAAb;AACAqC,wBAAY,EAAZ;;AAEA,gBAAItC,SAASvJ,iBAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAnD,EAAsD3F,CAAnE;AACA,gBAAI8J,SAAS3K,iBAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAnD,EAAsD7F,CAAnE;AACH,SARI,MASA,IAAI,KAAKgB,MAAL,IAAe,CAAnB,EAAsB;AACvBmL,uBAAW,SAAX;AACAhB,oBAAQ,GAAR;AACAtC,wBAAY,CAAC,EAAb;AACAqC,wBAAY,CAAZ;AAEH,SANI,MAOA,IAAI,KAAKlK,MAAL,IAAe,CAAnB,EAAsB;AACvBmL,uBAAW,YAAX;AACAhB,oBAAQ,GAAR;AACAtC,wBAAY,CAAC,CAAb;AACAqC,wBAAY,CAAC,EAAb;AACH;;AAGD,aAAK,IAAI3J,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7ClC,6BAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BU,MAA7B,GAAsC,KAAtC;AACH;;AAED,aAAK,IAAIV,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;;AAE7C,gBAAIA,IAAI,KAAKoD,WAAL,CAAiBC,eAAzB,EAA0C;AACtC,oBAAIwH,OAAOlO,UAAUmO,aAAV,CAAwBF,QAAxB,EAAkC,KAAKxH,WAAL,CAAiBmC,WAAjB,CAA6BvF,CAA7B,CAAlC,CAAX;AACA,oBAAIyB,cAAc,IAAlB;AACA,oBAAI,KAAKhC,MAAL,IAAe,CAAf,IAAoB,KAAKA,MAAL,IAAe,CAAvC,EAA0C;AACtCgC,kCAAc,KAAK1D,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+CoH,YAA/C,CAA4DiC,cAA5D,CAA2EF,IAA3E,CAAd;AACH,iBAFD,MAGK,IAAI,KAAKpL,MAAL,IAAe,CAAnB,EAAsB;AACvBgC,kCAAc,KAAK1D,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+CwH,eAA/C,CAA+D6B,cAA/D,CAA8EF,IAA9E,CAAd;AACH,iBAFI,MAGA,IAAI,KAAKpL,MAAL,IAAe,CAAnB,EAAsB;AACvBgC,kCAAc,KAAK1D,IAAL,CAAUa,MAAV,CAAiB8C,YAAjB,CAA8B,eAA9B,EAA+CyH,eAA/C,CAA+D4B,cAA/D,CAA8EF,IAA9E,CAAd;AACH;;AAID,oBAAI,KAAKpL,MAAL,IAAe,CAAnB,EAAsB;;AAElB;AACA,wBAAIO,KAAK,KAAKoD,WAAL,CAAiBC,eAAjB,GAAmC,CAAxC,IAA6C,KAAKtF,IAAL,CAAU2D,YAAV,CAAuB,QAAvB,EAAiCsJ,WAAjC,EAAjD,EAAiG;AAC7FlN,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BU,MAA7B,GAAsC,IAAtC;AACA5C,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6B0B,YAA7B,CAA0C7E,GAAG2E,MAA7C,EAAqDC,WAArD,GAAmEA,WAAnE;AACA3D,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BiD,QAA7B,CAAsC2G,KAAtC;AACA9L,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BrB,CAA7B,GAAiC0I,SAAUrH,CAAD,GAAMsH,SAAhD;AACAxJ,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BvB,CAA7B,GAAiCgK,SAAUzI,CAAD,GAAM2J,SAAhD;AACH,qBAND,MAMO;AACH7L,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BU,MAA7B,GAAsC,IAAtC;AACA5C,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6B0B,YAA7B,CAA0C7E,GAAG2E,MAA7C,EAAqDC,WAArD,GAAmEA,WAAnE;AACA3D,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BiD,QAA7B,CAAsC2G,KAAtC;AACA9L,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BrB,CAA7B,GAAiC0I,SAAS,CAACrH,IAAI,CAAL,IAAUsH,SAApD;AACAxJ,yCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BvB,CAA7B,GAAiCgK,SAAS,CAACzI,IAAI,CAAL,IAAU2J,SAApD;AACH;AAEJ,iBAjBD,MAkBK;AACD,wBAAI3J,KAAK,KAAKoD,WAAL,CAAiBC,eAAjB,GAAmC,CAAxC,IAA6C,KAAKtF,IAAL,CAAU2D,YAAV,CAAuB,QAAvB,EAAiCsJ,WAAjC,EAAjD,EAAiG;AAC7FlN,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0DU,MAA1D,GAAmE,IAAnE;AACA5C,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0D0B,YAA1D,CAAuE7E,GAAG2E,MAA1E,EAAkFC,WAAlF,GAAgGA,WAAhG;AACA3D,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0DiD,QAA1D,CAAmE2G,KAAnE;AACA9L,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0DrB,CAA1D,GAA8D0I,SAAUrH,CAAD,GAAMsH,SAA7E;AACAxJ,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0DvB,CAA1D,GAA8DgK,SAAUzI,CAAD,GAAM2J,SAA7E;AACH,qBAND,MAOK;AACD7L,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0DU,MAA1D,GAAmE,IAAnE;AACA5C,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0D0B,YAA1D,CAAuE7E,GAAG2E,MAA1E,EAAkFC,WAAlF,GAAgGA,WAAhG;AACA3D,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0DiD,QAA1D,CAAmE2G,KAAnE;AACA9L,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0DrB,CAA1D,GAA8D0I,SAAS,CAACrH,IAAI,CAAL,IAAUsH,SAAjF;AACAxJ,yCAAiBU,QAAjB,CAA0B/B,SAAS6H,aAAT,GAAyB,CAAzB,GAA6BtE,CAAvD,EAA0DvB,CAA1D,GAA8DgK,SAAS,CAACzI,IAAI,CAAL,IAAU2J,SAAjF;AACH;AAEJ;;AAGD;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACI7L,iCAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6ByF,iBAA7B;AACJ;AACH;AACJ;AACJ,KAjlCI;;AAolCL;AACAwF,iBAAa,uBAAY;;AAErB,YAAIC,SAAS,CACT,CAAC,EAAD,EAAK,CAAL,CADS,EAET,CAAC,CAAD,EAAI,CAAC,EAAL,CAFS,EAGT,CAAC,CAAC,EAAF,EAAM,CAAN,CAHS,EAIT,CAAC,CAAC,CAAF,EAAK,CAAC,EAAN,CAJS,CAAb;;AAQA,YAAIpN,mBAAmB,KAAKC,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAvB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAIvD,SAAS6H,aAA7B,EAA4CtE,GAA5C,EAAiD;AAC7ClC,6BAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BU,MAA7B,GAAsC,KAAtC;AACA5C,6BAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BiD,QAA7B,CAAsC,CAAtC;;AAGAnF,6BAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BrB,CAA7B,GAAiC,KAAKD,kBAAL,GAA2BsB,CAAD,GAAMkL,OAAO,KAAKzL,MAAL,GAAc,CAArB,EAAwB,CAAxB,CAAjE;AACA3B,6BAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6BvB,CAA7B,GAAiC,KAAKF,kBAAL,GAA2ByB,CAAD,GAAMkL,OAAO,KAAKzL,MAAL,GAAc,CAArB,EAAwB,CAAxB,CAAjE;;AAEA3B,6BAAiBU,QAAjB,CAA0BwB,CAA1B,EAA6ByF,iBAA7B;AACH;;AAED,YAAI,KAAK8D,eAAT,EAA0B;AACtB,iBAAK,IAAIvJ,IAAI,CAAb,EAAgBA,IAAI,KAAKuJ,eAAL,CAAqBjE,MAAzC,EAAiDtF,GAAjD,EAAsD;AAClD,qBAAKuJ,eAAL,CAAqBvJ,CAArB,EAAwBgC,gBAAxB,CAAyC,IAAzC;AACA,qBAAKuH,eAAL,CAAqBvJ,CAArB,IAA0B,IAA1B;AACH;AACD,iBAAKuJ,eAAL,GAAuB,EAAvB;AACH;AACJ,KAlnCI;;AAonCL;AACA4B,yBAAoB,+BAAU;AAC1B,YAAIC,gBAAgB,EAApB;AACA,YAAIC,WAAW,CAAf;AACA,YAAIC,YAAY,CAAhB;AACA,YAAIC,YAAY,CAAhB;AACA,YAAIpI,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAImD,cAAclD,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD,gBAAIwL,QAAQ5O,QAAQ6O,UAAR,CAAmBtI,cAAc3E,QAAd,CAAuBwB,CAAvB,EAA0B+B,SAA7C,CAAZ;AACA,gBAAIyJ,SAAS,CAAb,EAAgB;AACZH,2BAAWA,WAAW,CAAtB;AACH,aAFD,MAGK,IAAIG,SAAS,CAAb,EAAgB;AACjBF,4BAAYA,YAAY,CAAxB;AACH,aAFI,MAGA,IAAIE,SAAS,CAAb,EAAgB;AACjBD,4BAAYA,YAAY,CAAxB;AACH;AACJ;AACDH,sBAAc,CAAd,IAAmBC,QAAnB;AACAD,sBAAc,CAAd,IAAmBE,SAAnB;AACAF,sBAAc,CAAd,IAAmBG,SAAnB;AACA,eAAOH,aAAP;AACH,KA3oCI;;AA6oCL;AACA;AACAM,4BAAuB,gCAASC,gBAAT,EAA0B;AAC7C,YAAIP,gBAAgB,KAAKD,mBAAL,EAApB;AACA,YAAIQ,gBAAJ,EAAqB;AACjB,gBAAIH,QAAQ,CAAZ;AACAA,oBAASJ,cAAc,CAAd,IAAmBA,cAAc,CAAd,CAApB,GAAsC,CAAtC,GAAwC,CAAhD;AACAI,oBAASJ,cAAcI,KAAd,IAAuBJ,cAAc,CAAd,CAAxB,GAA0CI,KAA1C,GAAgD,CAAxD;AACA,mBAAOA,KAAP;AACH,SALD,MAMI;AACA;AACA,gBAAIA,QAAQ,CAAZ;AACAA,oBAASJ,cAAc,CAAd,IAAmB,CAApB,GAAuB,CAAC,CAAxB,GAA0B,CAAlC;AACA,gBAAII,UAAU,CAAC,CAAf,EACA;AACIA,wBAASJ,cAAc,CAAd,IAAmB,CAApB,GAAuB,CAAC,CAAxB,GAA0B,CAAlC;AACH,aAHD,MAII;AACA,oBAAIA,cAAc,CAAd,KAAoB,CAAxB,EAA0B;AACtBI,4BAASJ,cAAc,CAAd,IAAmBA,cAAc,CAAd,CAApB,GAAsC,CAAtC,GAAwC,CAAhD;AACH;AACJ;;AAED,gBAAII,UAAU,CAAC,CAAf,EACA;AACIA,wBAAQ,CAAR;AACH,aAHD,MAII;AACA,oBAAIJ,cAAc,CAAd,KAAoB,CAAxB,EAA0B;AACtBI,4BAASJ,cAAcI,KAAd,IAAuBJ,cAAc,CAAd,CAAxB,GAA0CI,KAA1C,GAAgD,CAAxD;AACH;AACJ;AACD;AACA,mBAAOA,KAAP;AACH;AACJ,KAjrCI;;AAmrCL;AACAI,uBAAkB,6BAAU;AACxB,YAAIC,YAAY,KAAKH,sBAAL,EAAhB;AACA,YAAII,UAAU,CAAd;;AAEA,YAAI3I,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAImD,cAAclD,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD,gBAAIwL,QAAQ5O,QAAQ6O,UAAR,CAAmBtI,cAAc3E,QAAd,CAAuBwB,CAAvB,EAA0B+B,SAA7C,CAAZ;AACA,gBAAI8J,cAAcL,KAAlB,EACA;AACIM,0BAAUA,UAAU,CAApB;AACA,qBAAKvJ,iBAAL,CAAuBvC,CAAvB;AACH;AACD,gBAAI8L,YAAY,CAAhB,EACA;AACI;AACH;AACJ;AACJ,KArsCI;;AAusCL;AACAC,qBAAgB,yBAASC,MAAT,EAAgBhI,IAAhB,EAChB;AACI,YAAIb,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;;AAEA,YAAIiO,YAAY,EAAhB;AACA,YAAIC,aAAa,EAAjB;AACA,YAAIlI,QAAQ,CAAZ,EACIkI,aAAa,EAAb,CADJ,KAEK,IAAGlI,QAAQ,CAAR,IAAaA,QAAQ,CAAxB,EACDkI,aAAa,EAAb;AACJ,YAAIpF,QAAQ,KAAZ;AACA;AACA,YAAI9C,QAAQ,CAAZ,EAAc;AACV,mBAAO,IAAP,EAAY;AACR,oBAAImI,UAASxP,UAAUyP,YAAV,CAAuBjJ,cAAclD,aAArC,CAAb;AACA6G,wBAAQ,KAAR;AACA,qBAAK,IAAI9G,IAAE,CAAX,EAAaA,IAAIiM,UAAU3G,MAA3B,EAAkCtF,GAAlC,EAAsC;AAClC,wBAAIiM,UAAUjM,CAAV,KAAgBmM,OAApB,EAA6B;AACzBrF,gCAAQ,IAAR;AACH;AACJ;AACD,oBAAI,CAACA,KAAL,EAAY;AACRmF,8BAAUA,UAAU3G,MAApB,IAA8B6G,OAA9B;AACA,wBAAIF,UAAU3G,MAAV,IAAmB,CAAvB,EAA0B;AACtB;AACH;AACJ;AACJ;AACD,iBAAK,IAAItF,IAAE,CAAX,EAAaA,IAAIiM,UAAU3G,MAA3B,EAAkCtF,GAAlC,EAAsC;AAClC,qBAAK,IAAI8F,IAAE,CAAX,EAAaA,IAAI3C,cAAclD,aAA/B,EAA6C6F,GAA7C,EAAiD;AAC7C,wBAAImG,UAAUjM,CAAV,KAAgB8F,CAApB,EAAsB;AAClB,4BAAIuG,eAAelJ,cAAc3E,QAAd,CAAuBsH,CAAvB,EAA0BrH,CAA7C;AACA0E,sCAAc3E,QAAd,CAAuBsH,CAAvB,EAA0BrH,CAA1B,GAA8B4N,eAAaH,UAA3C;AACA/I,sCAAc3E,QAAd,CAAuBsH,CAAvB,EAA0B1B,OAA1B,GAAoC,IAApC;AACA;AACH;AACJ;AACJ;AACJ,SA1BD,MA2BI;AACA,iBAAK,IAAIpE,IAAE,CAAX,EAAaA,IAAI,CAAjB,EAAmBA,GAAnB,EAAuB;AACnB,qBAAK,IAAI8F,IAAE,CAAX,EAAaA,IAAI3C,cAAclD,aAA/B,EAA6C6F,GAA7C,EAAiD;AAC7C,wBAAIkG,OAAOhM,CAAP,KAAamD,cAAc3E,QAAd,CAAuBsH,CAAvB,EAA0B/D,SAA3C,EAAsD;AAClD,4BAAIsK,eAAelJ,cAAc3E,QAAd,CAAuBsH,CAAvB,EAA0BrH,CAA7C;AACA0E,sCAAc3E,QAAd,CAAuBsH,CAAvB,EAA0BrH,CAA1B,GAA8B4N,eAAaH,UAA3C;AACA;AACH;AAEJ;AACJ;AACJ;AACD,YAAIjF,OAAO,IAAX;AACA,YAAIqF,SAAQzP,GAAG0P,SAAH,CAAa,CAAb,CAAZ;AACA,YAAIC,UAAU3P,GAAG4P,QAAH,CAAY,YAAU;AAChC,iBAAK,IAAIzM,IAAE,CAAX,EAAaA,IAAImD,cAAclD,aAA/B,EAA6CD,GAA7C,EAAiD;AAC7C,oBAAI0M,KAAKvJ,cAAc3E,QAAd,CAAuBwB,CAAvB,CAAT;AACA,oBAAIgE,QAAO,CAAX,EACA;AACI,wBAAIb,cAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BoE,OAA9B,EAAsC;AAClCsI,2BAAGC,SAAH,CAAa9P,GAAG+P,MAAH,CAAU,GAAV,EAAc/P,GAAGmE,CAAH,CAAK0L,GAAG/N,CAAR,EAAU+N,GAAGjO,CAAH,GAAOyN,UAAjB,CAAd,CAAb;AACH;AACJ,iBALD,MAMI;AACA,wBAAIQ,GAAGjO,CAAH,GAAMwI,KAAK1I,kBAAf,EAAmC;AAC/BmO,2BAAGC,SAAH,CAAa9P,GAAG+P,MAAH,CAAU,GAAV,EAAc/P,GAAGmE,CAAH,CAAK0L,GAAG/N,CAAR,EAAUsI,KAAK1I,kBAAf,CAAd,CAAb;AACH;AACJ;AACJ;AACJ,SAfa,CAAd;;AAiBA,YAAIsO,WAAWhQ,GAAGgQ,QAAH,CAAYP,MAAZ,EAAoBE,OAApB,CAAf;AACArJ,sBAAcwJ,SAAd,CAAwBE,QAAxB;AAEH,KAjxCI;;AAmxCL;AACAC,0BAAqB,gCACrB;AACI,YAAIC,MAAO,KAAK3J,WAAL,CAAiBC,eAA5B;AACA,YAAI2J,aAAa,KAAKC,kBAAL,EAAjB;AACA,aAAK,IAAIjN,IAAI+M,MAAM,CAAnB,EAAsB/M,KAAK,CAA3B,EAA8BA,GAA9B,EAAmC;AAC/B,iBAAK,IAAI8F,IAAI,CAAb,EAAgBA,IAAIkH,WAAW1H,MAA/B,EAAuCQ,GAAvC,EAA4C;AACxC,oBAAK,KAAK1C,WAAL,CAAiBmC,WAAjB,CAA6BvF,CAA7B,CAAL,EAAsC;AAClC,wBAAK,KAAKoD,WAAL,CAAiBmC,WAAjB,CAA6BvF,CAA7B,KAAmCgN,WAAWlH,CAAX,CAAxC,EAAuD;AAClD,6BAAK1C,WAAL,CAAiBmC,WAAjB,CAA6B2H,MAA7B,CAAoClN,CAApC,EAAuC,CAAvC;AACD,iCAFmD,CAEzC;AACb;AACJ;AACJ;AACJ;AACD,aAAKoD,WAAL,CAAiBC,eAAjB,GAAmC,KAAKD,WAAL,CAAiBC,eAAjB,GAAmC,CAAtE;AACA,aAAKuB,gBAAL;AACH,KApyCI;;AAsyCL;AACAqI,wBAAmB,8BACnB;AACI,eAAO,KAAKhP,gBAAZ;AACH,KA1yCI;;AA4yCL;AACA0J,+BAA0B,qCAAU;AAChC,YAAIwF,QAAQ,CAAZ;AACA,YAAIhK,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAImD,cAAclD,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD,gBAAImD,cAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BvB,CAA1B,GAA8B,KAAKF,kBAAvC,EACA;AACI4O,wBAAQA,QAAQ,CAAhB;AACH;AACJ;AACD,eAAOA,QAAQ,CAAf;AACH,KAvzCI;;AAyzCLC,0BAAqB,8BAASC,UAAT,EAAoB;AACrC,aAAK3P,oBAAL,GAA4B2P,UAA5B;AACH,KA3zCI;;AA6zCL;AACAjH,uBAAkB,6BAAU;AACxB,YAAIjD,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAImD,cAAclD,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD,gBAAIwL,QAAQ5O,QAAQ6O,UAAR,CAAmBtI,cAAc3E,QAAd,CAAuBwB,CAAvB,EAA0B+B,SAA7C,CAAZ;AACA,gBAAIyJ,SAAS,KAAK9N,oBAAlB,EAAuC;AACnCyF,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BwK,KAA1B,GAAkC,IAAI3N,GAAG4N,KAAP,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,CAAlC;AACH,aAFD,MAGI;AACAtH,8BAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BwK,KAA1B,GAAkC,IAAI3N,GAAG4N,KAAP,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,CAAlC;AACH;AACJ;AACJ,KAz0CI;;AA20CL;AACAvF,4BAAuB,gCAASoI,GAAT,EAAa;AAChC,YAAInK,gBAAgB,KAAKpF,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAApB;AACA,aAAK,IAAIgC,IAAI,CAAb,EAAgBA,IAAImD,cAAclD,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD,gBAAImD,cAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BvB,CAA1B,IAA+B,KAAKF,kBAAxC,EACA;AACI,oBAAI+O,GAAJ,EAAQ;AACJnK,kCAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BwK,KAA1B,GAAkC,IAAI3N,GAAG4N,KAAP,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,CAAlC;AACH,iBAFD,MAEK;AACDtH,kCAAc3E,QAAd,CAAuBwB,CAAvB,EAA0BwK,KAA1B,GAAkC,IAAI3N,GAAG4N,KAAP,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,CAAlC;AACH;AACJ;AACJ;AACD,aAAK7M,gBAAL,GAAwB0P,GAAxB;AACH,KAz1CI;;AA21CL;AACA/K,uBAAmB,2BAAUkF,UAAV,EAAsB;;AAErC;AACA;AACA,YAAIC,QAAQ,KAAK3J,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAZ;AACA,YAAID,OAAO2J,MAAMlJ,QAAN,CAAeiJ,UAAf,CAAX;;AAEA,YAAI1F,YAAYhE,KAAKgE,SAArB;;AAEA,YAAIgE,QAAQ0B,UAAZ;;AAEA,YAAI1J,KAAKU,CAAL,IAAU,KAAKF,kBAAnB,EAAuC;AACnC,gBAAI,CAAC,KAAKX,gBAAV,EACA;AACI;AACH;;AAED;AACA,iBAAKK,gBAAL,CAAsB,KAAKA,gBAAL,CAAsBqH,MAA5C,IAAsDvD,SAAtD;;AAEAhE,iBAAKU,CAAL,GAASV,KAAKU,CAAL,GAAS,EAAlB;AACAV,iBAAKkF,QAAL,CAAc,GAAd;;AAEAtG,sBAAU+I,gBAAV,CAA2B,mBAA3B;;AAEA;AACA,iBAAK,IAAI1F,IAAI,CAAb,EAAgBA,IAAI0H,MAAMzH,aAA1B,EAAyCD,GAAzC,EAA8C;AAC1C,oBAAIjC,QAAQ2J,MAAMlJ,QAAN,CAAewB,CAAf,CAAZ,EAA+B;AAC3B+F,4BAAQ/F,CAAR;AACA;AACH;AACJ;;AAED,gBAAI+F,SAAS,CAAC,CAAd,EAAiB;AACb,qBAAK,IAAI/F,IAAI+F,QAAQ,CAArB,EAAwB/F,IAAI0H,MAAMzH,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD0H,0BAAMlJ,QAAN,CAAewB,CAAf,EAAkBrB,CAAlB,IAAuB,EAAvB;AACH;AACJ;AACD,gBAAG,CAAC,KAAKgJ,yBAAL,EAAJ,EAAqC;AACjC,qBAAKzC,sBAAL,CAA4B,KAA5B;AACH;AACJ,SA9BD,MA+BI;;AAEA;AACA,gBAAIa,QAAQ,KAAK9H,gBAAL,CAAsBsP,OAAtB,CAA8BxL,SAA9B,CAAZ;AACA,gBAAIgE,QAAQ,CAAC,CAAb,EAAgB;AACZ,qBAAK9H,gBAAL,CAAsBiP,MAAtB,CAA6BnH,KAA7B,EAAoC,CAApC;AACH;;AAEDhI,iBAAKU,CAAL,GAASV,KAAKU,CAAL,GAAS,EAAlB;AACAV,iBAAKkF,QAAL,CAAc,CAAd;AACA;AACA,iBAAK,IAAIjD,IAAI,CAAb,EAAgBA,IAAI0H,MAAMzH,aAA1B,EAAyCD,GAAzC,EAA8C;AAC1C,oBAAIjC,QAAQ2J,MAAMlJ,QAAN,CAAewB,CAAf,CAAZ,EAA+B;AAC3B+F,4BAAQ/F,CAAR;AACA;AACH;AACJ;;AAED,gBAAI+F,SAAS,CAAC,CAAd,EAAiB;AACb,qBAAK,IAAI/F,IAAI+F,QAAQ,CAArB,EAAwB/F,IAAI0H,MAAMzH,aAAlC,EAAiDD,GAAjD,EAAsD;AAClD0H,0BAAMlJ,QAAN,CAAewB,CAAf,EAAkBrB,CAAlB,IAAuB,EAAvB;AACH;AACJ;AACD,gBAAG,KAAKgJ,yBAAL,EAAH,EAAoC;AAChC,qBAAKzC,sBAAL,CAA4B,IAA5B;AACH;AACJ;AACJ;AAj6CI,CAAT","file":"PlayerCardLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\desk","sourcesContent":["var GameDefs = require(\"GameDefs\");\r\nvar Resources = require(\"Resources\");\r\nimport { TSCommon } from \"../../TSCommon\";\r\nvar GameCfg = require(\"GameCfg\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        //碰杠预置体\r\n        PengGangPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n\r\n        //杠牌选择预置体\r\n        gangMoreSelectPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n\r\n        arrowSpriteFrame: {\r\n            default: null,\r\n            type: cc.SpriteFrame,\r\n        },\r\n\r\n        ArrowTag: 1000,\r\n        m_nQueYiMenStyleType:-1,\r\n    },\r\n\r\n\r\n    onLoad: function () {\r\n        this.setTouchMjEnable = true;\r\n\r\n        this.init();\r\n\r\n        var holdCardRootNode = this.node.getChildByName(\"holds\");\r\n        \r\n    },\r\n\r\n    init: function () {\r\n\r\n        this.threeMjValueList = new Array();\r\n        this.m_saveMjGroupCard = new Array();\r\n\r\n        this.m_actionState = GameDefs.PlayerAction.paNothing;\r\n\r\n        var holdCardRootNode = this.node.getChildByName(\"holds\");\r\n\r\n        this.m_selfOriginalPosY = holdCardRootNode.children[0].y;\r\n\r\n        this.m_selfOriginalPosX = holdCardRootNode.children[0].x;\r\n\r\n        this.node.parent.on(cc.Node.EventType.TOUCH_START, this.onTouchBegan, this)\r\n\r\n        this.node.parent.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this)\r\n\r\n        this.node.parent.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n\r\n        this.node.parent.on(cc.Node.EventType.TOUCH_CANCEL, this.onCancel, this);\r\n    },\r\n\r\n\r\n\r\n    onTouchBegan: function (event) {\r\n        if (this.m_nPos != 1) {\r\n            return;\r\n        }\r\n        \r\n\r\n        var pos = event.touch.getLocation();\r\n\r\n        var holdCardRootNode = this.node.getChildByName(\"holds\");\r\n\r\n        this.m_touchMoved = false;\r\n\r\n        this.m_touchPoint = pos;\r\n\r\n        var touchIndex = -1;\r\n\r\n        for (var i = 0; i < holdCardRootNode.childrenCount; i++) {\r\n            var convertPos = holdCardRootNode.children[i].convertToNodeSpace(pos)\r\n            var size = holdCardRootNode.children[i].getContentSize();\r\n\r\n            var rect = cc.rect(0, 0, size.width, size.height);\r\n\r\n            if (rect.contains(convertPos) && holdCardRootNode.children[i].active == true) {\r\n                touchIndex = i;\r\n                break;\r\n            }\r\n\r\n        }\r\n\r\n        this.m_TouchIndex = touchIndex;\r\n    },\r\n\r\n    onTouchMove: function (event) {\r\n\r\n\r\n        if (this.m_nPos != 1) {\r\n            return;\r\n        }\r\n\r\n        var pos = event.touch.getLocation();\r\n\r\n        var prePos = event.touch.getPreviousLocation();\r\n\r\n        var holdCardRootNode = this.node.getChildByName(\"holds\");\r\n        if (this.m_TouchIndex != -1) {\r\n            var touchMj = holdCardRootNode.children[this.m_TouchIndex];\r\n            var touchMjPos = cc.p(touchMj.getPosition());\r\n\r\n            if (cc.pDistanceSQ(pos, this.m_touchPoint) > 100) {\r\n                this.m_touchMoved = true;\r\n            }\r\n            else {\r\n                this.m_touchMoved = false;\r\n            }\r\n\r\n            var offsetVec = cc.p(pos.x - prePos.x, pos.y - prePos.y)\r\n\r\n            if (this.m_touchMoved) {\r\n                if (!this.m_moveMj) {\r\n                    this.m_moveMj = new cc.Node();\r\n\r\n                    var desPos = this.node.parent.convertToNodeSpace(touchMjPos);\r\n\r\n                    var sprite = this.m_moveMj.addComponent(cc.Sprite);\r\n                    sprite.spriteFrame = touchMj.getComponent(cc.Sprite).spriteFrame;\r\n                    this.m_moveMj.x = desPos.x;\r\n                    this.m_moveMj.y = desPos.y;\r\n                    this.m_moveMj.setAnchorPoint(cc.p(0, 0.5));\r\n                    this.node.parent.addChild(this.m_moveMj, 5);\r\n                }\r\n                else {\r\n                    var sprite = this.m_moveMj.getComponent(cc.Sprite);\r\n                    this.m_moveMj.x += offsetVec.x;\r\n                    this.m_moveMj.y += offsetVec.y;\r\n                }\r\n\r\n                if ((Math.abs(this.m_moveMj.x - touchMjPos.x) > 30 || Math.abs(this.m_moveMj.y - touchMjPos.y) > 30) &&\r\n                    this.m_moveMj.y > touchMjPos.y + 30) {\r\n                    this.m_moveMj.cardValue = touchMj.cardValue\r\n                }\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    onTouchEnd: function (event) {\r\n\r\n        if (this.m_nPos != 1) {\r\n            return;\r\n        }\r\n\r\n        var holdCardRootNode = this.node.getChildByName(\"holds\");\r\n\r\n        var cardValue;\r\n        if (this.m_moveMj) {\r\n            cardValue = this.m_moveMj.cardValue;\r\n            this.m_moveMj.removeFromParent();\r\n            this.m_moveMj = null;\r\n        }\r\n        if (this.node.parent.getComponent(\"DeskScene\").getIsGameChangeMjing())\r\n        {\r\n        }else{\r\n            if (!this.node.parent.getComponent(\"DeskScene\").getIsGameRunning())\r\n                return;\r\n        }\r\n        \r\n        TSCommon.dispatchEvent(GameCfg.unSelectedMj, null);\r\n\r\n        if (this.m_TouchIndex == -1) { \r\n            this.retsetAllHandCardPos();\r\n        }\r\n        else {\r\n             //若是换牌阶段，去执行另外一种提起麻将的方式\r\n            if (this.node.parent.getComponent(\"DeskScene\").getIsGameChangeMjing())\r\n                {\r\n                    this.onChooseMjClicked(this.m_TouchIndex);\r\n                    this.m_TouchIndex = -1;\r\n                    return\r\n                }\r\n\r\n            if (!this.m_touchMoved)\r\n                this.onMjClicked(this.m_TouchIndex);\r\n            else {\r\n\r\n                if (this.canOutCard) {\r\n                    if (cardValue != undefined) {\r\n                        require(\"sendCMD\").sendCMD_PO_OUTCARD(cardValue);\r\n                        this.removeAllCardArrow()\r\n\r\n                        if(this.isFirstOutCard()){\r\n                            this.recordFirstOutCardToServer();\r\n                        }\r\n\r\n                        var vCardList = {}\r\n                        vCardList.cardValue = cardValue\r\n                        TSCommon.dispatchEvent(GameCfg.NOTIFICATION_LISTENCARD, vCardList);\r\n\r\n                        holdCardRootNode.children[this.m_TouchIndex].setScale(1);\r\n                        holdCardRootNode.children[this.m_TouchIndex].y = this.m_selfOriginalPosY;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.m_TouchIndex = -1;\r\n    },\r\n\r\n    onCancel: function (event) {\r\n        if (this.m_nPos != 1) {\r\n            return;\r\n        }\r\n\r\n        this.onTouchEnd();\r\n    },\r\n\r\n    //重设所有的牌的坐标  无视最后一张牌的情况\r\n    resetAllHandCardPosWithNoDiff: function () {\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < holdCardsNode.childrenCount; i++) {\r\n            holdCardsNode.children[i].x = i * 79 + this.m_selfOriginalPosX;\r\n            holdCardsNode.children[i].y = this.m_selfOriginalPosY;\r\n            holdCardsNode.children[i].setScale(1);\r\n        }\r\n    },\r\n\r\n    //重设所有的牌的坐标 如果可以吃牌的时候  最后一张牌就会拉开距离\r\n    retsetAllHandCardPos: function () {\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < holdCardsNode.childrenCount; i++) {\r\n            if (this.canOutCard && i == this.m_playerMjs.cbHoldCardCount - 1) {\r\n                holdCardsNode.children[i].x = holdCardsNode.children[i - 1].x + 110;\r\n                holdCardsNode.children[i].setScale(1);\r\n                holdCardsNode.children[i].y = this.m_selfOriginalPosY;\r\n            }\r\n            else {\r\n                holdCardsNode.children[i].x = i * 79 + this.m_selfOriginalPosX;\r\n                holdCardsNode.children[i].y = this.m_selfOriginalPosY;\r\n                holdCardsNode.children[i].setScale(1);\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    //设定当前玩家是否可以出牌\r\n    setCanOutCard: function (canOutCard) {\r\n        this.canOutCard = canOutCard;\r\n    },\r\n\r\n    //设定当前玩家信息\r\n    setPlayerMj: function (PlayerMj) {\r\n        this.m_playerMjs = PlayerMj;\r\n    },\r\n\r\n    setmjLaiziValue: function (laiziValue) {\r\n        this.m_laiziValue = laiziValue;\r\n    },\r\n\r\n    setmjLaizipiValue: function (laizipiValue) {\r\n        this.m_laizipiValue = laizipiValue;\r\n    },\r\n\r\n    setPlayerPos: function (nPos) {\r\n        this.m_nPos = nPos;\r\n    },\r\n\r\n    //设定当前玩家可进行的操作(比如 出牌， 碰牌， 杠牌， 胡牌， 吃牌)\r\n    setActionState: function (actionState) {\r\n\r\n        this.m_actionState = actionState;\r\n    },\r\n\r\n    //设定玩家麻将的\r\n    setPlayerMjFrameByNode: function (node, spriteFrame, cardValue) {\r\n        node.active = true;\r\n        node.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n        node.cardValue = cardValue;\r\n        node.bolMove = false;\r\n    },\r\n\r\n    getLastHandCard: function () {\r\n        var cbHoldCardCount;\r\n        if(this.m_playerMjs){\r\n            cbHoldCardCount = this.m_playerMjs.cbHoldCardCount;\r\n            var holdCardsNode = this.node.getChildByName(\"holds\");\r\n\r\n            if (this.m_nPos != 2) {\r\n                return holdCardsNode.children[cbHoldCardCount - 1];\r\n            }\r\n            else {\r\n                return holdCardsNode.children[GameDefs.MAX_HOLD_CARD - cbHoldCardCount];\r\n            }\r\n        }\r\n        else{\r\n            return null;\r\n        }\r\n    },\r\n\r\n    doCards: function (bFreshPutCard,bolHu) {\r\n        if (this.m_playerMjs == null) {\r\n            return;\r\n        }\r\n\r\n        this.putPairsAndEatMj();\r\n\r\n        if (!bFreshPutCard){\r\n            if (!this.isHandCardNeedRefresh()) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (this.m_nPos == 1) {\r\n            this.putSelfHandCards();\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            this.putRightHandCards();\r\n        }\r\n        else if (this.m_nPos == 3) {\r\n            this.putTopHandCards();\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            this.putLeftHandCards();\r\n        }\r\n\r\n        this.setEndCardPosByPosAndStated(true);\r\n\r\n        this.saveHandCards();\r\n\r\n        if (bolHu) \r\n            this.setGrayForCannotUpCard(false)\r\n     \r\n    },\r\n\r\n    getOneMj: function (mjCardValue) {\r\n        var preCount = this.m_saveMjGroupCard.length;\r\n        if (preCount <= 0) {\r\n            return;\r\n        }\r\n\r\n        var mjCardValue = this.m_playerMjs.cbHoldCards[this.m_playerMjs.cbHoldCardCount - 1];\r\n\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        if (this.m_nPos == 1) {\r\n            if (holdCardsNode.children[preCount]) {\r\n                holdCardsNode.children[preCount].active = true;\r\n                var spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").get_face_li_SpriteFrame(\"mj1\", mjCardValue);\r\n                this.setPlayerMjFrameByNode(holdCardsNode.children[preCount], spriteFrame, mjCardValue);\r\n                holdCardsNode.children[preCount].y = this.m_selfOriginalPosY;\r\n                holdCardsNode.children[preCount].setScale(1);\r\n                holdCardsNode.children[preCount].removeAllChildren();\r\n\r\n                // if (mjCardValue == this.m_laiziValue || mjCardValue == this.m_laizipiValue) {\r\n                //     var laiziIcon = new cc.Node();\r\n                //     var sprite = laiziIcon.addComponent(cc.Sprite);\r\n\r\n                //     var frame;\r\n                //     if (mjCardValue == this.m_laiziValue) {\r\n                //         frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_hh_li_laizi\r\n                //     }\r\n                //     else {\r\n                //         frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_metop_cao\r\n                //     }\r\n\r\n                //     sprite.spriteFrame = frame;\r\n\r\n                //     laiziIcon.x = holdCardsNode.children[preCount].getContentSize().width - laiziIcon.getContentSize().width / 2;\r\n                //     laiziIcon.y = holdCardsNode.children[preCount].getContentSize().height / 2 - laiziIcon.getContentSize().height / 2 - 15;\r\n                //     holdCardsNode.children[preCount].addChild(laiziIcon);\r\n                // }\r\n\r\n                Resources.playCommonEffect(\"getcard.mp3\");\r\n\r\n                //判定是否出了后会听牌\r\n                var vOutCardList = this.node.parent.getComponent(\"DeskScene\").m_stSceneData.vTingList;\r\n\r\n                for(var j = 0; j <= preCount; j++){\r\n                    for (var index = 0; index < vOutCardList.length; index++) {\r\n                        if (vOutCardList[index].cbOutCard == holdCardsNode.children[j].cardValue) {\r\n                            var arrowNode = new cc.Node();\r\n                            arrowNode.active = true;\r\n                            var arrowSprite = arrowNode.addComponent(cc.Sprite);\r\n                            arrowSprite.spriteFrame = this.arrowSpriteFrame;\r\n                            var size = holdCardsNode.children[j].getContentSize();\r\n                            arrowNode.x = size.width / 2;\r\n                            arrowNode.y = size.height / 2 + arrowNode.getContentSize().height / 2 + 10;\r\n                            holdCardsNode.children[j].addChild(arrowNode, 0, this.ArrowTag + j);\r\n                        }\r\n                    }\r\n                }\r\n                \r\n            }\r\n\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            if (holdCardsNode.children[GameDefs.MAX_HOLD_CARD - preCount - 1]) {\r\n                holdCardsNode.children[GameDefs.MAX_HOLD_CARD - preCount - 1].active = true;\r\n            }\r\n        }\r\n        else {\r\n            if (holdCardsNode.children[preCount]) {\r\n                holdCardsNode.children[preCount].active = true;\r\n            }\r\n        }\r\n\r\n\r\n        if (this.m_nPos == 1) {\r\n            if (holdCardsNode.children[preCount] && holdCardsNode.children[preCount - 1]) {\r\n                holdCardsNode.children[preCount].x = holdCardsNode.children[preCount - 1].x + 110;\r\n            }\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            if (holdCardsNode.children[GameDefs.MAX_HOLD_CARD - preCount - 1] && holdCardsNode.children[GameDefs.MAX_HOLD_CARD - preCount]) {\r\n                holdCardsNode.children[GameDefs.MAX_HOLD_CARD - preCount - 1].x = holdCardsNode.children[GameDefs.MAX_HOLD_CARD - preCount].x - 15;\r\n                holdCardsNode.children[GameDefs.MAX_HOLD_CARD - preCount - 1].y = holdCardsNode.children[GameDefs.MAX_HOLD_CARD - preCount].y + 40;\r\n            }\r\n        }\r\n        else if (this.m_nPos == 3) {\r\n            if (holdCardsNode.children[preCount] && holdCardsNode.children[preCount - 1]) {\r\n                holdCardsNode.children[preCount].x = holdCardsNode.children[preCount - 1].x - 50;\r\n            }\r\n\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n\r\n            if (holdCardsNode.children[preCount] && holdCardsNode.children[preCount - 1]) {\r\n\r\n                holdCardsNode.children[preCount].x = holdCardsNode.children[preCount - 1].x - 10\r\n                holdCardsNode.children[preCount].y = holdCardsNode.children[preCount - 1].y - 60;\r\n            }\r\n        }\r\n\r\n        this.m_saveMjGroupCard.push(mjCardValue);\r\n        if (this.m_nPos == 1)\r\n            this.setQueYiMenMjGray();\r\n    },\r\n\r\n    setEndCardPosByPosAndStated: function (bIsSetPos) {\r\n        if (!bIsSetPos)\r\n            return;\r\n\r\n        var addPos = [[110, 0], [-8, 30], [-30, 0], [-8, -40]]\r\n\r\n        if (this.m_actionState == GameDefs.PlayerAction.paNothing || this.m_actionState == GameDefs.PlayerAction.paGang ||\r\n            this.m_actionState == GameDefs.PlayerAction.paOutCard) {\r\n            return;\r\n        }\r\n\r\n        var cardCount = this.m_playerMjs.cbHoldCardCount;\r\n        var holdCards = this.node.getChildByName(\"holds\");\r\n\r\n\r\n        if (this.m_nPos == 1) {\r\n            for (var i = 0; i < holdCards.childrenCount; i++) {\r\n                holdCards.children[i].x = i * 79 + this.m_selfOriginalPosX;\r\n                holdCards.children[i].y = this.m_selfOriginalPosY;\r\n                holdCards.children[i].setScale(1);\r\n\r\n            }\r\n\r\n            holdCards.children[cardCount - 1].x = holdCards.children[cardCount - 2].x + addPos[this.m_nPos - 1][0];\r\n            holdCards.children[cardCount - 1].y = holdCards.children[cardCount - 2].y + addPos[this.m_nPos - 1][1];\r\n        }\r\n\r\n        else if (this.m_nPos == 2) {\r\n            holdCards.children[GameDefs.MAX_HOLD_CARD - cardCount].x = holdCards.children[GameDefs.MAX_HOLD_CARD - cardCount].x + addPos[this.m_nPos - 1][0];\r\n            holdCards.children[GameDefs.MAX_HOLD_CARD - cardCount].y = holdCards.children[GameDefs.MAX_HOLD_CARD - cardCount].y + addPos[this.m_nPos - 1][1];\r\n        }\r\n        else {\r\n            holdCards.children[cardCount - 1].x = holdCards.children[cardCount - 1].x + addPos[this.m_nPos - 1][0];\r\n            holdCards.children[cardCount - 1].y = holdCards.children[cardCount - 1].y + addPos[this.m_nPos - 1][1];\r\n        }\r\n\r\n    },\r\n\r\n    isHandCardNeedRefresh() {\r\n        var bRefresh = false;   //是否需要重新刷新牌\r\n\r\n        if (this.m_saveMjGroupCard.length != this.m_playerMjs.cbHoldCardCount ||\r\n            this.actionState == GameDefs.PlayerAction.paPeng || this.actionState == GameDefs.PlayerAction.paEat) {\r\n            bRefresh = true;\r\n        }\r\n        else {\r\n            //判断手上的牌是否和原来的相同\r\n            var bFind = false;\r\n            for (var i = 0; i < this.m_playerMjs.cbHoldCardCount; i++) {\r\n                bFind = false;\r\n                for (var j = 0; j < this.m_saveMjGroupCard.length; j++) {\r\n                    if (this.m_playerMjs.cbHoldCards[i] == this.m_saveMjGroupCard[j]) {\r\n                        bFind = true;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if (!bFind) {\r\n                    bRefresh = true;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // cc.log(nPos + \"号椅子判定刷新的结果为：\" + bRefresh);\r\n        return bRefresh;\r\n    },\r\n\r\n    saveHandCards() {\r\n        this.m_saveMjGroupCard = [];\r\n        if (this.m_playerMjs.cbHoldCardCount > 0) {\r\n            for (var i = 0; i < this.m_playerMjs.cbHoldCardCount; i++) {\r\n                this.m_saveMjGroupCard[i] = this.m_playerMjs.cbHoldCards[i];\r\n            }\r\n        }\r\n    },\r\n    //摆自己的牌\r\n    putSelfHandCards: function () {\r\n        var holdCards = new Array();\r\n        var holdCardCount = this.m_playerMjs.cbHoldCardCount;\r\n        for (var i = 0; i < holdCardCount; i++) {\r\n            \r\n            holdCards[i] = GameCfg.getStyleBySort(this.m_playerMjs.cbHoldCards[i],this.m_nQueYiMenStyleType);\r\n        }\r\n\r\n        var self = this;\r\n        holdCards.sort(function (a, b) {\r\n\r\n            if (a != b) {\r\n                // if (a == self.m_laiziValue)\r\n                //     return -1;\r\n                // if (b == self.m_laiziValue)\r\n                //     return 999999;\r\n\r\n                return a - b;\r\n            }\r\n\r\n            return 0;\r\n        })\r\n\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n\r\n        for (var i = 0; i < holdCardCount; i++) {\r\n            holdCards[i] =holdCards[i]%100;\r\n        }\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            holdCardsNode.children[i].active = false;\r\n        }\r\n\r\n        var startX = this.m_selfOriginalPosX\r\n        var distanceX = 79;\r\n\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            if (i < holdCardCount && holdCards[i] < GameDefs.MAX_MJ_INDEX) {\r\n                var spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").get_face_li_SpriteFrame(\"mj1\", holdCards[i])\r\n                this.setPlayerMjFrameByNode(holdCardsNode.children[i], spriteFrame, holdCards[i]);\r\n                holdCardsNode.children[i].x = startX + (i) * distanceX;\r\n                holdCardsNode.children[i].y = this.m_selfOriginalPosY;\r\n                holdCardsNode.children[i].setScale(1);\r\n\r\n                holdCardsNode.children[i].removeAllChildren();\r\n\r\n\r\n                //添加癞子或者癞子皮标签\r\n                // if (holdCards[i] == this.m_laiziValue || holdCards[i] == this.m_laizipiValue) {\r\n\r\n                //     var laiziIcon = new cc.Node();\r\n                //     var sprite = laiziIcon.addComponent(cc.Sprite);\r\n\r\n                //     var frame;\r\n                //     if (holdCards[i] == this.m_laiziValue) {\r\n                //         frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_hh_li_laizi\r\n                //     }\r\n                //     else {\r\n                //         frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_metop_cao\r\n                //     }\r\n\r\n                //     sprite.spriteFrame = frame;\r\n\r\n                //     laiziIcon.x = holdCardsNode.children[i].getContentSize().width - laiziIcon.getContentSize().width / 2;\r\n                //     laiziIcon.y = holdCardsNode.children[i].getContentSize().height / 2 - laiziIcon.getContentSize().height / 2 - 15;\r\n                //     holdCardsNode.children[i].addChild(laiziIcon);\r\n                // }\r\n\r\n\r\n                //判定是否出了后会听牌\r\n                var vOutCardList = this.node.parent.getComponent(\"DeskScene\").m_stSceneData.vTingList;\r\n\r\n                for (var index = 0; index < vOutCardList.length; index++) {\r\n                    if (vOutCardList[index].cbOutCard == holdCards[i]) {\r\n                        var arrowNode = new cc.Node();\r\n                        arrowNode.active = true;\r\n                        var arrowSprite = arrowNode.addComponent(cc.Sprite);\r\n                        arrowSprite.spriteFrame = this.arrowSpriteFrame;\r\n                        var size = holdCardsNode.children[i].getContentSize();\r\n                        arrowNode.x = size.width / 2;\r\n                        arrowNode.y = size.height / 2 + arrowNode.getContentSize().height / 2 + 10;\r\n                        holdCardsNode.children[i].addChild(arrowNode, 0, this.ArrowTag + i);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                holdCardsNode.children[i].active = false;\r\n            }\r\n        }\r\n        this.setQueYiMenMjGray()\r\n    },\r\n\r\n    putRightHandCards: function () {\r\n        var holdCardCount = this.m_playerMjs.cbHoldCardCount;\r\n\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            holdCardsNode.children[i].active = false;\r\n        }\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n\r\n            holdCardsNode.children[i].x = 415 + (i) * 7;\r\n            holdCardsNode.children[i].y = 228 - (i) * 27;\r\n\r\n            if (i >= GameDefs.MAX_HOLD_CARD - holdCardCount) {\r\n                holdCardsNode.children[i].active = true;\r\n            }\r\n            else {\r\n                holdCardsNode.children[i].active = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    putTopHandCards: function () {\r\n        var holdCardCount = this.m_playerMjs.cbHoldCardCount;\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            holdCardsNode.children[i].active = false;\r\n        }\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            if (i < holdCardCount) {\r\n                holdCardsNode.children[i].active = true;\r\n                holdCardsNode.children[i].x = 215 - (i) * 33;\r\n            }\r\n            else {\r\n                holdCardsNode.children[i].active = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    putLeftHandCards: function () {\r\n        var holdCardCount = this.m_playerMjs.cbHoldCardCount;\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            holdCardsNode.children[i].active = false;\r\n        }\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            holdCardsNode.children[i].x = -415 - (i) * 7;\r\n            holdCardsNode.children[i].y = 228 - (i) * 27;\r\n\r\n            if (i < holdCardCount) {\r\n                holdCardsNode.children[i].active = true;\r\n            }\r\n            else {\r\n                holdCardsNode.children[i].active = false;\r\n            }\r\n        }\r\n    },\r\n\r\n    //移除所有牌的箭头动画\r\n    removeAllCardArrow: function () {\r\n        if (this.m_nPos != 1) {\r\n            return;\r\n        }\r\n\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            var node = holdCardsNode.children[i].getChildByTag(this.ArrowTag + i);\r\n            if (node) {\r\n                node.removeFromParent(true);\r\n            }\r\n        }\r\n    },\r\n\r\n    onMjClicked: function (clickIndex) {\r\n\r\n        var holds = this.node.getChildByName(\"holds\");\r\n        var node = holds.children[clickIndex];\r\n\r\n        var cardValue = node.cardValue;\r\n\r\n        var index = clickIndex;\r\n\r\n        TSCommon.dispatchEvent(GameCfg.unSelectedMj, null);\r\n\r\n        var vCardList = {}\r\n        vCardList.cardValue = cardValue\r\n        TSCommon.dispatchEvent(GameCfg.NOTIFICATION_LISTENCARD, vCardList);\r\n\r\n        if (node.y == this.m_selfOriginalPosY) {\r\n            if (this.getCanUpCardBySelectCount())\r\n            //重置所有牌位置\r\n            for (var i = 0; i < holds.childrenCount; i++) {\r\n                if (this.canOutCard && i == this.m_playerMjs.cbHoldCardCount - 1) {\r\n                    holds.children[i].x = holds.children[i - 1].x + 110;\r\n                    holds.children[i].y = this.m_selfOriginalPosY;\r\n                    holds.children[i].setScale(1);\r\n                }\r\n                else {\r\n                    holds.children[i].x = i * 79 + this.m_selfOriginalPosX;\r\n                    holds.children[i].y = this.m_selfOriginalPosY;\r\n                    holds.children[i].setScale(1);\r\n                }\r\n\r\n            }\r\n\r\n            node.y = node.y + 30;\r\n            node.setScale(1.2);\r\n\r\n            \r\n            TSCommon.dispatchEvent(GameCfg.selectedMj, cardValue);\r\n            Resources.playCommonEffect(\"selectmahjong.mp3\");\r\n\r\n\r\n            if(this.isFirstOutCard()){\r\n                this.recordFirstClickCardToServer();\r\n            }\r\n\r\n            //然后将之后牌往后移\r\n\r\n            for (var i = 0; i < holds.childrenCount; i++) {\r\n                if (node == holds.children[i]) {\r\n                    index = i;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (index != -1) {\r\n                for (var i = index + 1; i < holds.childrenCount; i++) {\r\n                    holds.children[i].x += 15;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n\r\n            if (this.canOutCard) {\r\n                require(\"sendCMD\").sendCMD_PO_OUTCARD(cardValue)\r\n\r\n                node.setScale(1);\r\n                node.y = node.y - 30;\r\n                this.removeAllCardArrow()        \r\n                \r\n                if(this.isFirstOutCard()){\r\n                    this.recordFirstOutCardToServer();\r\n                }\r\n            }\r\n            else {\r\n                //重置所有牌位置\r\n                for (var i = 0; i < holds.childrenCount; i++) {\r\n\r\n                    holds.children[i].x = i * 79 + this.m_selfOriginalPosX;\r\n                    holds.children[i].y = this.m_selfOriginalPosY;\r\n                    holds.children[i].setScale(1);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    //判定是否是第一次出牌\r\n    isFirstOutCard:function(){\r\n        var isFirst = true;\r\n        for(var i = 0; i < this.m_playerMjs.cbOutCards.length; i++){\r\n            if(this.m_playerMjs.cbOutCards[i] < GameDefs.MAX_MJ_INDEX && this.m_playerMjs.cbOutCards[i] >= 0){\r\n                isFirst = false;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return isFirst;\r\n    },\r\n\r\n    //记录玩家点击第一张牌 然后发给服务器\r\n    recordFirstClickCardToServer:function(){\r\n        var HallResources = require(\"HallResources\");\r\n        HallResources.recordPlayerLogToServer(HallResources.recordList.click_card);\r\n    },\r\n\r\n    //记录第一张出牌记录  然后发给服务器\r\n    recordFirstOutCardToServer:function(){\r\n        var HallResources = require(\"HallResources\");\r\n        HallResources.recordPlayerLogToServer(HallResources.recordList.click_discard);\r\n    },\r\n\r\n    gangMoresCardToast: function (gangInfoArray) {\r\n        var selectEatNode = this.node.getChildByName(\"select_penggangs\");\r\n        selectEatNode.removeAllChildren();\r\n\r\n        var onGangSelectFinish = function () {\r\n            selectEatNode.removeAllChildren();\r\n        }\r\n\r\n        var startX = -125;\r\n        var startY = 200;\r\n        var distanceX = 250;\r\n\r\n        for (var i = 0; i < gangInfoArray.length; i++) {\r\n            var gangMoreSelectItem = cc.instantiate(this.gangMoreSelectPrefab);\r\n            var gangMoreSelectItemView = gangMoreSelectItem.getComponent('EatOrGangSelectLayer');\r\n\r\n            var spriteAtlas = this.node.parent.getComponent(\"MjResourceMgr\").mj1_face_dao;\r\n            gangMoreSelectItemView.init(GameDefs.PlayerAction.paGang, gangInfoArray[i], onGangSelectFinish, spriteAtlas);\r\n            gangMoreSelectItemView.showUI();\r\n            selectEatNode.addChild(gangMoreSelectItem);\r\n\r\n            gangMoreSelectItem.x = startX + (i) * distanceX;\r\n            gangMoreSelectItem.y = startY;\r\n        }\r\n    },\r\n\r\n    //移除吃杠的多种选择\r\n    removeEatOrGangMoresCardToast: function () {\r\n        var selectEatNode = this.node.getChildByName(\"select_penggangs\");\r\n        selectEatNode.removeAllChildren();\r\n\r\n    },\r\n\r\n    getRangeSpriteFrameByPos() {\r\n        if (this.m_nPos == 1 || this.m_nPos == 3) {\r\n            return this.node.parent.getComponent(\"MjResourceMgr\").mj1_face_dao;\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            return this.node.parent.getComponent(\"MjResourceMgr\").mj1_face_suit_y;\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            return this.node.parent.getComponent(\"MjResourceMgr\").mj1_face_suit_z;\r\n        }\r\n        else {\r\n            cc.log(\"the this.m_nPos is error!\");\r\n        }\r\n    },\r\n\r\n    getCardSpriteFrame: function () {\r\n        return this.mjFrame;\r\n    },\r\n\r\n    //摆碰或者杠的牌\r\n    putPairsAndEatMj: function () {\r\n        if (this.m_pengGangArray == null) {\r\n            this.m_pengGangArray = new Array();\r\n        }\r\n        var pengGangRootNode = this.node.getChildByName('penggangs');\r\n\r\n        var pairsItem = null;\r\n        var cardSuit = null;\r\n        var startX = null;\r\n        var startY = null;\r\n        var distanceX = null;\r\n        var distanceY = null;\r\n\r\n        var scale = 1;\r\n\r\n        if (this.m_nPos == 1) {\r\n            startX = 500;\r\n            startY = -297\r\n\r\n            distanceX = -200;\r\n            distanceY = 0;\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            startX = 570;\r\n            startY = -120\r\n\r\n            distanceX = -35;\r\n            distanceY = +115;\r\n\r\n            scale = 0.9;\r\n        }\r\n        else if (this.m_nPos == 3) {\r\n            startX = -230;\r\n            startY = 330\r\n            distanceX = 120;\r\n            distanceY = 0;\r\n            scale = 0.6;\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            startX = -570;\r\n            startY = -79;\r\n\r\n            distanceX = 35;\r\n            distanceY = 115;\r\n            scale = 0.9;\r\n        }\r\n\r\n        //var MjResourceMgr = this.node.parent.getComponent(\"\")\r\n        for (var i = 0; i < this.m_playerMjs.nWeaveCount; i++) {\r\n            cardSuit = this.m_playerMjs.showCardSuits[i];\r\n\r\n            // 检查杠的数据是否有问题\r\n            if (cardSuit.cbWeaveKind == GameDefs.WeaveType.AnGang || cardSuit.cbWeaveKind == GameDefs.WeaveType.XuGang ||\r\n                cardSuit.cbWeaveKind == GameDefs.WeaveType.MingGang) {\r\n            }\r\n            if (this.m_pengGangArray[i] == null) {\r\n                pairsItem = cc.instantiate(this.PengGangPrefab);\r\n                var RangeCardLayer = pairsItem.getComponent('RangeCardLayer');\r\n                RangeCardLayer.init(cardSuit.cbWeaveKind, cardSuit.cbCardData, this.m_nPos, this.getRangeSpriteFrameByPos());//, this.m_laiziValue, this.m_laizipiValue);\r\n                pengGangRootNode.addChild(pairsItem);\r\n                pairsItem.setScale(scale);\r\n                pairsItem.x = startX + (i) * distanceX;\r\n                pairsItem.y = startY + (i) * distanceY;\r\n                this.m_pengGangArray[i] = pairsItem;\r\n            }\r\n            else {\r\n                var RangeCardLayer = this.m_pengGangArray[i].getComponent('RangeCardLayer');\r\n                RangeCardLayer.init(cardSuit.cbWeaveKind, cardSuit.cbCardData, this.m_nPos, this.getRangeSpriteFrameByPos());//, this.m_laiziValue, this.m_laizipiValue);\r\n            }\r\n        }\r\n    },\r\n\r\n    setMjGray:function(){\r\n        mjNode.color = new cc.Color(137, 137, 137);\r\n    },\r\n\r\n    //游戏结束的时候调用\r\n    gameOver: function () {\r\n        this.showHandCardOnGameOver();\r\n    },\r\n\r\n    //结束的时候将所有手牌全都展示出来\r\n    showHandCardOnGameOver: function () {\r\n\r\n        var holdCardCount = this.m_playerMjs.cbHoldCardCount;\r\n\r\n        var holdCardRootNode = this.node.getChildByName(\"holds\");\r\n\r\n        var startX = holdCardRootNode.children[0].x;\r\n        var startY = holdCardRootNode.children[0].y;\r\n        var distanceX = 40;\r\n        var distanceY = 40;\r\n        var foreName = \"\";\r\n        var scale = 1;\r\n        if (this.m_nPos == 1) {\r\n            foreName = \"hh_dao_\";\r\n            distanceX = 48;\r\n            distanceY = 0;\r\n\r\n            startX = -370;\r\n\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            foreName = \"hh_suit_y_\";\r\n            scale = 0.8;\r\n            distanceX = -8;\r\n            distanceY = 27;\r\n\r\n            var startX = holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1].x;\r\n            var startY = holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1].y;\r\n        }\r\n        else if (this.m_nPos == 3) {\r\n            foreName = \"hh_dao_\";\r\n            scale = 0.8;\r\n            distanceX = -38;\r\n            distanceY = 0;\r\n\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            foreName = \"hh_suit_z_\"\r\n            scale = 0.8;\r\n            distanceX = -8;\r\n            distanceY = -27\r\n        }\r\n\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            holdCardRootNode.children[i].active = false;\r\n        }\r\n\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n\r\n            if (i < this.m_playerMjs.cbHoldCardCount) {\r\n                var name = Resources.get_frameName(foreName, this.m_playerMjs.cbHoldCards[i]);\r\n                var spriteFrame = null;\r\n                if (this.m_nPos == 1 || this.m_nPos == 3) {\r\n                    spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").mj1_face_dao.getSpriteFrame(name);\r\n                }\r\n                else if (this.m_nPos == 2) {\r\n                    spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").mj1_face_suit_y.getSpriteFrame(name);\r\n                }\r\n                else if (this.m_nPos == 4) {\r\n                    spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").mj1_face_suit_z.getSpriteFrame(name);\r\n                }\r\n\r\n\r\n\r\n                if (this.m_nPos != 2) {\r\n\r\n                    //表明是最后一张牌 如果胡牌 则要拉开差距\r\n                    if (i == this.m_playerMjs.cbHoldCardCount - 1 && this.node.getComponent(\"Player\").getIsWinner()) {\r\n                        holdCardRootNode.children[i].active = true;\r\n                        holdCardRootNode.children[i].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                        holdCardRootNode.children[i].setScale(scale)\r\n                        holdCardRootNode.children[i].x = startX + (i) * distanceX;\r\n                        holdCardRootNode.children[i].y = startY + (i) * distanceY;\r\n                    } else {\r\n                        holdCardRootNode.children[i].active = true;\r\n                        holdCardRootNode.children[i].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                        holdCardRootNode.children[i].setScale(scale)\r\n                        holdCardRootNode.children[i].x = startX + (i - 1) * distanceX;\r\n                        holdCardRootNode.children[i].y = startY + (i - 1) * distanceY;\r\n                    }\r\n\r\n                }\r\n                else {\r\n                    if (i == this.m_playerMjs.cbHoldCardCount - 1 && this.node.getComponent(\"Player\").getIsWinner()) {\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].active = true;\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].setScale(scale)\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].x = startX + (i) * distanceX;\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].y = startY + (i) * distanceY;\r\n                    }\r\n                    else {\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].active = true;\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].setScale(scale)\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].x = startX + (i - 1) * distanceX;\r\n                        holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].y = startY + (i - 1) * distanceY;\r\n                    }\r\n\r\n                }\r\n\r\n\r\n                // if (this.m_playerMjs.cbHoldCards[i] == this.m_laiziValue || this.m_playerMjs.cbHoldCards[i] == this.m_laizipiValue) {\r\n\r\n                //     var laiziIcon = new cc.Node();\r\n                //     var sprite = laiziIcon.addComponent(cc.Sprite);\r\n\r\n                //     if (this.m_nPos == 1) {\r\n                //         holdCardRootNode.children[i].removeAllChildren();\r\n                //         var frame;\r\n                //         if (this.m_playerMjs.cbHoldCards[i] == this.m_laiziValue) {\r\n                //             frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_metop_gang_lai;\r\n                //         }\r\n                //         else {\r\n                //             frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_metop_gang_cao;\r\n                //         }\r\n\r\n                //         sprite.spriteFrame = frame;\r\n\r\n                //         laiziIcon.x = holdCardRootNode.children[i].getContentSize().width - laiziIcon.getContentSize().width / 2 - 5;\r\n                //         laiziIcon.y = holdCardRootNode.children[i].getContentSize().height / 2 - laiziIcon.getContentSize().height / 2 - 3;\r\n                //         holdCardRootNode.children[i].addChild(laiziIcon);\r\n                //     }\r\n                //     else if (this.m_nPos == 2) {\r\n                //         holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].removeAllChildren();\r\n                //         var frame;\r\n                //         if (this.m_playerMjs.cbHoldCards[i] == this.m_laiziValue) {\r\n                //             frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_right_lai;\r\n                //         }\r\n                //         else {\r\n                //             frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_right_cao;\r\n                //         }\r\n\r\n                //         sprite.spriteFrame = frame;\r\n\r\n                //         laiziIcon.x = -(holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].getContentSize().width / 2 - laiziIcon.getContentSize().width / 2) + 7;\r\n                //         laiziIcon.y = holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].getContentSize().height / 2 - laiziIcon.getContentSize().height / 2 - 3;\r\n\r\n                //         holdCardRootNode.children[GameDefs.MAX_HOLD_CARD - 1 - i].addChild(laiziIcon);\r\n                //     }\r\n                //     else if (this.m_nPos == 3) {\r\n                //         holdCardRootNode.children[i].removeAllChildren();\r\n\r\n                //         var frame;\r\n                //         if (this.m_playerMjs.cbHoldCards[i] == this.m_laiziValue) {\r\n                //             frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_metop_gang_lai\r\n                //         }\r\n                //         else {\r\n                //             frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_metop_gang_cao\r\n                //         }\r\n\r\n                //         sprite.spriteFrame = frame;\r\n\r\n                //         laiziIcon.x = holdCardRootNode.children[i].getContentSize().width / 2 - laiziIcon.getContentSize().width / 2 - 3;\r\n                //         laiziIcon.y = holdCardRootNode.children[i].getContentSize().height / 2 - laiziIcon.getContentSize().height / 2 - 3;\r\n                //         holdCardRootNode.children[i].addChild(laiziIcon);\r\n                //     }\r\n                //     else if (this.m_nPos == 4) {\r\n                //         holdCardRootNode.children[i].removeAllChildren();\r\n                //         var frame;\r\n                //         if (this.m_playerMjs.cbHoldCards[i] == this.m_laiziValue) {\r\n                //             frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_left_lai;\r\n                //         }\r\n                //         else {\r\n                //             frame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_left_cao;\r\n                //         }\r\n\r\n                //         sprite.spriteFrame = frame;\r\n\r\n                //         laiziIcon.x = holdCardRootNode.children[i].getContentSize().width / 2 - laiziIcon.getContentSize().width / 2 - 15;\r\n                //         laiziIcon.y = -(holdCardRootNode.children[i].getContentSize().height / 2 - laiziIcon.getContentSize().height / 2) + 15;\r\n                //         holdCardRootNode.children[i].addChild(laiziIcon);\r\n                //     }\r\n                // }\r\n                // else {\r\n                    holdCardRootNode.children[i].removeAllChildren();\r\n                // }\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    //清除掉所有麻将  并且将所有麻将复位\r\n    cleanAllMjs: function () {\r\n\r\n        var offset = [\r\n            [78, 0],\r\n            [7, -27],\r\n            [-34, 0],\r\n            [-7, -27],\r\n        ]\r\n\r\n\r\n        var holdCardRootNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < GameDefs.MAX_HOLD_CARD; i++) {\r\n            holdCardRootNode.children[i].active = false;\r\n            holdCardRootNode.children[i].setScale(1);\r\n\r\n\r\n            holdCardRootNode.children[i].x = this.m_selfOriginalPosX + (i) * offset[this.m_nPos - 1][0];\r\n            holdCardRootNode.children[i].y = this.m_selfOriginalPosY + (i) * offset[this.m_nPos - 1][1];\r\n\r\n            holdCardRootNode.children[i].removeAllChildren();\r\n        }\r\n\r\n        if (this.m_pengGangArray) {\r\n            for (var i = 0; i < this.m_pengGangArray.length; i++) {\r\n                this.m_pengGangArray[i].removeFromParent(true);\r\n                this.m_pengGangArray[i] = null;\r\n            }\r\n            this.m_pengGangArray = [];\r\n        }\r\n    },\r\n\r\n    //获得手上万/条/筒的数量，可以在选择换牌和选择定缺一门的时候使用\r\n    getWanTiaoTongCount:function(){\r\n        var typeCountList = [];\r\n        var wanCount = 0 \r\n        var tiaoCount = 0 \r\n        var tongCount = 0\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < holdCardsNode.childrenCount; i++) {\r\n            var nType = GameCfg.getMjColor(holdCardsNode.children[i].cardValue);\r\n            if (nType == 0) {\r\n                wanCount = wanCount + 1;\r\n            }\r\n            else if (nType == 1) {\r\n                tiaoCount = tiaoCount + 1;\r\n            }\r\n            else if (nType == 2) {\r\n                tongCount = tongCount + 1;\r\n            }\r\n        }\r\n        typeCountList[0] = wanCount;\r\n        typeCountList[1] = tiaoCount;\r\n        typeCountList[2] = tongCount;\r\n        return typeCountList;\r\n    },\r\n\r\n    //客户端选牌/选定缺\r\n    //bolChooseDingQue为是否判断缺一门，不是的话那就是判断选牌\r\n    getChooseMjTypeByCount:function(bolChooseDingQue){\r\n        var typeCountList = this.getWanTiaoTongCount();\r\n        if (bolChooseDingQue){\r\n            var nType = 0;\r\n            nType = (typeCountList[0] > typeCountList[1])?0:1;\r\n            nType = (typeCountList[nType] > typeCountList[2])?nType:2;\r\n            return nType;\r\n        }\r\n        else{\r\n            //选择换牌的话，要考虑牌类型数是不是小于3，若是小于3则提示别的牌型\r\n            var nType = 0;\r\n            nType = (typeCountList[0] < 3)?-1:0;\r\n            if (nType === -1)\r\n            {\r\n                nType = (typeCountList[1] < 3)?-1:1;\r\n            }\r\n            else{\r\n                if (typeCountList[1] >= 3){\r\n                    nType = (typeCountList[0] < typeCountList[1])?0:1;\r\n                }\r\n            }\r\n\r\n            if (nType === -1)\r\n            {\r\n                nType = 2;\r\n            }\r\n            else{\r\n                if (typeCountList[2] >= 3){\r\n                    nType = (typeCountList[nType] < typeCountList[2])?nType:2;\r\n                }\r\n            }\r\n            //这里取-1只是为了方便\r\n            return nType;\r\n        }\r\n    },\r\n\r\n    //客户端根据类型自动提示三张换牌\r\n    upThreeCardByType:function(){\r\n        var tipUpType = this.getChooseMjTypeByCount();\r\n        var upCount = 0;\r\n\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < holdCardsNode.childrenCount; i++) {\r\n            var nType = GameCfg.getMjColor(holdCardsNode.children[i].cardValue);\r\n            if (tipUpType === nType)\r\n            {\r\n                upCount = upCount + 1;\r\n                this.onChooseMjClicked(i);\r\n            }\r\n            if (upCount === 3)\r\n            {\r\n                break;\r\n            }\r\n        }\r\n    },\r\n\r\n    //插入三张牌到手中\r\n    insertThreeCard:function(cbList,nPos)\r\n    {\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        \r\n        var nTempList = [];\r\n        var moveHeight = 10\r\n        if (nPos == 1)\r\n            moveHeight = 40;\r\n        else if(nPos == 2 || nPos == 4)\r\n            moveHeight = 30;\r\n        var bFind = false\r\n        //是我自己的牌就找到对应的牌，提起之后再执行放下动作，是别人的牌，随机三个位置，然后执行提起后放下\r\n        if (nPos != 1){\r\n            while (true){\r\n                var nRandom =Resources.getOneRandom(holdCardsNode.childrenCount)\r\n                bFind = false\r\n                for (var i=0;i < nTempList.length;i++){\r\n                    if (nTempList[i] == nRandom) {\r\n                        bFind = true\r\n                    }\r\n                }\r\n                if (!bFind) {\r\n                    nTempList[nTempList.length] = nRandom;\r\n                    if (nTempList.length ==3) {\r\n                        break\r\n                    }\r\n                } \r\n            }\r\n            for (var i=0;i < nTempList.length;i++){\r\n                for (var j=0;j < holdCardsNode.childrenCount;j++){\r\n                    if (nTempList[i] == j){\r\n                        var pMjOrginPosY = holdCardsNode.children[j].y;\r\n                        holdCardsNode.children[j].y = pMjOrginPosY+moveHeight;\r\n                        holdCardsNode.children[j].bolMove = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else{\r\n            for (var i=0;i < 3;i++){\r\n                for (var j=0;j < holdCardsNode.childrenCount;j++){\r\n                    if (cbList[i] == holdCardsNode.children[j].cardValue) {\r\n                        var pMjOrginPosY = holdCardsNode.children[j].y;\r\n                        holdCardsNode.children[j].y = pMjOrginPosY+moveHeight;\r\n                        break;\r\n                    }\r\n                    \r\n                }\r\n            }\r\n        }\r\n        var self = this;\r\n        var action =cc.delayTime(1);\r\n        var action2 = cc.callFunc(function(){\r\n            for (var i=0;i < holdCardsNode.childrenCount;i++){\r\n                var sp = holdCardsNode.children[i];\r\n                if (nPos!= 1)\r\n                {\r\n                    if (holdCardsNode.children[i].bolMove){\r\n                        sp.runAction(cc.moveTo(0.3,cc.p(sp.x,sp.y - moveHeight)));\r\n                    }\r\n                }\r\n                else{\r\n                    if (sp.y> self.m_selfOriginalPosY) {\r\n                        sp.runAction(cc.moveTo(0.3,cc.p(sp.x,self.m_selfOriginalPosY)));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        \r\n        var sequence = cc.sequence(action, action2);\r\n        holdCardsNode.runAction(sequence);\r\n  \r\n    },\r\n\r\n    //删除三张手牌然后刷新\r\n    deleteThreeMjRefresh:function()\r\n    {\r\n        var leg =  this.m_playerMjs.cbHoldCardCount;\r\n        var targetKeys = this.getThreeUpCradList();\r\n        for (let i = leg - 1; i >= 0; i--) {\r\n            for (let j = 0; j < targetKeys.length; j++) {\r\n                if ( this.m_playerMjs.cbHoldCards[i]) {\r\n                    if ( this.m_playerMjs.cbHoldCards[i] == targetKeys[j]) {\r\n                         this.m_playerMjs.cbHoldCards.splice(i, 1)\r\n                        continue; //结束当前本轮循环，开始新的一轮循环\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.m_playerMjs.cbHoldCardCount = this.m_playerMjs.cbHoldCardCount - 3;\r\n        this.putSelfHandCards();\r\n    },\r\n\r\n    //获得当前被提起的三张牌分别是什么\r\n    getThreeUpCradList:function()\r\n    {\r\n        return this.threeMjValueList;\r\n    },\r\n\r\n    //获得当前被提起的牌数目来控制现在能否提起牌\r\n    getCanUpCardBySelectCount:function(){\r\n        var count = 0;\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < holdCardsNode.childrenCount; i++) {\r\n            if (holdCardsNode.children[i].y > this.m_selfOriginalPosY)\r\n            {\r\n                count = count + 1;\r\n            }\r\n        }\r\n        return count < 3;\r\n    },\r\n\r\n    setQueYiMenStyleType:function(nStyleType){\r\n        this.m_nQueYiMenStyleType = nStyleType\r\n    },\r\n\r\n    //设置缺一门的为灰色\r\n    setQueYiMenMjGray:function(){\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < holdCardsNode.childrenCount; i++) {\r\n            var nType = GameCfg.getMjColor(holdCardsNode.children[i].cardValue);\r\n            if (nType == this.m_nQueYiMenStyleType){\r\n                holdCardsNode.children[i].color = new cc.Color(137, 137, 137);\r\n            }\r\n            else{\r\n                holdCardsNode.children[i].color = new cc.Color(255, 255, 255);\r\n            }\r\n        }\r\n    },\r\n\r\n    //设置没被抬起来的麻将变灰，并且控制当前是否还能继续点击\r\n    setGrayForCannotUpCard:function(bol){\r\n        var holdCardsNode = this.node.getChildByName(\"holds\");\r\n        for (var i = 0; i < holdCardsNode.childrenCount; i++) {\r\n            if (holdCardsNode.children[i].y == this.m_selfOriginalPosY)\r\n            {\r\n                if (bol){\r\n                    holdCardsNode.children[i].color = new cc.Color(255, 255, 255);\r\n                }else{\r\n                    holdCardsNode.children[i].color = new cc.Color(137, 137, 137);\r\n                }\r\n            }\r\n        }\r\n        this.setTouchMjEnable = bol;\r\n    },\r\n\r\n    //为了在换牌的时候提起三张牌，这里重构了点击牌的方法，和原来正常点击牌作了区分\r\n    onChooseMjClicked: function (clickIndex) {\r\n\r\n        // if (!this.getCanUpCardBySelectCount())\r\n        //     return;\r\n        var holds = this.node.getChildByName(\"holds\");\r\n        var node = holds.children[clickIndex];\r\n\r\n        var cardValue = node.cardValue;\r\n\r\n        var index = clickIndex;\r\n\r\n        if (node.y == this.m_selfOriginalPosY) {\r\n            if (!this.setTouchMjEnable)\r\n            {\r\n                return;\r\n            }\r\n\r\n            //存储到列表供给外部调用\r\n            this.threeMjValueList[this.threeMjValueList.length] = cardValue;\r\n\r\n            node.y = node.y + 30;\r\n            node.setScale(1.2);\r\n\r\n            Resources.playCommonEffect(\"selectmahjong.mp3\");\r\n\r\n            //然后将之后牌往后移\r\n            for (var i = 0; i < holds.childrenCount; i++) {\r\n                if (node == holds.children[i]) {\r\n                    index = i;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (index != -1) {\r\n                for (var i = index + 1; i < holds.childrenCount; i++) {\r\n                    holds.children[i].x += 15;\r\n                }\r\n            }\r\n            if(!this.getCanUpCardBySelectCount()){\r\n                this.setGrayForCannotUpCard(false);\r\n            }\r\n        }\r\n        else{\r\n\r\n            //到列表删除指定数据\r\n            var index = this.threeMjValueList.indexOf(cardValue);\r\n            if (index > -1) {\r\n                this.threeMjValueList.splice(index, 1);\r\n            }\r\n\r\n            node.y = node.y - 30;\r\n            node.setScale(1);\r\n            //将之后牌往前移\r\n            for (var i = 0; i < holds.childrenCount; i++) {\r\n                if (node == holds.children[i]) {\r\n                    index = i;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (index != -1) {\r\n                for (var i = index + 1; i < holds.childrenCount; i++) {\r\n                    holds.children[i].x -= 15;\r\n                }\r\n            }\r\n            if(this.getCanUpCardBySelectCount()){\r\n                this.setGrayForCannotUpCard(true);\r\n            }\r\n        }\r\n    },\r\n});\r\n"]}