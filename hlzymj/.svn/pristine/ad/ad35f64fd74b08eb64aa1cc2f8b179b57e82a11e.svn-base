{"version":3,"sources":["GameDefs.js"],"names":["GameDefs","PLAYER_COUNT","MAX_MJ_INDEX","MAX_HOLD_CARD","MAX_WEAVE","MAX_OUT_CARDS","MAJIANG_COUNT","HONG_ZHONG","MAX_SCORE_TIMES","INVALID_CARD","INVALID_CHAIR","INDEX_REPLACE_CARD","MAX_LEFT_WALL","MJ_CMD_OUT","MJ_CMD_GET","MJ_CMD_PASS","MJ_CMD_EATLEFT","MJ_CMD_EATMID","MJ_CMD_EATRIGHT","MJ_CMD_PENG","MJ_CMD_GANG","MJ_CMD_HU","MJ_CMD_ROOMINFO","MJ_DISSOLVE_ROOM","MJ_DISSOLVE_RESULT","MJ_CMD_SETINFO","MJ_CMD_DissINFO","MJ_CMD_NOTICE_DISS","MJ_CMD_Cancel_AutoOut","MJ_CMD_AutoOut","MJ_CMD_PoChan","MJ_CMD_ERROR","CMD_Notify_Diss","MJ_CMD_Exchange","MJ_CMD_DingQue","CardType","wan","tiao","tong","InvalidCardType","GetCardType","nCard","nCardType","WeaveType","InvalidType","Peng","MingGang","XuGang","AnGang","xueliuGang","LaiziGang","ShunLeft","ShunMid","ShunRight","FangGang","EndStatus","InvalidHuType","PiHu","TianHu","DiHu","With19","QingYiSe","JiangDui","PengPengHu","QiDui","HaoHuaQiDui","QingQiDui","QingLongQiDui","QingDui","HaiDiLao","HideMingGang","HideAnGang","QiangGangHu","GangShangKaiHua","GangShangPao","MenQing","ZhongZhang","ShouZhuaYi","ZimoJiaDi","ZimoJiaFan","HUTYPE_STRING","SCORE_TYPE_STRING","scoreType","scoreFangPao","scoreZimo","scoreAnGang","scoreMingGang","scoreXuGang","scoreChaDaJiao","ScoreChaHuaZhu","InvalidScoreType","EndType","Fangpao","Zimo","Liuju","RenShu","Jiesan","GamePhase","PhaseFree","PhaseStart","PhaseExchange","PhasePlayExchange","PhaseDingque","PhasePlayDingque","PhaseOutCard","PhaseWaitChoice","PhaseEnd","PhasePlayHu","PlayerAction","paNothing","paOutCard","paGet1CardFromHeader","paGet1CardFromTail","paPatchFlower","paPeng","paGang","paHu","paEat","PaExt","tagWeaveItem","ba","tag","cbWeaveKind","readUnsignedByte","cbChair","cbCardData","PlayerInfo","player","cbLastCard","cbLastOutCard","cbHoldCardCount","cbHoldCards","i","showCardSuits","nWeaveCount","cbOutCards","cbDingque","cbAutoOutCard","cbExchange","cbBeExchange","cbIsHu","cbHuCount","cbHuCards","nCount","nMj","PLAYER_ACTION","pAction","nAction","readShort","nChair","readByte","nParam","readInt","IsLaiZi","cbCard","cbLaizi","newTing","st_tingInfo","cbOutCard","cbTingCount","cbTingCard","newTing_EX","cbFan","cbLeftCount","ST_Single_Score","single_Score","cbScoreType","cbWinChair","cbFangpaoChair","cbHuTypeCount","cbHuType","cbGen","nScore","bytesAvailable","GameEnd","stWinStruct","cbWriteScoreTimes","stSingleScore","j","nFinalScore","cbWall","GameScene","gs","cbPhase","cbBanker","cbBankerCount","cbWhosTurn","cbFirstDice","cbSecondDice","cbGetCard","cbCurrentIndex","cbLastIndex","cbCurrentCard","players","LastAction","CurrentPlayerAction","ChoiceAction","cbTingCardCount","vTingList","stTing","length","ST_RoomInfo","roomInfo","nTurnBasicGold","nCost","nMinRoomGold","nMaxRoomGold","nRuleID","cbLaiType","nPlayerCount","ST_SetInfo","setInfo","nRoomID","nCurSet","nTotalSet","cbBaseScore","nRoomOwner","nExt","cbGradeIndex","Array","szBatchID","String","push","readUTFBytes","ST_Property","new","property","nPropertyID","nPayMoney","nChairNum","cbSendChair","cbToChair","bSuccess","readBoolean","module","exports"],"mappings":"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","file":"GameDefs.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game","sourcesContent":["import { ByteArray } from \"../common/ByteArray\";\r\n\r\nvar GameDefs = {\r\n\r\n};\r\n\r\nGameDefs.PLAYER_COUNT\t=\t4;\t\t\r\nGameDefs.MAX_MJ_INDEX\t=\t27;\t\t//27即红中 ，鄂州晃晃\r\nGameDefs.MAX_HOLD_CARD\t=\t14;\t\t//手上牌数量\r\nGameDefs.MAX_WEAVE\t\t=\t4;\r\nGameDefs.MAX_OUT_CARDS\t=\t28;\r\nGameDefs.MAJIANG_COUNT\t=\t108;\t\t//麻将总数量 中,发，白\r\nGameDefs.HONG_ZHONG\t\t=\t27;\t\t//红中牌值\r\nGameDefs.MAX_SCORE_TIMES\t\t=\t30;\t\r\n\r\nGameDefs.INVALID_CARD\t=\tGameDefs.MAX_MJ_INDEX;\r\nGameDefs.INVALID_CHAIR\t=\t5;\r\nGameDefs.INDEX_REPLACE_CARD\t = GameDefs.MAX_MJ_INDEX - 1;\r\nGameDefs.MAX_LEFT_WALL =  GameDefs.MAJIANG_COUNT-13*4-1; //胡牌剩余牌数\r\n\r\n//命令码定义\r\nGameDefs.MJ_CMD_OUT\t\t= 1;\t// 出牌 BYTE cbCard;\r\nGameDefs.MJ_CMD_GET\t\t= 2; // 摸牌\r\nGameDefs.MJ_CMD_PASS\t= 3; // 过\r\nGameDefs.MJ_CMD_EATLEFT\t= 4; // 吃左\r\nGameDefs.MJ_CMD_EATMID\t= 5; // 吃中\r\nGameDefs.MJ_CMD_EATRIGHT = 6; // 吃右\r\nGameDefs.MJ_CMD_PENG\t= 7; // 碰\r\nGameDefs.MJ_CMD_GANG\t= 8; // 杠,杠需要从后面拿牌,tagWeaveItem\r\nGameDefs.MJ_CMD_HU\t\t= 9; // 胡\r\nGameDefs.MJ_CMD_ROOMINFO  = 10   //房间配置\r\nGameDefs.MJ_DISSOLVE_ROOM  = 11  //发起解散房间命令  BYTE 发起玩家椅子号\r\nGameDefs.MJ_DISSOLVE_RESULT = 12  //发送解散房间命令结果， BYTE[4] 各玩家选择结果 0是同意解散 1是不同意\r\nGameDefs.MJ_CMD_SETINFO = 13  //局数信息命令\r\nGameDefs.MJ_CMD_DissINFO = 14  //私人场牌局解散时下发\r\n// GameDefs.MJ_CMD_Cancel_AutoOut = 15 //取消托管\r\n\r\nGameDefs.MJ_CMD_NOTICE_DISS\t\t = 18 //通知客户端牌桌解散\r\nGameDefs.MJ_CMD_Cancel_AutoOut\t = 19\r\nGameDefs.MJ_CMD_AutoOut\t\t\t = 20\r\nGameDefs.MJ_CMD_PoChan\t\t\t = 21\r\nGameDefs.MJ_CMD_ERROR\t\t\t = 22\t//客户端发送了错误命令\r\nGameDefs.CMD_Notify_Diss\t     = 23\t//后台强制解散通知命令\r\n\r\n\r\n//找娟姐确认\r\nGameDefs.MJ_CMD_Exchange = 15  //换牌 BYTE[3]  \r\nGameDefs.MJ_CMD_DingQue =  16  //定缺 BYTE\r\n\r\n// GameDefs.MJ_CMD_AUTOOUT = 17 //托管\r\n// GameDefs.CMD_PROPERTY = 18\t//发送道具\r\n// GameDefs.CMD_MJ_DISSOLVE = 19 //返回玩家的解散选择\r\n// GameDefs.CMD_Notify_UpGrade = 21;       //升段通知\r\n// GameDefs.MJ_CMD_Set_XueFei = 19\t\t//设置学费\r\n// GameDefs.MJ_CMD_RenShu = 20\t\t//认输\r\n// GameDefs.MJ_CMD_LiKai = 21          //离开\r\n// GameDefs.MJ_CMD_WaitCheat = 22 // 等待检查作弊\r\n// GameDefs.MJ_CMD_Show_Cheat = 23 // 显示检查结果\r\n// GameDefs.MJ_CMD_Client_Cheat = 24 // 客户端上报作弊检测\r\n// GameDefs.MJ_CMD_SHOW_GET_LAIZI = 30  // 起牌时有一个赖子，又自摸一个赖子，必须亮此牌\r\n\r\n\r\nGameDefs.CardType = {\r\n\twan\t\t: 0,\r\n\ttiao\t: 1,\r\n\ttong\t: 2,\r\n\tInvalidCardType : 3,\r\n};\r\n\r\n//返回牌值\r\nGameDefs.GetCardType = function(nCard){\r\n\tvar nCardType = GameDefs.CardType.InvalidCardType\r\n\tnCardType = nCard/9;\r\n\treturn nCardType\r\n}\r\n\r\nGameDefs.WeaveType = {\r\n\t// InvalidType \t: 0,\r\n\t// Peng \t\t\t: 1,\r\n\t// MingGang \t\t: 2,\t//明杠 \r\n\t// XuGang\t\t\t: 3,\t//续杠\r\n\t// AnGang\t\t\t: 4,\t//暗杠\r\n\t// HongzhongGang \t: 5,  \t//红中杠  不放入WeaveItem 组合\r\n    // LaiziGang\t\t: 6,\t//赖子杠  不放入WeaveItem 组合\r\n    // ChaoTianMingGang: 7,    //朝天明杠 只需要3张赖子皮就可以杠\r\n    // ChaoTianAnGang  : 8,\t\t//朝天暗杠  只需要3张赖子皮就可以杠\r\n\t// ShunLeft\t\t: 9,\r\n\t// ShunMid\t\t\t: 10,\r\n\t// ShunRight\t\t: 11,\r\n\t// Yan \t\t\t: 12,\r\n    // FangGang \t\t: 13,\r\n    InvalidType \t: 0,\r\n\tPeng \t\t\t: 1,\r\n\tMingGang \t\t: 2,\t//明杠 \r\n\tXuGang\t\t\t: 3,\t//续杠\r\n\tAnGang\t\t\t: 4,\t//暗杠\r\n\txueliuGang \t    : 5,  \t//  不放入WeaveItem 组合\r\n\tLaiziGang\t\t: 6,\t//赖子杠  不放入WeaveItem 组合\r\n\tShunLeft\t\t: 7,\r\n\tShunMid\t\t\t: 8,\r\n\tShunRight\t\t: 9,\r\n\tFangGang \t\t:10\r\n};\r\n\r\nGameDefs.EndStatus = {\r\n\t// InvalidHuType : 0,\r\n\t// RuanPai : 1,\t// 软牌\r\n    // YingPai : 2,\t// 硬牌\r\n    // RuanLaiyou : 3, // 软赖油\r\n    // YingLaiyou : 4,\t// 硬赖油\r\n    // YouZhongyou: 5, // 油中油\r\n    InvalidHuType :     0,\r\n\tPiHu :              1,\r\n\tTianHu :            2,\r\n\tDiHu :              3,\r\n\tWith19 :            4,\r\n\tQingYiSe :          5,\r\n\tJiangDui :          6,\t\t\t//将对\r\n\tPengPengHu :        7,\t\r\n\tQiDui :             8,\r\n\tHaoHuaQiDui :       9,\t\t//龙七对\r\n\tQingQiDui :         10,\r\n\tQingLongQiDui :     11,\r\n\tQingDui :           12,\r\n\r\n\t////////加番///////\r\n\tHaiDiLao :          13,\r\n\tHideMingGang :      14,\t\t//隐藏明杠\r\n\tHideAnGang :        15,\t\t\t//隐藏暗杠\r\n\tQiangGangHu :       16,\t\t//抢杠胡\r\n\tGangShangKaiHua :   17,\t//杠上花\r\n\tGangShangPao :      18,\t\t//点杠炮\r\n\tMenQing :           19,\t\t\t//门清\r\n\tZhongZhang :        20,\t//中张\r\n\tShouZhuaYi :        21,\t//金钩胡\r\n\tZimoJiaDi :         22,\t\t//自摸加底\r\n\tZimoJiaFan :        23\t\t//自摸加番\r\n};\r\n\r\nGameDefs.HUTYPE_STRING =\r\n[\r\n\t// \"软胡\",\r\n    // \"硬胡\",\r\n    // \"软癞油\",\r\n    // \"硬癞油\",\r\n    \"平胡\",\r\n\t\"天胡\",\r\n\t\"地胡\",\r\n\t\"带幺九\",\r\n\t\"清一色\",\r\n\t\"将对\",\r\n\t\"碰碰胡\",\r\n\t\"七对\",\r\n\t\"龙七对\",\r\n\t\"清七对\",\r\n\t\"清龙七对\",\r\n\t\"清对\",\r\n\t\"海底捞\",\r\n\t\"隐藏明杠\",\r\n\t\"隐藏暗杠\",\r\n\t\"抢杠胡\",\r\n\t\"杠上花\",\r\n\t\"杠上炮\",\r\n\t\"门清\",\r\n\t\"中张\",\r\n\t\"金钩胡\",\r\n\t\"自摸加底\",\r\n\t\"自摸加番\"\r\n];\r\n\r\nGameDefs.SCORE_TYPE_STRING =\r\n[\r\n\t\"放炮\",\r\n\t\"自摸\",\r\n\t\"暗杠\",\r\n\t\"明杠\",\r\n\t\"续杠\",\r\n\t\"查大叫\",\r\n\t\"查花猪\",\r\n\t\"空\"\r\n];\r\n\r\nGameDefs.scoreType = {\r\n\tscoreFangPao : 0,\r\n\tscoreZimo : 1,\r\n\tscoreAnGang : 2,\r\n\tscoreMingGang : 3,\r\n\tscoreXuGang : 4,\r\n\tscoreChaDaJiao : 5,\r\n\tScoreChaHuaZhu : 6,\r\n\tInvalidScoreType : 7\r\n}\r\n\r\nGameDefs.EndType = {\r\n\tFangpao : 0,\r\n\tZimo\t: 1,\r\n\tLiuju\t: 2,\r\n    RenShu \t: 3,\r\n    Jiesan  : 4,\r\n};\r\n\r\nGameDefs.GamePhase = {\r\n\t// PhaseFree \t: 0,\t\r\n\t// PhaseStart\t: 1,\t\t//游戏开始，选庄家， 洗牌，翻赖子\r\n\t// PhaseOutCard\t: 2,\t//摸牌或吃杠碰后玩家操作阶段\r\n\t// PhaseWaitChoice : 3,\t//玩家出牌后， 等待其他玩家的吃碰杠操作\r\n    // PhaseEnd\t: 4,\r\n    PhaseFree \t:        0,\t\r\n\tPhaseStart\t:        1,\t\t//游戏开始，选庄家， 洗牌，翻赖子\r\n\tPhaseExchange :      2,\t\t////等待换牌\r\n\tPhasePlayExchange :  3,\t\t////播放换牌动画\r\n\tPhaseDingque :       4,\t\t\t////定缺阶段\r\n\tPhasePlayDingque :   5,\t\t////播放定缺动画\r\n\tPhaseOutCard\t:    6,\t//摸牌或吃杠碰后玩家操作阶段\r\n\tPhaseWaitChoice :    7,\t//玩家出牌后， 等待其他玩家的吃碰杠操作\r\n\tPhaseEnd\t:        8, //游戏结束\r\n\tPhasePlayHu :        9  //播放胡特效\r\n};\r\n\r\nGameDefs.PlayerAction = {\r\n\tpaNothing            :  0,     //什么都不可以做\r\n\tpaOutCard            :  1,     //出牌\r\n\tpaGet1CardFromHeader :  2,     //从长城头部抓取一张牌\r\n\tpaGet1CardFromTail   :  4,     //从长城尾部抓取一张牌\r\n\tpaPatchFlower        :  8,     //补花\r\n\tpaPeng               :  16,    //碰牌\r\n\tpaGang               :  32,    //杠牌\r\n\tpaHu                 :  64,    //胡牌\r\n    paEat                :  128,   //吃牌\r\n    PaExt\t\t\t\t : \t256,   //換牌顔色\r\n};\r\n\r\nGameDefs.tagWeaveItem = function(ba){\r\n    var tag = {};\r\n\ttag.cbWeaveKind = ba.readUnsignedByte()\r\n\ttag.cbChair = ba.readUnsignedByte()\r\n\ttag.cbCardData = []\r\n\ttag.cbCardData[0] = ba.readUnsignedByte()\r\n\ttag.cbCardData[1] = ba.readUnsignedByte()\r\n\ttag.cbCardData[2] = ba.readUnsignedByte()\r\n\ttag.cbCardData[3] = ba.readUnsignedByte()\r\n\treturn tag\r\n};\r\n\r\nGameDefs.PlayerInfo = function(ba){\r\n    var player = {}\r\n\tplayer.cbLastCard \t\t= ba.readUnsignedByte()\r\n\tplayer.cbLastOutCard \t= ba.readUnsignedByte()\r\n\tplayer.cbHoldCardCount \t= ba.readUnsignedByte()\r\n\t// player.cbCountLaiziGang = ba.readUnsignedByte()\r\n\t// player.cbCountHZGang \t= ba.readUnsignedByte()\r\n\r\n\tplayer.cbHoldCards = []\r\n\tfor (var i=0;i < GameDefs.MAX_HOLD_CARD; i++) {\r\n        player.cbHoldCards[i] = ba.readUnsignedByte()\r\n    }\r\n\r\n\tplayer.showCardSuits = []\r\n\tplayer.nWeaveCount = 0;\r\n\tfor(var i = 0; i < GameDefs.MAX_WEAVE; i++){\r\n        player.showCardSuits[i] = GameDefs.tagWeaveItem(ba)\r\n        if(player.showCardSuits[i].cbWeaveKind != GameDefs.WeaveType.InvalidType){\r\n            player.nWeaveCount = player.nWeaveCount + 1\r\n        }\r\n    }\r\n\t\r\n\tplayer.cbOutCards = []\r\n    for(var i = 0; i < GameDefs.MAX_OUT_CARDS; i++){\r\n        player.cbOutCards[i] =ba.readUnsignedByte();\r\n    }\r\n    \r\n    player.cbDingque = ba.readUnsignedByte()  ////定缺哪一门\r\n\tplayer.cbAutoOutCard = ba.readUnsignedByte() //1是托管,0是不托管\r\n \r\n\tplayer.cbExchange={} ////换出去的牌\r\n\tfor (var i = 0; i < 3; i++){\r\n\t\tplayer.cbExchange[i] = ba.readUnsignedByte()\r\n    }\r\n\r\n\tplayer.cbBeExchange={} ////换过来的牌\r\n\tfor (var i = 0; i < 3; i++){\r\n\t\tplayer.cbBeExchange[i] = ba.readUnsignedByte()\r\n    }\r\n\r\n\tplayer.cbIsHu = ba.readUnsignedByte()\t////是否已经胡牌\r\n\tplayer.cbHuCount = ba.readUnsignedByte()    ////胡了多少张牌\r\n\tplayer.cbHuCards ={} ////已经胡的牌\r\n\tvar nCount = 0;\r\n\tfor (var i = 0; i < 27; i++){\r\n\t\tvar nMj =  ba.readUnsignedByte()\r\n\t\tif (nMj < 27) {\r\n\t\t\tplayer.cbHuCards[nCount] = nMj;\r\n\t\t\tnCount = nCount + 1;\r\n        }\r\n    }\r\n    \r\n\treturn player\r\n};\r\n\r\nGameDefs.PLAYER_ACTION = function (ba){\r\n    var pAction = {};\r\n\tpAction.nAction = ba.readShort();\r\n\tpAction.nChair = ba.readByte();\r\n\tpAction.nParam = ba.readInt(); //放杠类型，吃就是放吃的牌\r\n\treturn pAction\r\n}\r\n\r\n//是否是癞子\r\nGameDefs.IsLaiZi = function(cbCard,cbLaizi){\r\n\tif(cbCard == GameDefs.HONG_ZHONG)\r\n        return true;\r\n        \r\n\tif (cbCard == cbLaizi) \r\n\t\treturn true;\r\n\t\r\n\treturn false\r\n}\r\n\r\n//听牌协议\r\nGameDefs.newTing = function(ba){\r\n    var st_tingInfo = {}\r\n    st_tingInfo.cbOutCard =ba.readByte()\r\n    st_tingInfo.cbTingCount = ba.readByte()\r\n    st_tingInfo.cbTingCard = []\r\n    for(var i = 0; i < st_tingInfo.cbTingCount; i++){\r\n        st_tingInfo.cbTingCard[i] = ba.readByte();\r\n    }\r\n    return st_tingInfo\r\n}\r\n\r\n//\r\nGameDefs.newTing_EX = function(ba)\r\n{\r\n    var st_tingInfo= {}\r\n    st_tingInfo.cbOutCard =ba.readByte()\r\n    st_tingInfo.cbTingCount = ba.readByte()\r\n    st_tingInfo.cbTingCard = []\r\n    for(var i = 0; i < st_tingInfo.cbTingCount; i++){\r\n        st_tingInfo.cbTingCard[i] = ba.readByte();\r\n    }\r\n\r\n    st_tingInfo.cbFan = []\r\n    for(var i = 0; i < st_tingInfo.cbTingCount; i++){\r\n        st_tingInfo.cbFan[i] = ba.readByte()\r\n    }\r\n\r\n    st_tingInfo.cbLeftCount = []\r\n    for(var i = 0; i < st_tingInfo.cbTingCount; i++){\r\n        st_tingInfo.cbLeftCount[i] = ba.readByte();\r\n    }\r\n    return st_tingInfo;\r\n}\r\n\r\n////每次分数变化结构\r\nGameDefs.ST_Single_Score = function(ba){\r\n\tvar single_Score ={}\r\n\tsingle_Score.cbScoreType =0\t\t////此次分数变化类型， 放炮， 自摸， 明杠，暗杠， 续杠,查大叫 GameDefs.scoreType\r\n\tsingle_Score.cbFan = 0\t\t\t//// 番数\r\n\tsingle_Score.cbWinChair = 0\r\n\tsingle_Score.cbFangpaoChair = 0\r\n\tsingle_Score.cbHuTypeCount = 0\r\n\tsingle_Score.cbHuType ={} \r\n\tsingle_Score.cbGen = 0\r\n\tsingle_Score.nScore = 0\r\n\tif (ba.bytesAvailable > 0) {\r\n\t\tsingle_Score.cbScoreType = ba.readByte()\r\n\t\tsingle_Score.cbFan = ba.readByte()\r\n\t\tsingle_Score.cbWinChair = ba.readByte()\r\n\t\tsingle_Score.cbFangpaoChair = ba.readByte()\r\n\t\tsingle_Score.cbHuTypeCount = ba.readByte()\r\n\t\tfor (var i=0;i<single_Score.cbHuTypeCount;i++) {\r\n\t\t\tsingle_Score.cbHuType[i] = ba.readByte()\r\n        }\r\n\t\tsingle_Score.cbGen = ba.readByte()\r\n\t\tsingle_Score.nScore = ba.readInt()\r\n    }\r\n\treturn single_Score\r\n}\r\n\r\nGameDefs.GameEnd = function(ba){\r\n\tvar stWinStruct = {};\r\n\t// stWinStruct.cbWinChair = ba.readByte();\r\n\t// stWinStruct.cbFangpaoChair = ba.readByte();\r\n\t// stWinStruct.cbEndType = ba.readByte(); //流局，放炮2，自摸\r\n\t// stWinStruct.cbHuType = ba.readByte();\r\n\r\n\t// stWinStruct.nScore = [];\r\n    // for(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n    //     stWinStruct.nScore[i] = ba.readInt() //总的分数\r\n    // }\r\n\r\n\t// stWinStruct.cbFan = [];\r\n    // for(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n    //     stWinStruct.cbFan[i] = ba.readByte() //总的翻数\r\n    // }\r\n\r\n\tstWinStruct.cbWriteScoreTimes ={}  //各个玩家分数变化次数\r\n\r\n\tfor(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n\t\tstWinStruct.cbWriteScoreTimes[i] = ba.readByte()\r\n    }\r\n\r\n\t//ST_Single_Score stSingleScore[GameDefs.PLAYER_COUNT][MAX_SCORE_TIMES]\r\n\tstWinStruct.stSingleScore={}\r\n\tfor(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n\t\tstWinStruct.stSingleScore[i] ={}\r\n\t\tfor (var j=0;j<stWinStruct.cbWriteScoreTimes[i];j++) {\r\n\t\t\tstWinStruct.stSingleScore[i][j]= GameDefs.ST_Single_Score(ba)\r\n        }\r\n    }\r\n\r\n\tstWinStruct.nFinalScore={}\r\n\tfor(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n\t\tstWinStruct.nFinalScore[i] = ba.readInt() //总分数\r\n    }\r\n\r\n    stWinStruct.cbWall={}\r\n    \r\n\treturn stWinStruct\r\n}\r\n\r\nGameDefs.GameScene = function(ba){\r\n\tvar gs = {}\r\n\tgs.cbPhase = ba.readByte()\t\t\t//游戏状态\r\n\tgs.cbBanker = ba.readByte()\t\t\t//庄家\r\n\tgs.cbBankerCount = ba.readByte()\t//连庄次数\r\n\tgs.cbWhosTurn = ba.readByte()\t\t//到谁操作\r\n\t// gs.cbLaizipi = ba.readByte()\t\t//赖子皮\r\n\t// gs.cbLaizi = ba.readByte()\t\t\t//赖子\r\n\tgs.cbFirstDice = ba.readByte()\t\t//骰子数1\r\n\tgs.cbSecondDice = ba.readByte()\t\t//骰子数2\r\n\tgs.cbGetCard = ba.readByte()\t\t//是否已经摸牌\r\n\tgs.cbCurrentIndex = ba.readByte()\t//画客户端长城用，头\r\n\tgs.cbLastIndex = ba.readByte()\t\t//画客户端长城用，尾\r\n\t// gs.cbWaitTime = ba.readByte()\t\t//等待计时\r\n\tgs.cbCurrentCard = ba.readByte()\t//当前打出的牌\r\n\tgs.players = [] \r\n    for(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n        gs.players[i] = GameDefs.PlayerInfo(ba)\r\n    }\r\n\r\n\tgs.LastAction = GameDefs.PLAYER_ACTION(ba)\r\n\tgs.CurrentPlayerAction = GameDefs.PLAYER_ACTION(ba)\r\n\r\n\tgs.ChoiceAction = []\r\n    for(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n        gs.ChoiceAction[i] = ba.readShort()\r\n    }\r\n\r\n\tgs.stWinStruct={}\r\n\tif (gs.cbPhase == GameDefs.GamePhase.PhaseEnd){\r\n\t\tgs.stWinStruct = GameDefs.GameEnd(ba)\r\n    }\r\n\r\n\t// if (ba.bytesAvailable > 0){      \r\n\t// \tcc.log(\"获取玩家托管状态\")  \r\n    //     for(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n    //         gs.players[i].cbAutoOutCard = ba.readByte()  //玩家托管状态\r\n    //     }\r\n    // }   \r\n\r\n\tgs.cbTingCardCount = 0;\r\n\tgs.vTingList = [];\r\n\tif (ba.bytesAvailable > 0){\r\n\t\tgs.cbTingCardCount = ba.readByte()\r\n\t\tif (gs.cbTingCardCount > 0){\r\n            for(var i = 0; i < gs.cbTingCardCount; i++){\r\n                var stTing = GameDefs.newTing(ba);\r\n                gs.vTingList[gs.vTingList.length] =  stTing\r\n            }\r\n        }\r\n    }\r\n\r\n\tif (ba.bytesAvailable > 0){\r\n\t\tgs.cbTingCardCount = ba.readByte()\r\n\t\tif (gs.cbTingCardCount > 0){\r\n            for(var i = 0; i < gs.cbTingCardCount; i++){\r\n                var stTing = GameDefs.newTing_EX(ba);\r\n                gs.vTingList[gs.vTingList.length] =  stTing\r\n            }   \r\n        }\r\n    }\r\n\r\n\t// gs.stWinStruct.cbWallCount = 0\r\n    // gs.stWinStruct.cbWall = []\r\n    // gs.stWinStruct.nGangScore = [];\r\n    // if (gs.cbPhase == GameDefs.GamePhase.PhaseEnd){\r\n\t// \tcc.log(\"获取牌墙数据\")\r\n    //     if (ba.bytesAvailable > 0){\r\n    //         gs.stWinStruct.cbWallCount = ba.readByte()\r\n    //         for(var i = 0; i < gs.stWinStruct.cbWallCount; i++){\r\n    //             gs.stWinStruct.cbWall[i] = ba.readByte();\r\n    //         }\r\n    //     }\r\n    // }\r\n    \r\n    // if(ba.bytesAvailable > 0){\r\n    //     for(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n    //         gs.stWinStruct.nGangScore[i] = ba.readInt();\r\n    //     }\r\n    // }\r\n\t\t\r\n\treturn gs\r\n}\r\n\r\nGameDefs.ST_RoomInfo = function(ba){\r\n\tvar roomInfo = {\r\n\t\tnTurnBasicGold : 0,      //基本底注\r\n        nCost : 0,               //台费\r\n        nMinRoomGold : 0,        //房间下限\r\n        nMaxRoomGold : 0,        //房间上限\r\n        nRuleID : 0,             //规则号\r\n        cbLaiType : 0,           //1半赖，2无赖，0两个都不选\r\n\t};\r\n\r\n\tif(ba != null){\r\n\t\troomInfo.nTurnBasicGold  = ba.readInt();\r\n        roomInfo.nCost  = ba.readInt();\r\n        roomInfo.nMinRoomGold  = ba.readInt();\r\n        roomInfo.nMaxRoomGold  = ba.readInt();\r\n        roomInfo.nRuleID  = ba.readInt();\r\n        roomInfo.cbLaiType = ba.readUnsignedByte();\r\n        if(ba.bytesAvailable > 0){\r\n            roomInfo.nPlayerCount  = ba.readInt();\r\n\t\t}       \r\n\t}\r\n\r\n\treturn roomInfo;\r\n}\r\n\r\n\r\nGameDefs.ST_SetInfo = function (ba ){\r\n\tvar setInfo =\r\n    {\r\n        nRoomID : 0,\t\t//房号\r\n        nCurSet : 0,\t\t//当前局数\r\n        nTotalSet : 0,\t\t//总局数\r\n        cbBaseScore : 0,\t//底分\r\n        nRoomOwner : 0,\t\t//房号\r\n        nExt       : 0,     //额外的参数\r\n        cbGradeIndex :  Array(),   //段位\r\n        szBatchID   :   String,    //流水号\r\n    }\r\n\r\n    if (ba != null){\r\n\t\tsetInfo.nRoomID = ba.readInt();\r\n        setInfo.nCurSet = ba.readInt();\r\n        setInfo.nTotalSet = ba.readInt();\r\n        setInfo.cbBaseScore = ba.readInt();\r\n        setInfo.nRoomOwner = ba.readInt();\r\n        setInfo.nExt        = ba.readInt();\r\n        for(var i = 0; i < GameDefs.PLAYER_COUNT; i++){\r\n\r\n            setInfo.cbGradeIndex.push(ba.readUnsignedByte());\r\n        }\r\n        \r\n        setInfo.szBatchID = ba.readUTFBytes(32);\r\n\t}       \r\n    return setInfo\r\n}\r\nGameDefs.ST_Property = {}\r\nGameDefs.ST_Property.new = function(ba){\r\n\tvar property =\r\n    {\r\n        nPropertyID : 0,  //道具ID\r\n        nPayMoney : 0,    //道具费用\r\n        nChairNum : 0,    //道具魅力值\r\n        cbSendChair : 0,  //发送道具的椅子\r\n        cbToChair : 0,    //道具作用椅子\r\n        bSuccess : false, //是否扣费成功\r\n\t}\r\n\t\r\n\tif(ba){\r\n\t\tproperty.nPropertyID = ba.readInt();\r\n        property.nPayMoney = ba.readInt();\r\n        property.nChairNum = ba.readInt();\r\n        property.cbSendChair= ba.readUnsignedByte();\r\n        property.cbToChair= ba.readUnsignedByte();\r\n        property.bSuccess = ba.readBoolean();\r\n\t}\r\n\r\n\treturn property;\r\n}\r\n\r\nmodule.exports = GameDefs\r\n"]}