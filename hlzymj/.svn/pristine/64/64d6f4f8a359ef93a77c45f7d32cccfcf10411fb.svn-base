{"version":3,"sources":["GamePlace.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\gamelib\\place","sourcesContent":["﻿import { CMD_GP_LogonSuccess_Ex2 } from \"./CMD_GP_LogonSuccess_Ex2\"\r\nimport { PlazaCmds } from \"./PlazaCmds\"\r\nimport { ByteArray } from \"../../common/ByteArray\";\r\nimport { TSCommon } from \"../../TSCommon\";\r\nimport { CMD_GP_GetGameInfo } from \"./CMD_GP_GetGameInfo\"\r\nimport { tagGameStationEx } from \"../tagGameStationEx\";\r\nimport { tagGameServerEx } from \"../tagGameServerEx\";\r\nimport { GameIDList } from \"./GameIDList\";\r\nimport { CGameLib } from \"../CGameLib\";\r\nimport { tagGameKind } from \"./tagGameKind\";\r\nimport { tagVersionInfo } from \"../tagVersionInfo\";\r\nimport { tagClientInfo } from \"../tagClientInfo\";\r\nimport { tagConnectInfo } from \"../tagConnectInfo\";\r\nimport { CMD_CM_SysteMessage } from \"../CMD_CM_SysteMessage\";\r\nimport PublicUserInfo = require(\"../../PublicUserInfo\");\r\nenum LoginType {\r\n    GetGameInfo = 0,\r\n    GetServerList,\r\n};\r\n\r\nexport class GamePlace {\r\n    private m_plazaIP: string;\r\n    private m_plazaPort: number;\r\n    private m_webRoot: string;\r\n    private m_socket: WebSocket;\r\n    private m_socketType: number;\r\n    private m_userLoginInfo: CMD_GP_LogonSuccess_Ex2;\r\n    private m_pSink;\r\n    private m_gameIDList: GameIDList;\r\n    private m_gameLib: CGameLib;\r\n    private m_gameID: number;\r\n    private _publicUserInfo: PublicUserInfo;\r\n    private m_bRefreshServerList: boolean;\r\n    public constructor(gameLib, publicUserInfo) {\r\n        this.m_socketType = LoginType.GetGameInfo;\r\n        this.m_pSink = null;\r\n        this.m_gameLib = gameLib;\r\n        this.m_gameIDList = new GameIDList();\r\n        this._publicUserInfo = publicUserInfo;\r\n        TSCommon.log(\"password for gameplace = \" + publicUserInfo.encryptPassword);\r\n    }\r\n\r\n    public getGameLib(): CGameLib {\r\n        return this.m_gameLib;\r\n    }\r\n\r\n    public setSink(sink) {\r\n        this.m_pSink = sink;\r\n    }\r\n\r\n    public setGameID(gameid: number) {\r\n        this.m_gameID = gameid;\r\n    }\r\n\r\n    public loginGame() {\r\n        this.m_pSink.onLogonFinished();\r\n    }\r\n\r\n    public setServerIP(ip: string) {\r\n        this.m_plazaIP = ip;\r\n    }\r\n\r\n    public setPort(port: number) {\r\n        this.m_plazaPort = port;\r\n    }\r\n\r\n    public setWebRoot(webRoot: string) {\r\n        this.m_webRoot = webRoot;\r\n    }\r\n\r\n    public getGameInfo() {\r\n        this.initWebSocket();\r\n    }\r\n\r\n    private changeIP(ip: number): string {\r\n        var ba: ByteArray = new ByteArray();\r\n        ba.writeUnsignedInt(ip);\r\n        ba.position = 0;\r\n        return ba.readUnsignedByte() + \".\" + ba.readUnsignedByte() + \".\" + ba.readUnsignedByte() + \".\" + ba.readUnsignedByte();\r\n    }\r\n\r\n    private initWebSocket(): void {\r\n        //创建 WebSocket 对象\r\n        //this.m_socket = new WebSocket(\"ws://dged.ss2007.com:13502\");\r\n        this.m_socket = new WebSocket(\"wss://\" + this.m_plazaIP + \":\" + this.m_plazaPort);\r\n        //设置数据格式为二进制，默认为字符串\r\n        this.m_socket.binaryType = \"arraybuffer\";\r\n        // //添加收到数据侦听，收到数据会调用此方法\r\n        // this.m_socket.addEventListener(egret.ProgressEvent.SOCKET_DATA, this.onReceiveMessage, this);\r\n        // //添加链接打开侦听，连接成功会调用此方法\r\n        // this.m_socket.addEventListener(egret.Event.CONNECT, this.onSocketOpen, this);\r\n        // //添加链接关闭侦听，手动关闭或者服务器关闭连接会调用此方法\r\n        // this.m_socket.addEventListener(egret.Event.CLOSE, this.onSocketClose, this);\r\n        // //添加异常侦听，出现异常会调用此方法\r\n        // this.m_socket.addEventListener(egret.IOErrorEvent.IO_ERROR, this.onSocketError, this);\r\n        var socket: WebSocket = this.m_socket;\r\n        var self = this;\r\n        this.m_socket.onopen = function (evt) {\r\n            console.log(\"websocket was opened.\");\r\n            self.sendGetGameInfo();\r\n        };\r\n\r\n        this.m_socket.onmessage = function (event) {\r\n            self.onReceiveMessage(event.data);\r\n        };\r\n\r\n        this.m_socket.onerror = function (event) {\r\n            console.log(\"Send Text fired an error\");\r\n            self.m_socket = null;\r\n            self.m_pSink.onLogonFailed(\"网络连接失败，请检查网络后重新连接！\",1);\r\n        };\r\n\r\n        this.m_socket.onclose = function (event) {\r\n            console.log(\"onclose\");\r\n            self.m_socket = null;\r\n        };\r\n    }\r\n\r\n    private closeSocket(): void {\r\n        if (!this.m_socket)\r\n            return;\r\n        this.m_socket.close();\r\n    }\r\n\r\n    private onReceiveMessage(arraybuffer: ArrayBuffer): void {\r\n        //创建 ByteArray 对象        \r\n        var byte: ByteArray = new ByteArray(arraybuffer);\r\n        //读取数据\r\n        var nLen = byte.length;\r\n        var cbMainCmd = byte.readUnsignedByte();\r\n        var cbSubCmd = byte.readUnsignedByte();\r\n        var cbHandleCode = byte.readUnsignedByte();\r\n\r\n        var nRealDataLen = nLen - 4;\r\n        if (nRealDataLen <= 0) {\r\n            if (nLen < 3)\r\n                return;\r\n\r\n            this.recvData(cbMainCmd, cbSubCmd, cbHandleCode, null);\r\n            return\r\n        }\r\n        var data: ByteArray = new ByteArray();\r\n        byte.readUnsignedByte();\r\n        byte.readBytes(data);\r\n        this.recvData(cbMainCmd, cbSubCmd, cbHandleCode, data);\r\n        TSCommon.log(\"onReceiveMessage main = \" + cbMainCmd + \",sub = \" + cbSubCmd + \",len = \" + data.length);\r\n    }\r\n\r\n    private recvData(cbMainCmd: number, cbSubCmd: number, cbHandleCode: number, buf: ByteArray) {\r\n        switch (cbMainCmd) {\r\n            case PlazaCmds.MAIN_GP_LOGON:\r\n                this.onMainLogonMessage(cbSubCmd, cbHandleCode, buf);\r\n                return;\r\n            case PlazaCmds.MAIN_GP_SERVER_LIST:\r\n                this.onMainServerListMessage(cbSubCmd, cbHandleCode, buf);\r\n                return;\r\n            case PlazaCmds.MAIN_CM_SERVICE:\r\n                this.onMainSystemMessage(cbSubCmd, cbHandleCode, buf);\r\n                return;\r\n            case PlazaCmds.MAIN_GP_CONFIG:\r\n                this.onMainConfig(cbSubCmd, cbHandleCode, buf)\r\n                return;\r\n            default:\r\n                this.trace(\"onrecv main = \" + cbMainCmd + \",sub = \" + cbSubCmd);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private onMainLogonMessage(cbSubCmd: number, cbHandleCode: number, buf: ByteArray) {\r\n        switch (cbSubCmd) {\r\n            case PlazaCmds.SUB_GP_GAMEINFO: {\r\n                this.m_userLoginInfo = new CMD_GP_LogonSuccess_Ex2();\r\n                this.m_userLoginInfo.deserialize(buf);\r\n                TSCommon.log(\"SUB_GP_GAMEINFO userdbid = \" + this.m_userLoginInfo.nUserDBID);\r\n                this.getUserGameInfo();\r\n                return;\r\n            }\r\n\r\n        }\r\n        TSCommon.log(\"onMainLogonMessage,sub = \" + cbSubCmd);\r\n    }\r\n\r\n    private getUserGameInfo() {\r\n        // 获取游戏相关信息，暂时无用\r\n    }\r\n    public getUserLoginInfo() {\r\n        return this.m_userLoginInfo;\r\n    }\r\n\r\n    public clearServerList() {\r\n        this.m_gameIDList.clearServerList();\r\n    }\r\n\r\n    public getStationOnlineCount(nStationID){\r\n        return this.m_gameIDList.getStationOnlineCount(this._dwGameID,nStationID)\r\n    }\r\n\r\n    private onMainServerListMessage(cbSubCmd: number, cbHandleCode: number, buf: ByteArray) {\r\n        switch (cbSubCmd) {\r\n            case PlazaCmds.SUB_GP_SERVER_LIST_TYPE_V1: {\r\n                var typeCount: number = buf.length / 21;\r\n                TSCommon.log(\"SUB_GP_SERVER_LIST_TYPE_V1 typecount = \" + typeCount);\r\n                return;\r\n            }\r\n            case PlazaCmds.SUB_GP_SERVER_LIST_KIND: {\r\n                if (buf == null) {\r\n                    TSCommon.log(\"SUB_GP_SERVER_LIST_KIND kindCount = 0\");\r\n                    return;\r\n                }\r\n                var kindCount: number = buf.length / tagGameKind.getLen();\r\n                for (var i = 0; i < kindCount; i++) {\r\n                    var gameKind: tagGameKind = new tagGameKind();\r\n                    gameKind.deserialize(buf);\r\n                    this.m_gameIDList.addGameID(gameKind.dwKindID);\r\n                    TSCommon.log(\"KindID = \" + gameKind.dwKindID);\r\n                }\r\n                TSCommon.log(\"SUB_GP_SERVER_LIST_KIND kindCount = \" + kindCount);\r\n\r\n                if (cbHandleCode == 0) {\r\n                    this.m_bRefreshServerList = false;\r\n                    this.sendServerListCmd();\r\n                }\r\n                return;\r\n            }\r\n            case PlazaCmds.SUB_GP_SERVER_LIST_STATION: {\r\n                var stationCount: number = buf.length / tagGameStationEx.getLen();\r\n                TSCommon.log(\"SUB_GP_SERVER_LIST_STATION count = \" + stationCount);\r\n                if (stationCount == 0) {\r\n                    return;\r\n                }\r\n                for (var i: number = 0; i < stationCount; i++) {\r\n                    var station: tagGameStationEx = new tagGameStationEx();\r\n                    station.deserialize(buf);\r\n                    this.addGameStation(station);\r\n                    TSCommon.log(\"station name = \" + station.szStationName + \",id=\" + station.dwParentID);\r\n                }\r\n                return;\r\n            }\r\n            case PlazaCmds.SUB_GP_SERVER_LIST_ROOM: {\r\n                // 不处理\r\n                if (buf == null) {\r\n                    TSCommon.log(\"SUB_GP_SERVER_LIST_ROOM  buf null\");\r\n                    return;\r\n                }\r\n                var stationCount: number = buf.length / tagGameServerEx.getLen();\r\n                TSCommon.log(\"SUB_GP_SERVER_LIST_ROOM count = \" + stationCount);\r\n                if (stationCount == 0) {\r\n                    return;\r\n                }\r\n                for (var i: number = 0; i < stationCount; i++) {\r\n                    var room: tagGameServerEx = new tagGameServerEx();                    \r\n                    room.deserializeEx(buf);                    \r\n                    room = this.addGameServer(room);\r\n                    if (room) {\r\n                        var station = this.getGameStation(room.dwStationID);\r\n                        if (station) {\r\n                            station.dwMinGold = room.dwMinGold;\r\n                            station.dwRuleID = room.dwRuleID;\r\n                        }\r\n                        TSCommon.log(\"server name exist = \" + room.szGameRoomName);\r\n                    }\r\n\r\n                }\r\n                return;\r\n            }\r\n            case PlazaCmds.SUB_GP_SERVER_LIST_ROOM_EX: {\r\n                if (buf == null) {\r\n                    TSCommon.log(\"SUB_GP_SERVER_LIST_ROOM_EX  buf null\");\r\n                    return;\r\n                }\r\n                var stationCount: number = buf.length / tagGameServerEx.getExtraInfoLen();\r\n                TSCommon.log(\"SUB_GP_SERVER_LIST_ROOM_EX count = \" + stationCount + \",handleCode = \" + cbHandleCode);\r\n                for (var i: number = 0; i < stationCount; i++) {\r\n                    var serverID: number = buf.readUnsignedInt();\r\n                    var room = this.m_gameIDList.getGameServer(serverID);\r\n                    if (room) {\r\n                        room.deserializeExtraInfo(buf);\r\n                        var station = this.getGameStation(room.dwStationID);\r\n                        if (station) {\r\n                            station.dwMinGold = room.dwMinGold;\r\n                            station.dwRuleID = room.dwRuleID;\r\n                        }\r\n                    }\r\n\r\n                }\r\n                if (cbHandleCode == 0) {\r\n\r\n                }\r\n                return;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n        TSCommon.log(\"onMainServerListMessage,sub = \" + cbSubCmd);\r\n    }\r\n\r\n    private sendServerListCmd() {\r\n        var ba: ByteArray = new ByteArray();\r\n        ba.writeInt(1);\r\n        ba.writeInt(this.m_gameID);\r\n        var version: tagVersionInfo = this.getGameLib().VersionInfo;\r\n        version.serialize(ba);\r\n        this.sendData(PlazaCmds.MAIN_GP_SERVER_LIST, PlazaCmds.SUB_GP_GET_SERVER_LIST, ba);\r\n    }\r\n\r\n    private onMainSystemMessage(cbSubCmd: number, cbHandleCode: number, buf: ByteArray) {\r\n        switch (cbSubCmd) {\r\n            case PlazaCmds.SUB_CM_MESSAGE: {\r\n                var msg: CMD_CM_SysteMessage = new CMD_CM_SysteMessage();\r\n                msg.deserialize(buf);\r\n                TSCommon.log(\"SUB_CM_MESSAGE:\" + msg.szMessage);\r\n                if (msg.bCloseLine > 0)\r\n                    this.m_socket.close();\r\n                if (msg.wMessageLen > 0)\r\n                    this.m_pSink.onLogonFailed(msg.szMessage,2);\r\n                return;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n        TSCommon.log(\"onMainSystemMessage,sub = \" + cbSubCmd);\r\n    }\r\n\r\n    private onMainConfig(cbSubCmd: number, cbHandleCode: number, buf: ByteArray) {\r\n        TSCommon.log(\"onMainConfig,sub = \" + cbSubCmd);\r\n    }\r\n\r\n    private trace(msg: any): void {\r\n        TSCommon.log(msg);\r\n    }\r\n\r\n    private sendGetGameInfo() {\r\n        var l: CMD_GP_GetGameInfo = new CMD_GP_GetGameInfo();\r\n        l.nUserDBID = this._publicUserInfo.userDBID;\r\n        l.nPartnerID = 1;\r\n        l.nVersionCode = 1;\r\n        l.ClientInfo = new tagClientInfo();\r\n        l.VersionInfo = new tagVersionInfo();\r\n        l.password = this._publicUserInfo.encryptPassword;\r\n        var ba: ByteArray = new ByteArray();\r\n        l.serialize(ba);\r\n        this.sendData(PlazaCmds.MAIN_GP_LOGON, PlazaCmds.SUB_GP_GET_GAMEINFO_EX, ba);\r\n    }\r\n\r\n    private sendData(mainCmd: number, subCmd: number, ba: ByteArray) {\r\n        var b: ByteArray = new ByteArray();\r\n        b.writeByte(mainCmd);\r\n        b.writeByte(subCmd);\r\n        b.writeByte(0);\r\n        b.writeByte(0);\r\n        b.writeBytes(ba);\r\n        //TSCommon.log(\"sendData len = \" + b.length);\r\n        if (!this.m_socket) { return; }\r\n        if (this.m_socket.readyState === WebSocket.OPEN) {\r\n            this.m_socket.send(b.buffer);\r\n        }\r\n    }\r\n\r\n    public getGameStation(stationID: number): tagGameStationEx {\r\n        return this.m_gameIDList.getStation(stationID);\r\n    }\r\n\r\n    public getGameServer(gameserverID: number): tagGameServerEx {\r\n        return this.m_gameIDList.getGameServer(gameserverID);\r\n    }\r\n\r\n\r\n    public getServerByIPAndPort(ipaddress: string, port: number){\r\n        var gameServerList = this.getAllGameServerList();\r\n\r\n        for(var i = 0; i < gameServerList.length; i++){\r\n            if(this.changeIP(gameServerList[i].dwServerIP) == ipaddress && \r\n            gameServerList[i].uServerPort == port){\r\n                return gameServerList[i];\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    public getStationList(): tagGameStationEx[] {\r\n        var stationList = this.m_gameIDList.getStationList(this.m_gameID);\r\n        if (stationList.length == 0) {\r\n            this.m_gameIDList.addGameID(this._dwGameID);\r\n            //this.requestServerList()\r\n        }\r\n        return stationList;\r\n    }\r\n\r\n    public getGameServerList(stationID: number): tagGameServerEx[] {\r\n        return this.m_gameIDList.getGameServerList(this.m_gameID, stationID);\r\n    }\r\n\r\n    public getAllGameServerList(): tagGameServerEx[] {\r\n        return this.m_gameIDList.getAllGameServerList(this.m_gameID);\r\n    }\r\n\r\n    public getAutoEnterRoom(lpszStation: string) {\r\n        var server = null;\r\n        var full = 0xFFFF;\r\n\r\n        var minServer = null;\r\n\r\n        var dwFocusStationID = -1;\r\n        //优先进入更大额房间\r\n        var nMinGold = 0;\r\n        var stationList = this.getStationList();\r\n        for (var i = 0; i < stationList.length; i++) {\r\n            var gameStation = stationList[i];\r\n            //TSCommon.log(\"getAutoEnterRoom station = \" + gameStation.szStationName);\r\n            if (lpszStation != null && (lpszStation.length) > 0) {\r\n                if ((gameStation.szStationName.indexOf(lpszStation)) >= 0) {\r\n                    dwFocusStationID = gameStation.dwStationID;\r\n                    //TSCommon.log(\"getAutoEnterRoom focusid = \" + dwFocusStationID);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        var gameList = this.getAllGameServerList();\r\n        for (var i = 0; i < gameList.length; i++) {\r\n            var room = gameList[i];\r\n            //TSCommon.log(\"getAutoEnterRoom room = \" + room.szGameRoomName + \",stationid = \" + room.dwStationID);\r\n            if (dwFocusStationID != -1) {\r\n                if (room.dwStationID != dwFocusStationID) {\r\n                    continue;\r\n                }\r\n            }\r\n\r\n            if (minServer == null) {\r\n                minServer = room;\r\n            } else {\r\n                if (minServer.dwMinGold > room.dwMinGold) {\r\n                    minServer = room;\r\n                }\r\n\r\n            }\r\n\r\n            //增加一个金额判断\r\n            if (room.dwMaxGold != 0 && room.dwMaxGold < this._publicUserInfo.nGold)\r\n                continue;\r\n\r\n            if (room.dwMinGold != 0 && room.dwMinGold > this._publicUserInfo.nGold)\r\n                continue;\r\n\r\n\r\n            var tempFull = room.wMaxOnLineCount * 4 / 5 - room.wOnLineCount;\r\n            if (tempFull <= 0)\r\n                continue;\r\n            if (server == null) {\r\n                server = room;\r\n            }\r\n\r\n            var nTempMinGold = room.dwMinGold;\r\n            if (nTempMinGold > nMinGold) {\r\n                nMinGold = nTempMinGold;\r\n                server = room;\r\n            }\r\n        };\r\n        if (server == null)\r\n            server = minServer;\r\n        return server;\r\n    }\r\n\r\n    public addGameStation(pStation: tagGameStationEx): tagGameStationEx {\r\n        // 先看是否存在\r\n        return this.m_gameIDList.addStation(pStation);\r\n    }\r\n\r\n    public addGameServer(pGameServer: tagGameServerEx): tagGameServerEx {\r\n        return this.m_gameIDList.addGameServer(pGameServer);\r\n    }\r\n}"]}