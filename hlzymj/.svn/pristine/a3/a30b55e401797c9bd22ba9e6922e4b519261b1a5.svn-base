{"version":3,"sources":["MatchGameOverLayer.js"],"names":["GameDefs","require","Resources","HallResources","GameCfg","cc","Class","extends","Component","properties","match_level_star_bg","default","type","Node","match_level_star","match_level","match_cup","cur_score","Label","level_progressBar","ProgressBar","level_tips","win_lose_symbol","Sprite","win_counts","result_info","hu_type","hu_fan","laiyou_mj","win_bg_spriteFrame","SpriteFrame","lose_bg_spriteFrame","lose_score_font","Font","win_score_font","diaoxingAssets","dragonBones","DragonBonesAtlasAsset","jiaxingAssets","onLoad","windowSize","view","getVisibleSize","node","getChildByName","setContentSize","TSCommon","addEvent","PROTECT_SCORE_SUCCESS","onShareProtectScoreSucceed","onDestroy","stopLeftTimer","removeEvent","m_jiaxingdragonDisplay","removeEventListener","EventObject","COMPLETE","onPlayJiaxingFinished","m_diaoxingdragonDisplay","onPlayDiaoxingFinished","onEnable","m_myselfWinOrLoseScore","getComponent","spriteFrame","active","winSize","director","getWinSize","x","width","posY","y","moveTo","p","self","onEnd","callFunc","m_bIsLiuju","loadRes","setHuFan","setLaiyouZi","setLevelInfo","sequence","runAction","startLeftTimer","recordPlayerLogToServer","recordList","count_page","loader","err","m_yingLaiYouFrame","setHuType","m_ruanLaiYouFrame","m_yingZiMoFrame","m_ruanZiMoFrame","m_youZhongYouFrame","init","bIsLiuju","huType","fanNum","laiyouValue","showDetailResult","nMatchLevel","nMatchScore","myselfWinOrLoseScore","winCount","m_huType","m_fanNum","m_laiyouValue","m_showDetailResult","m_matchLevel","m_matchScore","m_winCount","console","log","m_leftTimerStop","m_leftTime","divisionID","curLevelData","getInstance","getRankDataById","curMaxScore","MaxScore","curMinScore","MinScore","font","string","getFormatNumber","data","nextScore","offsetScore","curPercent","getRankAndStarByScore","cup","levelDir","levelOffsetScore","curLevelScore","i","childrenCount","children","starNum","Math","floor","preScore","preLevelScore","preRankData","preStarNum","prePercent","progress","id","loadResDir","assets","actNode","dragonDisplay","addComponent","ArmatureDisplay","DragonBonesAsset","dragonAsset","dragonAtlasAsset","armatureName","playAnimation","destroy","scrollToPercent","addEventListener","addChild","scrollTime","deltaScroll","setProgress","performWithDelay","curScore","getLeftLeaveTime","frame","EndStatus","RuanPai","undefined","frameName","get_frameName","parent","mj1_face_dao","getSpriteFrame","leftTimerNode","callback","label","getGameLib","leaveGameRoom","onLeaveGameClicked","onDetailResultClicked","onPrepareClicked","G","matchGameReady"],"mappings":"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","file":"MatchGameOverLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\gameOver","sourcesContent":["/**\r\n * 此处结算界面为段位赛的结算界面\r\n */\r\nvar GameDefs = require(\"GameDefs\");\r\nvar Resources = require(\"Resources\");\r\nimport { TSCommon } from \"../../TSCommon\";\r\nvar HallResources = require(\"HallResources\");\r\nvar GameCfg = require(\"GameCfg\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        match_level_star_bg:{\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        match_level_star: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        match_level: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        match_cup: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        cur_score: cc.Label,\r\n\r\n        level_progressBar: {\r\n            default: null,\r\n            type: cc.ProgressBar,\r\n        },\r\n\r\n        level_tips: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        win_lose_symbol: cc.Sprite,\r\n\r\n        win_counts: cc.Label,\r\n\r\n        result_info: cc.Node,\r\n\r\n        hu_type: cc.Sprite,\r\n\r\n        hu_fan: cc.Label,\r\n\r\n        laiyou_mj: cc.Sprite,\r\n\r\n        win_bg_spriteFrame: cc.SpriteFrame,\r\n\r\n        lose_bg_spriteFrame: cc.SpriteFrame,\r\n\r\n        lose_score_font: cc.Font,\r\n\r\n        win_score_font: cc.Font,\r\n\r\n        diaoxingAssets: dragonBones.DragonBonesAtlasAsset,\r\n\r\n        jiaxingAssets: dragonBones.DragonBonesAtlasAsset,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad: function () {\r\n        var windowSize = cc.view.getVisibleSize();\r\n        //主界面不显示\r\n        if (this.node.getChildByName(\"bg\")) {\r\n            this.node.getChildByName(\"bg\").setContentSize(windowSize);\r\n        }\r\n\r\n        TSCommon.addEvent(GameCfg.PROTECT_SCORE_SUCCESS, this.onShareProtectScoreSucceed, this);\r\n    },\r\n\r\n\r\n    onDestroy: function () {\r\n        this.stopLeftTimer();\r\n        TSCommon.removeEvent(GameCfg.PROTECT_SCORE_SUCCESS, this.onShareProtectScoreSucceed, this);\r\n\r\n        if(this.m_jiaxingdragonDisplay){\r\n            this.m_jiaxingdragonDisplay.removeEventListener(dragonBones.EventObject.COMPLETE, this.onPlayJiaxingFinished, this)\r\n        }\r\n\r\n        if(this.m_diaoxingdragonDisplay){\r\n            this.m_diaoxingdragonDisplay.removeEventListener(dragonBones.EventObject.COMPLETE, this.onPlayDiaoxingFinished, this)\r\n        }\r\n    },\r\n\r\n\r\n    onEnable: function () {\r\n\r\n        if (this.m_myselfWinOrLoseScore < 0) {\r\n            this.node.getChildByName(\"result_bg\").getComponent(cc.Sprite).spriteFrame = this.lose_bg_spriteFrame;\r\n        }\r\n        else {\r\n            this.node.getChildByName(\"result_bg\").getComponent(cc.Sprite).spriteFrame = this.win_bg_spriteFrame;\r\n        }\r\n\r\n        this.win_counts.node.active = false;\r\n\r\n        var winSize = cc.director.getWinSize();\r\n\r\n        this.node.getChildByName(\"result_bg\").x = -winSize.width;\r\n\r\n        var posY = this.node.getChildByName(\"result_bg\").y\r\n\r\n\r\n        var moveTo = cc.moveTo(0.1, cc.p(0, posY));\r\n\r\n        var self = this;\r\n        var onEnd = cc.callFunc(() => {\r\n            if (self.m_bIsLiuju) {\r\n                self.result_info.getChildByName(\"hutype_bg\").active = false;\r\n                self.result_info.getChildByName(\"laiyou_bg\").active = false;\r\n                self.result_info.getChildByName(\"liuju_bg\").active = true;\r\n            }\r\n            else {\r\n                self.result_info.getChildByName(\"hutype_bg\").active = true;\r\n                self.result_info.getChildByName(\"laiyou_bg\").active = true;\r\n                self.result_info.getChildByName(\"liuju_bg\").active = false;\r\n\r\n                self.loadRes();\r\n                self.setHuFan();\r\n                self.setLaiyouZi();\r\n            }\r\n            this.setLevelInfo();\r\n        })\r\n\r\n        var sequence = cc.sequence(moveTo, onEnd);\r\n\r\n        this.node.getChildByName(\"result_bg\").runAction(sequence);\r\n\r\n        this.startLeftTimer();\r\n\r\n        var HallResources = require(\"HallResources\");\r\n        HallResources.recordPlayerLogToServer(HallResources.recordList.count_page);\r\n        \r\n    },\r\n\r\n    loadRes: function () {\r\n\r\n        var self = this;\r\n\r\n        //硬癞油\r\n        cc.loader.loadRes(\"texture/game/gameOver/yinglaiyou_match\", cc.SpriteFrame, function (err, spriteFrame) {\r\n            self.m_yingLaiYouFrame = spriteFrame;\r\n            self.setHuType();\r\n        })\r\n\r\n        //软癞油\r\n        cc.loader.loadRes(\"texture/game/gameOver/ruanlaiyou_match\", cc.SpriteFrame, function (err, spriteFrame) {\r\n            self.m_ruanLaiYouFrame = spriteFrame;\r\n            self.setHuType();\r\n        })\r\n\r\n        //硬自摸\r\n        cc.loader.loadRes(\"texture/game/gameOver/yingzimo_match\", cc.SpriteFrame, function (err, spriteFrame) {\r\n            self.m_yingZiMoFrame = spriteFrame;\r\n            self.setHuType();\r\n        })\r\n\r\n        //软自摸\r\n        cc.loader.loadRes(\"texture/game/gameOver/ruanzimo_match\", cc.SpriteFrame, function (err, spriteFrame) {\r\n            self.m_ruanZiMoFrame = spriteFrame;\r\n            self.setHuType();\r\n        })\r\n\r\n        //油中油\r\n        cc.loader.loadRes(\"texture/game/gameOver/youzhongyou_match\", cc.SpriteFrame, function (err, spriteFrame) {\r\n            self.m_youZhongYouFrame = spriteFrame;\r\n            self.setHuType();\r\n        })\r\n    },\r\n\r\n    /*\r\n     * 初始化\r\n     * @huType 胡牌类型 \r\n     * @fanNum 胡牌番数\r\n     * @laiyouValue 癞油字的牌值\r\n    */\r\n    init: function (bIsLiuju, huType, fanNum, laiyouValue, showDetailResult, nMatchLevel, nMatchScore, myselfWinOrLoseScore, winCount) {\r\n        this.m_bIsLiuju = bIsLiuju;\r\n        this.m_huType = huType;\r\n        this.m_fanNum = fanNum;\r\n        this.m_laiyouValue = laiyouValue;\r\n        this.m_showDetailResult = showDetailResult;\r\n        this.m_matchLevel = nMatchLevel;\r\n        this.m_matchScore = nMatchScore;\r\n\r\n        this.m_myselfWinOrLoseScore = myselfWinOrLoseScore;\r\n\r\n        //连胜场数\r\n        this.m_winCount = winCount;\r\n        console.log(\"获取到的连胜次数为:\" + winCount);\r\n        this.m_leftTimerStop = false;\r\n        this.m_leftTime = 25;\r\n    },\r\n\r\n\r\n    setLevelInfo: function () {\r\n\r\n        //段位ID\r\n        var divisionID = this.m_matchLevel;\r\n\r\n        //当前段位数据\r\n        var curLevelData = HallResources.getInstance().getRankDataById(divisionID);\r\n\r\n        var curMaxScore = curLevelData.MaxScore;\r\n        var curMinScore = curLevelData.MinScore;\r\n\r\n        this.cur_score.font = this.m_myselfWinOrLoseScore >= 0 ? this.win_score_font : this.lose_score_font;\r\n        this.cur_score.string = require(\"Tools\").getFormatNumber(this.m_matchScore);\r\n\r\n\r\n        //下一个段位的数据\r\n        var data = HallResources.getInstance().getRankDataById(divisionID + 1);\r\n        var nextScore = data.MinScore;\r\n\r\n        this.level_tips.getComponent(cc.Label).string = \"还差\" + (nextScore - this.m_matchScore) + \"分进入晋级赛\";\r\n        var offsetScore = (curMaxScore - curMinScore);\r\n        var curPercent = (this.m_matchScore - curMinScore) / offsetScore\r\n        \r\n\r\n        var data = HallResources.getInstance().getRankAndStarByScore(this.m_matchScore);\r\n        var self = this;\r\n        cc.loader.loadRes(\"texture/hallRes/qualifyingCup/cup\" + data.cup, cc.SpriteFrame, function (err, spriteFrame) {\r\n            if (!err) {\r\n                self.match_cup.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n            }\r\n        });\r\n\r\n        var levelDir = this.m_myselfWinOrLoseScore >= 0 ? (\"texture/hallRes/qualifyingCup/rank_level_\" + divisionID) : (\"texture/hallRes/qualifyingCup/rank_level_blue_\" + divisionID);\r\n        cc.loader.loadRes(levelDir, cc.SpriteFrame, function (err, spriteFrame) {\r\n            if (!err) {\r\n                self.match_level.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n            }\r\n        });\r\n\r\n\r\n        var levelOffsetScore = curMaxScore - curMinScore;\r\n        var curLevelScore = this.m_matchScore - curMinScore;\r\n\r\n        for (var i = 0; i < this.match_level_star.childrenCount; i++) {\r\n            this.match_level_star.children[i].active = false;\r\n        }\r\n\r\n        var starNum = Math.floor(curLevelScore / levelOffsetScore * 3);\r\n        console.log(\"当前的星数为：\" + starNum);\r\n\r\n        //之前的分数\r\n        var preScore = this.m_matchScore - this.m_myselfWinOrLoseScore;\r\n        var preLevelScore = preScore - curMinScore;\r\n\r\n        console.log(\"之前的段位分数为: \"+ preScore);\r\n        var preRankData = HallResources.getInstance().getRankAndStarByScore(preScore);\r\n        // var curRankData = HallResources.getInstance().getRankAndStarByScore(this.m_matchScore);\r\n\r\n        //之前的星数\r\n        var preStarNum = Math.floor(preLevelScore / levelOffsetScore * 3);\r\n        var prePercent = preLevelScore / offsetScore;\r\n\r\n        this.level_progressBar.progress = prePercent // (this.m_matchScore - curMinScore) / offsetScore;\r\n\r\n        console.log(\"之前的星数目为：\" + preStarNum);\r\n\r\n        console.log(\"之前的段位id为：\" + preRankData.id);\r\n        console.log(\"当前的段位id为：\" + divisionID);\r\n        if(preRankData.id == divisionID){\r\n\r\n            if(starNum > preStarNum){   //加星了\r\n                for (var i = 0; i < starNum - 1; i++) {\r\n                    this.match_level_star.children[i].active = true;\r\n                }\r\n\r\n                cc.loader.loadResDir(\"animation/dragonBones/dh_jiaxing\", function(err, assets){\r\n                    self.jiaxingAssets = assets;\r\n\r\n                    var actNode = new cc.Node();\r\n                    var dragonDisplay = actNode.addComponent(dragonBones.ArmatureDisplay);\r\n            \r\n                    for(var i in self.jiaxingAssets){\r\n                        if(self.jiaxingAssets[i] instanceof dragonBones.DragonBonesAsset){\r\n                            dragonDisplay.dragonAsset = self.jiaxingAssets[i];\r\n                        }\r\n                        if(self.jiaxingAssets[i] instanceof dragonBones.DragonBonesAtlasAsset){\r\n                            dragonDisplay.dragonAtlasAsset  = self.jiaxingAssets[i];\r\n                        }\r\n                    }\r\n                \r\n                    dragonDisplay.armatureName = 'armatureName';\r\n                    dragonDisplay.playAnimation(\"shengxing\");\r\n\r\n                    self.onPlayJiaxingFinished = function(){\r\n                        self.match_level_star.children[starNum - 1].active = true;\r\n                        actNode.destroy();\r\n\r\n                        self.scrollToPercent(prePercent, curPercent, 0.3);\r\n                    }\r\n                    dragonDisplay.addEventListener(dragonBones.EventObject.COMPLETE, self.onPlayJiaxingFinished, self)\r\n\r\n                    self.m_jiaxingdragonDisplay = dragonDisplay;\r\n                    self.match_level_star_bg.children[starNum - 1].addChild(actNode);\r\n                });\r\n                \r\n            }\r\n            else if(starNum < preStarNum){  //减星了\r\n                for (var i = 0; i < starNum; i++) {\r\n                    this.match_level_star.children[i].active = true;\r\n                }\r\n\r\n                cc.loader.loadResDir(\"animation/dragonBones/dh_diaoxing\", function(err, assets){\r\n                    self.diaoxingAssets = assets;\r\n\r\n                    var actNode = new cc.Node();\r\n                    var dragonDisplay = actNode.addComponent(dragonBones.ArmatureDisplay);\r\n            \r\n                    for(var i in self.diaoxingAssets){\r\n                        if(self.diaoxingAssets[i] instanceof dragonBones.DragonBonesAsset){\r\n                            dragonDisplay.dragonAsset = self.diaoxingAssets[i];\r\n                        }\r\n                        if(self.diaoxingAssets[i] instanceof dragonBones.DragonBonesAtlasAsset){\r\n                            dragonDisplay.dragonAtlasAsset  = self.diaoxingAssets[i];\r\n                        }\r\n                    }\r\n                \r\n                    dragonDisplay.armatureName = 'armatureName';\r\n                    dragonDisplay.playAnimation(\"diaoxing\");\r\n                    self.onPlayDiaoxingFinished = function(){\r\n                        self.match_level_star.children[starNum - 1].active = false;\r\n                        actNode.destroy();\r\n                        self.scrollToPercent(prePercent, curPercent, 0.3);\r\n                    }\r\n                    dragonDisplay.addEventListener(dragonBones.EventObject.COMPLETE, self.onPlayDiaoxingFinished, self)\r\n\r\n                    self.m_diaoxingdragonDisplay = dragonDisplay;\r\n                    self.match_level_star.children[starNum - 1].addChild(actNode);\r\n                });\r\n                \r\n            }\r\n        }\r\n\r\n        if (this.m_myselfWinOrLoseScore < 0) {\r\n            cc.loader.loadRes(\"texture/game/gameOver/result_lose_icon\", cc.SpriteFrame, function (err, spriteFrame) {\r\n                if (!err) {\r\n                    self.win_lose_symbol.spriteFrame = spriteFrame;\r\n                }\r\n            })\r\n        }\r\n        else {\r\n            if(this.m_winCount == 1){\r\n                cc.loader.loadRes(\"texture/game/gameOver/result_win_icon\", cc.SpriteFrame, function (err, spriteFrame) {\r\n                    if (!err) {\r\n                        self.win_lose_symbol.spriteFrame = spriteFrame;\r\n                    }\r\n                })\r\n            }\r\n            else if(this.m_winCount > 1){\r\n                this.win_counts.node.active = true;\r\n                this.win_counts.string = this.m_winCount;\r\n\r\n                cc.loader.loadRes(\"texture/game/gameOver/result_continue_win\", cc.SpriteFrame, function (err, spriteFrame) {\r\n                    if (!err) {\r\n                        self.win_lose_symbol.spriteFrame = spriteFrame;\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    //滑动列表滑动到某个百分比\r\n    scrollToPercent: function (prePercent, curPercent, scrollTime) {\r\n        var deltaScroll = (curPercent - prePercent) / (scrollTime * 100);\r\n        var self = this;\r\n        var setProgress = function(){\r\n            if((deltaScroll && (prePercent > curPercent)) || (deltaScroll < 0 && (prePercent < curPercent))){\r\n                return;\r\n            }\r\n\r\n            prePercent +=  deltaScroll;\r\n            self.level_progressBar.progress = prePercent;\r\n            TSCommon.performWithDelay(this, setProgress, scrollTime / (scrollTime * 100));\r\n        }\r\n        TSCommon.performWithDelay(this, setProgress, scrollTime / (scrollTime * 100));\r\n    },\r\n\r\n    //分享保分成功\r\n    onShareProtectScoreSucceed:function(){\r\n\r\n        //之前的分数\r\n        var preScore = this.m_matchScore - this.m_myselfWinOrLoseScore;\r\n\r\n        var curScore = this.m_matchScore;\r\n\r\n        //当前段位数据\r\n        var curLevelData = HallResources.getInstance().getRankDataById(this.m_matchLevel);\r\n\r\n        var MinScore = curLevelData.MinScore;\r\n\r\n        //当前段位分数的差值\r\n        var offsetScore = (curLevelData.MaxScore - MinScore);\r\n\r\n        var prePercent = (preScore - MinScore) / offsetScore;\r\n\r\n        var curPercent = (curScore - MinScore) / offsetScore;\r\n\r\n        this.scrollToPercent(prePercent, curPercent, 0.3);\r\n\r\n    },\r\n\r\n    getLeftLeaveTime: function () {\r\n        return this.m_leftTime;\r\n    },\r\n\r\n    setHuType: function () {\r\n        var frame;\r\n\r\n        //软自摸\r\n        if (this.m_huType == GameDefs.EndStatus.RuanPai) {\r\n            frame = this.m_ruanZiMoFrame;\r\n        }\r\n\r\n        //硬自摸\r\n        else if (this.m_huType == GameDefs.EndStatus.RuanPai) {\r\n            frame = this.m_yingZiMoFrame;\r\n        }\r\n\r\n        //软癞油\r\n        else if (this.m_huType == GameDefs.EndStatus.RuanPai) {\r\n            frame = this.m_ruanLaiYouFrame;\r\n        }\r\n\r\n        //硬癞油\r\n        else if (this.m_huType == GameDefs.EndStatus.RuanPai) {\r\n            frame = this.m_yingLaiYouFrame;\r\n        }\r\n\r\n        //油中油\r\n        else if (this.m_huType == GameDefs.EndStatus.RuanPai) {\r\n            frame = this.m_youZhongYouFrame;\r\n        }\r\n\r\n        if (!frame) {\r\n            return;\r\n        }\r\n\r\n        this.hu_type.node.active = true;\r\n        this.hu_type.spriteFrame = frame;\r\n    },\r\n\r\n    //设定胡牌翻数\r\n    setHuFan: function () {\r\n        this.hu_fan.string = this.m_fanNum;\r\n    },\r\n\r\n    setLaiyouZi: function () {\r\n        if (this.m_laiyouValue == undefined || this.m_laiyouValue == null) {\r\n            return;\r\n        }\r\n        var frameName = Resources.get_frameName(\"hh_dao_\", this.m_laiyouValue);\r\n\r\n        var frame = this.node.parent.getComponent(\"MjResourceMgr\").mj1_face_dao.getSpriteFrame(frameName);\r\n\r\n        if (frame) {\r\n            this.laiyou_mj.spriteFrame = frame;\r\n        }\r\n    },\r\n\r\n    //开始离开房间的按钮\r\n    startLeftTimer: function () {\r\n        var leftTimerNode = this.node.getChildByName(\"ready_btn\").getChildByName(\"leave_timer\");\r\n        leftTimerNode.active = true;\r\n        leftTimerNode.getComponent(cc.Label).string = \"(\" + this.m_leftTime + \")\";\r\n\r\n        var self = this;\r\n        var callback = function () {\r\n            if (self.m_leftTimerStop) {\r\n                return;\r\n            }\r\n\r\n            self.m_leftTime -= 1;\r\n            var label = leftTimerNode.getComponent(cc.Label);\r\n            label.string = \"(\" + self.m_leftTime + \")\";\r\n\r\n            if (self.m_leftTime > 0) {\r\n                TSCommon.performWithDelay(self, callback, 1);\r\n            }\r\n            else {\r\n                leftTimerNode.getComponent(cc.Label).string = \"\";\r\n                leftTimerNode.active = false;\r\n                require('GameLibSink').getInstance().getGameLib().leaveGameRoom();\r\n            }\r\n        }\r\n\r\n        TSCommon.performWithDelay(this, callback, 1);\r\n    },\r\n\r\n    stopLeftTimer: function () {\r\n        this.m_leftTimerStop = true;\r\n    },\r\n\r\n    onLeaveGameClicked: function () {\r\n        require('GameLibSink').getInstance().getGameLib().leaveGameRoom();\r\n    },\r\n\r\n    onDetailResultClicked: function () {\r\n        if (this.m_showDetailResult) {\r\n            this.m_showDetailResult();\r\n        }\r\n    },\r\n\r\n    onPrepareClicked: function () {\r\n        G.matchGameReady = true;\r\n        require('GameLibSink').getInstance().getGameLib().leaveGameRoom();\r\n    },\r\n\r\n});\r\n"]}