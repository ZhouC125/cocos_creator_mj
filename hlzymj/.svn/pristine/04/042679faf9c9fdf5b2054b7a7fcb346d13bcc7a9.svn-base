{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\desk/assets\\scripts\\hall\\game\\desk\\OutCardLayer.js"],"names":["GameDefs","require","GameCfg","cc","Class","extends","Component","properties","onLoad","TSCommon","addEvent","selectedMj","onSelectedMj","unSelectedMj","onUnSelectedMj","init","loadRes","onDestroy","removeEvent","event","mjValue","data","outCardsNode","node","getChildByName","i","childrenCount","children","active","cardValue","color","Color","LINE_MAX","m_outMjs","Array","m_lastOutCardNode","m_playerMj","initUI","laiziNode","self","loader","loadResDir","err","assets","zuanshiAssets","setmjLaiziValue","laiziValue","m_laiziValue","setmjLaizipiValue","laizipiValue","m_laizipiValue","setPlayerMj","playerMj","setPlayerPos","nPos","m_nPos","putOutMj","outMjValue","addSelfOutCard","addRightOutCard","showOutCard","addTopOutCard","addLeftOutCard","outMjNode","Node","addChild","pos","p","x","y","sprite","addComponent","Sprite","spriteFrame","parent","getComponent","get_face_li_SpriteFrame","delayTime","fadeOut","onEnd","removeFromParent","callback","callFunc","sequence","runAction","getLastOutCard","addZuanShiTexiao","zuanshiNode","dragonDisplay","dragonBones","ArmatureDisplay","DragonBonesAsset","dragonAsset","DragonBonesAtlasAsset","dragonAtlasAsset","armatureName","playAnimation","outCardCount","nStartX","nStartY","distanceX","outCardNode","MAX_MJ_INDEX","cbOutCards","length","removeAllChildren","get_face_dao_spriteFrame","distanceY","setLocalZOrder","get_face_z_SpriteFrame","lineNum","setScale","get_face_y_SpriteFrame","doCards","addOutLaiZi","nLaiZiNum","nLaiZiMjValue","MjResourceMgr","setAllOutCardIsVis","bIsVis","gameOver","cleanAllMjs"],"mappings":"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","file":"OutCardLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\desk","sourcesContent":["var GameDefs = require(\"GameDefs\");\r\n\r\nimport { TSCommon } from \"../../TSCommon\";\r\nvar GameCfg = require(\"GameCfg\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n    },\r\n\r\n    onLoad: function () {\r\n        TSCommon.addEvent(GameCfg.selectedMj, this.onSelectedMj, this);\r\n\r\n        TSCommon.addEvent(GameCfg.unSelectedMj, this.onUnSelectedMj, this);\r\n\r\n        this.init();\r\n\r\n        this.loadRes();\r\n    },\r\n\r\n    onDestroy: function () {\r\n        TSCommon.removeEvent(GameCfg.selectedMj, this.onSelectedMj, this);\r\n\r\n        TSCommon.removeEvent(GameCfg.unSelectedMj, this.onUnSelectedMj, this);\r\n    },\r\n\r\n    onSelectedMj: function (event) {\r\n\r\n        var mjValue = event.data;\r\n        var outCardsNode = this.node.getChildByName(\"outcards\");\r\n        for (var i = 0; i < outCardsNode.childrenCount; i++) {\r\n            if (outCardsNode.children[i].active && outCardsNode.children[i].cardValue == mjValue) {\r\n                outCardsNode.children[i].color = new cc.Color(150, 150, 227);\r\n            }\r\n        }\r\n    },\r\n\r\n    onUnSelectedMj: function () {\r\n        var outCardsNode = this.node.getChildByName(\"outcards\");\r\n        for (var i = 0; i < outCardsNode.childrenCount; i++) {\r\n            if (outCardsNode.children[i].active) {\r\n                outCardsNode.children[i].color = new cc.Color(255, 255, 255);\r\n            }\r\n        }\r\n    },\r\n\r\n    init: function () {\r\n        this.LINE_MAX = 6;\r\n        this.m_outMjs = new Array();\r\n        this.m_lastOutCardNode = new Array();\r\n        this.m_playerMj = new Array();\r\n    \r\n    },\r\n    \r\n    initUI: function () {\r\n\r\n        var outCardsNode = this.node.getChildByName(\"outcards\");\r\n        for (var i = 0; i < outCardsNode.childrenCount; i++) {\r\n            outCardsNode.children[i].active = false;\r\n        }\r\n\r\n        var laiziNode = this.node.getChildByName(\"zhonglaigang\");\r\n        for (var i = 0; i < laiziNode.childrenCount; i++) {\r\n            laiziNode.children[i].active = false;\r\n        }\r\n    },\r\n\r\n    loadRes: function () {\r\n        var self = this;\r\n        cc.loader.loadResDir(\"animation/dragonBones/zuanshi\", function (err, assets) {\r\n            if (!err) {\r\n                self.zuanshiAssets = assets;\r\n            }\r\n        })\r\n    },\r\n\r\n    setmjLaiziValue: function (laiziValue) {\r\n        this.m_laiziValue = laiziValue;\r\n    },\r\n\r\n    //设定癞子皮\r\n    setmjLaizipiValue: function (laizipiValue) {\r\n        this.m_laizipiValue = laizipiValue;\r\n    },\r\n\r\n    setPlayerMj: function (playerMj) {\r\n        this.m_playerMj = playerMj;\r\n    },\r\n\r\n    setPlayerPos: function (nPos) {\r\n        this.m_nPos = nPos;\r\n    },\r\n\r\n    putOutMj: function (outMjValue) {\r\n        if (this.m_nPos == 1) {\r\n            this.addSelfOutCard(outMjValue);\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            this.addRightOutCard(outMjValue);\r\n            this.showOutCard(outMjValue)\r\n        }\r\n        else if (this.m_nPos == 3) {\r\n            this.addTopOutCard(outMjValue);\r\n            this.showOutCard(outMjValue)\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            this.addLeftOutCard(outMjValue);\r\n            this.showOutCard(outMjValue)\r\n        }\r\n    },\r\n\r\n    showOutCard: function (outMjValue) {\r\n        var outMjNode = new cc.Node();\r\n\r\n        this.node.addChild(outMjNode, 100);\r\n\r\n        var pos;\r\n\r\n        if (this.m_nPos == 2) {\r\n            pos = cc.p(356, 40);\r\n        }\r\n        else if (this.m_nPos == 3) {\r\n            pos = cc.p(0, 258);\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            pos = cc.p(-356, 40);\r\n        }\r\n\r\n        outMjNode.x = pos.x;\r\n        outMjNode.y = pos.y;\r\n\r\n        var sprite = outMjNode.addComponent(cc.Sprite)\r\n\r\n        sprite.spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").get_face_li_SpriteFrame(\"mj1\", outMjValue);\r\n\r\n        //直接出现  等待 0.5  0.5内消失完毕\r\n\r\n        outMjNode.active = true;\r\n\r\n        var delayTime = cc.delayTime(0.5);\r\n\r\n        var fadeOut = cc.fadeOut(0.5);\r\n\r\n        var onEnd = function () {\r\n            outMjNode.removeFromParent(true);\r\n        }\r\n\r\n        var callback = cc.callFunc(onEnd)\r\n\r\n        var sequence = cc.sequence(delayTime, fadeOut, callback);\r\n\r\n        outMjNode.runAction(sequence);\r\n    },\r\n\r\n    getLastOutCard: function () {\r\n\r\n        /*\r\n        var outCardNode = this.node.getChildByName(\"outcards\");\r\n        var outCardCount = 0;\r\n        for (var i = 0; i < outCardNode.childrenCount; i++) {\r\n            if (outCardNode.children[i].cardValue && outCardNode.children[i].cardValue < GameDefs.MAX_MJ_INDEX) {\r\n                outCardCount = outCardCount + 1;\r\n            }\r\n        }\r\n    \r\n        console.log(\"outCardCount ==========\" + outCardCount);\r\n    \r\n        if (this.m_nPos == 2 || this.m_nPos == 3)\r\n            return outCardNode.children[0];\r\n    \r\n        else if(this.m_nPos == 4){\r\n            var lastOutNode =outCardNode.children[0 + (outCardCount - 1) % this.LINE_MAX];\r\n            cc.log(\"最后出的牌的牌值为:\" + lastOutNode.cardValue);\r\n            return outCardNode.children[0 + (outCardCount - 1) % this.LINE_MAX];\r\n        }\r\n        else{\r\n            var lastOutNode = outCardNode.children[outCardCount - 1];\r\n            cc.log(\"最后出的牌的牌值为:\" + lastOutNode.cardValue);\r\n            return outCardNode.children[outCardCount - 1];    \r\n        }\r\n        */\r\n    \r\n        if(this.m_lastOutCardNode && this.m_lastOutCardNode[this.m_nPos]){\r\n            return this.m_lastOutCardNode[this.m_nPos];\r\n        }\r\n    },\r\n\r\n\r\n    addZuanShiTexiao: function (node) {\r\n        var zuanshiNode = new cc.Node();\r\n        zuanshiNode.active = true;\r\n        zuanshiNode.x = 0;\r\n        zuanshiNode.y = 0;\r\n        if (this.m_nPos == 1 || this.m_nPos == 3) {\r\n            zuanshiNode.y = 10;\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            zuanshiNode.y = 13;\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            zuanshiNode.y = 13;\r\n        }\r\n        var dragonDisplay = zuanshiNode.addComponent(dragonBones.ArmatureDisplay);\r\n\r\n        for (var i in this.zuanshiAssets) {\r\n            if (this.zuanshiAssets[i] instanceof dragonBones.DragonBonesAsset) {\r\n                dragonDisplay.dragonAsset = this.zuanshiAssets[i];\r\n            }\r\n            if (this.zuanshiAssets[i] instanceof dragonBones.DragonBonesAtlasAsset) {\r\n                dragonDisplay.dragonAtlasAsset = this.zuanshiAssets[i];\r\n            }\r\n        }\r\n\r\n        dragonDisplay.armatureName = 'armatureName';\r\n        dragonDisplay.playAnimation('Animation1');\r\n        node.addChild(zuanshiNode);\r\n    },\r\n\r\n    addSelfOutCard: function (outMjValue) {\r\n        var outCardCount = 0;\r\n        var nStartX = -125;\r\n        var nStartY = -43;\r\n        var distanceX = 47;\r\n        var outCardNode = this.node.getChildByName(\"outcards\");\r\n\r\n        for (var i = 0; i < outCardNode.childrenCount; i++) {\r\n            outCardNode.children[i].active = false;\r\n            outCardNode.children[i].cardValue = GameDefs.MAX_MJ_INDEX;\r\n        }\r\n\r\n        for (var i = 0; i < this.m_playerMj.cbOutCards.length; i++) {\r\n            if (this.m_playerMj.cbOutCards[i] < GameDefs.MAX_MJ_INDEX) {\r\n                outCardCount = outCardCount + 1;\r\n            }\r\n        }\r\n\r\n\r\n        for (var i = 0; i < outCardCount; i++) {\r\n            if (outCardNode.children[i]) {\r\n                // var spriteFrameName = this.getSpriteFrameNameByMjValue(1, this.m_playerMj.cbOutCards[i]);\r\n                outCardNode.children[i].removeAllChildren();\r\n                var spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").get_face_dao_spriteFrame(\"mj1\", this.m_playerMj.cbOutCards[i]);\r\n                outCardNode.children[i].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                outCardNode.children[i].active = true;\r\n                outCardNode.children[i].cardValue = this.m_playerMj.cbOutCards[i];\r\n                if (outCardNode.children[i] == null)\r\n                    break;\r\n\r\n                if (i < this.LINE_MAX) {\r\n                    outCardNode.children[i].x = nStartX + i * distanceX\r\n                    outCardNode.children[i].y = nStartY;\r\n                }\r\n                else if (i >= this.LINE_MAX && i < this.LINE_MAX * 2) {\r\n                    outCardNode.children[i].x = nStartX + (i - this.LINE_MAX) * distanceX\r\n                    outCardNode.children[i].y = nStartY - 50;\r\n                }\r\n                else if (i >= this.LINE_MAX * 2 && i < this.LINE_MAX * 3) {\r\n                    outCardNode.children[i].x = nStartX + (i - this.LINE_MAX * 2) * distanceX\r\n                    outCardNode.children[i].y = nStartY - 100;\r\n                }\r\n\r\n            \r\n                //出的牌如果是癞子皮\r\n                // if (this.m_playerMj.cbOutCards[i] == this.m_laizipiValue){\r\n                //     var laizipiNode = new cc.Node();\r\n                //     var laizipiSprite = laizipiNode.addComponent(cc.Sprite);\r\n                //     laizipiSprite.spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_metop_gang_cao;\r\n                    \r\n                //     var outCardSize = outCardNode.children[i].getContentSize();\r\n                //     var laizipiSize = laizipiNode.getContentSize();\r\n                //     laizipiNode.x = outCardSize.width / 2 - laizipiSize.width / 2 - 4;\r\n                //     laizipiNode.y = outCardSize.height / 2 - laizipiSize.height / 2 - 2;\r\n\r\n                //     outCardNode.children[i].addChild(laizipiNode);\r\n                // }\r\n\r\n                if (outMjValue && i == outCardCount - 1 && this.m_playerMj.cbOutCards[i] == outMjValue) {\r\n                    this.addZuanShiTexiao(outCardNode.children[i])\r\n                }\r\n                \t\r\n                if(i == outCardCount - 1){\r\n                    this.m_lastOutCardNode[this.m_nPos] =  outCardNode.children[i];\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    addLeftOutCard: function (outMjValue) {\r\n        var outCardCount = 0;\r\n        var nStartX = -168;\r\n        var nStartY = 154;\r\n        var distanceX = 55;\r\n        var distanceY = 36;\r\n\r\n        var outCardNode = this.node.getChildByName(\"outcards\");\r\n        for (var i = 0; i < outCardNode.childrenCount; i++) {\r\n            outCardNode.children[i].active = false;\r\n            outCardNode.children[i].cardValue = GameDefs.MAX_MJ_INDEX;\r\n            outCardNode.children[i].setLocalZOrder(outCardNode.childrenCount);\r\n        }\r\n\r\n        for (var i = 0; i < this.m_playerMj.cbOutCards.length; i++) {\r\n            if (this.m_playerMj.cbOutCards[i] < GameDefs.MAX_MJ_INDEX) {\r\n                outCardCount = outCardCount + 1;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < outCardCount; i++) {\r\n            if (outCardNode.children[i]) {\r\n\r\n                outCardNode.children[i].removeAllChildren();\r\n                // var spriteFrameName = this.getSpriteFrameNameByMjValue(4,  this.m_playerMj.cbOutCards[i]);\r\n                var spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").get_face_z_SpriteFrame(\"mj1\", this.m_playerMj.cbOutCards[i]);\r\n                outCardNode.children[i].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                outCardNode.children[i].active = true;\r\n                outCardNode.children[i].cardValue = this.m_playerMj.cbOutCards[i];\r\n                if (outCardNode.children[i] == null)\r\n                    break;\r\n\r\n                var lineNum = 0;\r\n\r\n                if (i < this.LINE_MAX) {\r\n                    outCardNode.children[i].x = nStartX - i * 3;\r\n                    outCardNode.children[i].y = nStartY - i * distanceY;\r\n                    lineNum = 1;\r\n                }\r\n                else if (i >= this.LINE_MAX && i < this.LINE_MAX * 2) {\r\n                    outCardNode.children[i].x = nStartX - distanceX - (i - this.LINE_MAX) * 3;\r\n                    outCardNode.children[i].y = nStartY - (i - this.LINE_MAX) * distanceY;\r\n                    lineNum = 2;\r\n                }\r\n                else if (i >= this.LINE_MAX * 2 && i < this.LINE_MAX * 3) {\r\n                    outCardNode.children[i].x = nStartX - distanceX * 2 - (i - this.LINE_MAX * 2) * 3;\r\n                    outCardNode.children[i].y = nStartY - (i - this.LINE_MAX * 2) * distanceY;\r\n                    lineNum = 3;\r\n                }\r\n\r\n                //出的牌如果是癞子皮\r\n                // if (this.m_playerMj.cbOutCards[i] == this.m_laizipiValue){\r\n                //     var laizipiNode = new cc.Node();\r\n                //     var laizipiSprite = laizipiNode.addComponent(cc.Sprite);\r\n                //     laizipiSprite.spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_left_gang_cao;\r\n\r\n                //     var outCardSize = outCardNode.children[i].getContentSize();\r\n                //     var laizipiSize = laizipiNode.getContentSize();\r\n                //     laizipiNode.x = (outCardSize.width / 2 - laizipiSize.width / 2) - 6;\r\n                //     laizipiNode.y = -(outCardSize.height / 2 - laizipiSize.height / 2) + 18;\r\n                //     outCardNode.children[i].addChild(laizipiNode);\r\n                // }\r\n\r\n                if (outMjValue && i == outCardCount - 1 && this.m_playerMj.cbOutCards[i] == outMjValue) {\r\n                    this.addZuanShiTexiao(outCardNode.children[i])\r\n                }\r\n\r\n\r\n                outCardNode.children[i].setLocalZOrder(outCardNode.childrenCount - lineNum * this.LINE_MAX + (i % this.LINE_MAX));\r\n                // outCardNode.children[i].setLocalZOrder(outCardNode.childrenCount - lineNum * this.LINE_MAX);\r\n                \t\r\n                if(i == outCardCount - 1){\r\n                    this.m_lastOutCardNode[this.m_nPos] =  outCardNode.children[i];\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    addTopOutCard: function (outMjValue) {\r\n        var outCardCount = 0;\r\n        var nStartX = 83;\r\n        var nStartY = 157;\r\n        var distanceX = 36;\r\n        // var distanceY = 36;\r\n\r\n        var outCardNode = this.node.getChildByName(\"outcards\");\r\n        for (var i = 0; i < outCardNode.childrenCount; i++) {\r\n            outCardNode.children[i].active = false;\r\n            outCardNode.children[i].cardValue = GameDefs.MAX_MJ_INDEX;\r\n        }\r\n\r\n        for (var i = 0; i < this.m_playerMj.cbOutCards.length; i++) {\r\n            if (this.m_playerMj.cbOutCards[i] < GameDefs.MAX_MJ_INDEX) {\r\n                outCardCount = outCardCount + 1;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < outCardCount; i++) {\r\n            if (outCardNode.children[i]) {\r\n                outCardNode.children[i].removeAllChildren();\r\n                // var spriteFrameName = this.getSpriteFrameNameByMjValue(1,  this.m_playerMj.cbOutCards[i]);\r\n                var spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").get_face_dao_spriteFrame(\"mj1\", this.m_playerMj.cbOutCards[i]);\r\n                outCardNode.children[i].getComponent(cc.Sprite).spriteFrame = spriteFrame\r\n                outCardNode.children[i].active = true;\r\n                outCardNode.children[i].cardValue = this.m_playerMj.cbOutCards[i];\r\n                if (outCardNode.children[i] == null)\r\n                    break;\r\n\r\n                if (i < this.LINE_MAX) {\r\n                    outCardNode.children[i].x = nStartX - i * distanceX;\r\n                    outCardNode.children[i].y = nStartY;\r\n                }\r\n                else if (i >= this.LINE_MAX && i < this.LINE_MAX * 2) {\r\n                    outCardNode.children[i].x = nStartX - (i - this.LINE_MAX) * distanceX;\r\n                    outCardNode.children[i].y = nStartY + 42;\r\n                }\r\n                else if (i >= this.LINE_MAX * 2 && i < this.LINE_MAX * 3) {\r\n                    outCardNode.children[i].x = nStartX - (i - this.LINE_MAX * 2) * distanceX;\r\n                    outCardNode.children[i].y = nStartY + 42 * 2;\r\n                }\r\n\r\n                \r\n                //出的牌如果是癞子皮\r\n                // if (this.m_playerMj.cbOutCards[i] == this.m_laizipiValue){\r\n                //     var laizipiNode = new cc.Node();\r\n                //     var laizipiSprite = laizipiNode.addComponent(cc.Sprite);\r\n                //     laizipiSprite.spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_metop_gang_cao;\r\n                    \r\n                //     var outCardSize = outCardNode.children[i].getContentSize();\r\n                //     var laizipiSize = laizipiNode.getContentSize();\r\n                //     laizipiNode.x = outCardSize.width / 2 - laizipiSize.width / 2 - 4;\r\n                //     laizipiNode.y = outCardSize.height / 2 - laizipiSize.height / 2 - 2;\r\n\r\n                //     outCardNode.children[i].addChild(laizipiNode);\r\n                // }\r\n\r\n\r\n                if (outMjValue && i == outCardCount - 1 && this.m_playerMj.cbOutCards[i] == outMjValue) {\r\n                    this.addZuanShiTexiao(outCardNode.children[i])\r\n                }\r\n\r\n                outCardNode.children[i].setScale(0.77)\r\n                outCardNode.children[i].setLocalZOrder(outCardNode.childrenCount - i);\r\n                                    \r\n                if(i == outCardCount - 1){\r\n                    this.m_lastOutCardNode[this.m_nPos] =  outCardNode.children[i];\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    addRightOutCard: function (outMjValue) {\r\n        var outCardCount = 0;\r\n        var nStartX = 173;\r\n        var nStartY = -26;\r\n        var distanceX = 55;\r\n        var distanceY = 36;\r\n\r\n        var outCardNode = this.node.getChildByName(\"outcards\");\r\n        for (var i = 0; i < outCardNode.childrenCount; i++) {\r\n            outCardNode.children[i].active = false;\r\n            outCardNode.children[i].cardValue = GameDefs.MAX_MJ_INDEX;\r\n        }\r\n\r\n        for (var i = 0; i < this.m_playerMj.cbOutCards.length; i++) {\r\n            if (this.m_playerMj.cbOutCards[i] < GameDefs.MAX_MJ_INDEX) {\r\n                outCardCount = outCardCount + 1;\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < outCardCount; i++) {\r\n            if (outCardNode.children[i]) {\r\n                outCardNode.children[i].removeAllChildren();\r\n                // var spriteFrameName = this.getSpriteFrameNameByMjValue(2,  this.m_playerMj.cbOutCards[i]);\r\n                var spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").get_face_y_SpriteFrame(\"mj1\", this.m_playerMj.cbOutCards[i]);\r\n                outCardNode.children[i].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                outCardNode.children[i].active = true;\r\n                outCardNode.children[i].cardValue = this.m_playerMj.cbOutCards[i];\r\n                if (outCardNode.children[i] == null)\r\n                    break;\r\n\r\n                if (i < this.LINE_MAX) {\r\n                    outCardNode.children[i].x = nStartX - i * 3;\r\n                    outCardNode.children[i].y = nStartY + i * distanceY;\r\n                }\r\n                else if (i >= this.LINE_MAX && i < this.LINE_MAX * 2) {\r\n                    outCardNode.children[i].x = nStartX + distanceX - (i - this.LINE_MAX) * 3;\r\n                    outCardNode.children[i].y = nStartY + (i - this.LINE_MAX) * distanceY;\r\n                }\r\n                else if (i >= this.LINE_MAX * 2 && i < this.LINE_MAX * 3) {\r\n                    outCardNode.children[i].x = nStartX + distanceX * 2 - (i - this.LINE_MAX * 2) * distanceX;\r\n                    outCardNode.children[i].y = nStartY + (i - this.LINE_MAX * 2) * distanceY;\r\n                }\r\n\r\n                if (outMjValue && i == outCardCount - 1 && this.m_playerMj.cbOutCards[i] == outMjValue) {\r\n                    this.addZuanShiTexiao(outCardNode.children[i])\r\n                }\r\n\r\n                 //出的牌如果是癞子皮\r\n                // if (this.m_playerMj.cbOutCards[i] == this.m_laizipiValue){\r\n                //     var laizipiNode = new cc.Node();\r\n                //     var laizipiSprite = laizipiNode.addComponent(cc.Sprite);\r\n                //     laizipiSprite.spriteFrame = this.node.parent.getComponent(\"MjResourceMgr\").m_mj_right_gang_cao;\r\n                    \r\n                //     var outCardSize = outCardNode.children[i].getContentSize();\r\n                //     var laizipiSize = laizipiNode.getContentSize();\r\n                //     laizipiNode.x = -(outCardSize.width / 2 - laizipiSize.width / 2) + 6;\r\n                //     laizipiNode.y = outCardSize.height / 2 - laizipiSize.height / 2 - 8;\r\n\r\n                //     outCardNode.children[i].addChild(laizipiNode);\r\n                // }\r\n\r\n                outCardNode.children[i].setLocalZOrder(outCardNode.childrenCount - i);\r\n                \t\r\n                if(i == outCardCount - 1){\r\n                    this.m_lastOutCardNode[this.m_nPos] =  outCardNode.children[i];\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    doCards: function () {\r\n        if (this.m_nPos == 1) {\r\n            this.addSelfOutCard();\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            this.addRightOutCard();\r\n        }\r\n        else if (this.m_nPos == 3) {\r\n            this.addTopOutCard();\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            this.addLeftOutCard();\r\n        }\r\n        // this.addOutLaiZi(this.m_playerMj.cbCountLaiziGang, this.m_laiziValue);\r\n    },\r\n\r\n    //添加打出去的癞子的牌值\r\n    addOutLaiZi: function (nLaiZiNum, nLaiZiMjValue) {\r\n        var laiziNode = this.node.getChildByName(\"zhonglaigang\");\r\n\r\n        var MjResourceMgr = this.node.parent.getComponent(\"MjResourceMgr\")\r\n        var spriteFrame;\r\n        if (this.m_nPos == 1) {\r\n\r\n            spriteFrame = MjResourceMgr.get_face_dao_spriteFrame(\"mj1\", nLaiZiMjValue);\r\n        }\r\n        else if (this.m_nPos == 2) {\r\n            spriteFrame = MjResourceMgr.get_face_y_SpriteFrame(\"mj1\", nLaiZiMjValue);\r\n        }\r\n        else if (this.m_nPos == 3) {\r\n            spriteFrame = MjResourceMgr.get_face_dao_spriteFrame(\"mj1\", nLaiZiMjValue);\r\n        }\r\n        else if (this.m_nPos == 4) {\r\n            spriteFrame = MjResourceMgr.get_face_z_SpriteFrame(\"mj1\", nLaiZiMjValue);\r\n        }\r\n\r\n\r\n        for (var i = 0; i < nLaiZiNum; i++) {\r\n            if (spriteFrame) {\r\n                laiziNode.children[i].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                laiziNode.children[i].active = true;\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    //设定所有出的牌的可见性\r\n    setAllOutCardIsVis: function (bIsVis) {\r\n        var outCardCount = 0;\r\n\r\n        var outCardNode = this.node.getChildByName(\"outcards\");\r\n\r\n        for (var i = 0; i < outCardNode.childrenCount; i++) {\r\n            outCardNode.children[i].active = false;\r\n        }\r\n\r\n        if(this.m_playerMj && this.m_playerMj.cbOutCards){\r\n            for (var i = 0; i < this.m_playerMj.cbOutCards.length; i++) {\r\n                if (this.m_playerMj.cbOutCards[i] < GameDefs.MAX_MJ_INDEX) {\r\n                    outCardCount = outCardCount + 1;\r\n                }\r\n            }\r\n        }\r\n        \r\n\r\n        for (var i = 0; i < outCardCount; i++) {\r\n            outCardNode.children[i].active = bIsVis;\r\n        }\r\n\r\n        //修改癞子杠的\r\n        var laiziNode = this.node.getChildByName(\"zhonglaigang\");\r\n        for (var i = 0; i < laiziNode.childrenCount; i++) {\r\n            laiziNode.children[i].active = false;\r\n        }\r\n    },\r\n\r\n    gameOver: function () {\r\n        this.setAllOutCardIsVis();\r\n    },\r\n\r\n    cleanAllMjs: function () {\r\n        this.setAllOutCardIsVis(false);\r\n    }\r\n});\r\n"]}