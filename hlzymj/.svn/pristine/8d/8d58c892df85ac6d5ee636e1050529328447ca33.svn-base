{"version":3,"sources":["RangeCardLayer.js"],"names":["Resources","require","GameDefs","GameCfg","Res","cc","Class","extends","Component","properties","onLoad","TSCommon","addEvent","selectedMj","onSelectedMj","unSelectedMj","onUnSelectedMj","onDestroy","removeEvent","init","weaveKind","weaveItem","nPos","spriteFrame","doCards","event","mjValue","data","i","node","children","active","cardValue","color","Color","getSpriteFrameNameByMjValueAndPos","foreName","name","get_frameName","getSpriteSpriteFrameByNameAndPos","getSpriteFrame","addLaiziOrLaizipiIcon","mjNode","removeAllChildren","Canvas","director","getScene","getChildByName","MjResourceMgr","getComponent","WeaveType","Peng","ShunLeft","ShunMid","ShunRight","Sprite","MingGang","XuGang","AnGang"],"mappings":"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","file":"RangeCardLayer.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\hall\\game\\desk","sourcesContent":["var Resources = require(\"Resources\");\r\nvar GameDefs = require(\"GameDefs\");\r\nimport {TSCommon} from \"../../TSCommon\";\r\nvar GameCfg = require(\"GameCfg\");\r\nvar Res\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        \r\n    },\r\n\r\n    onLoad:function() {\r\n        TSCommon.addEvent(GameCfg.selectedMj, this.onSelectedMj, this);\r\n\r\n        TSCommon.addEvent(GameCfg.unSelectedMj, this.onUnSelectedMj, this);\r\n    },\r\n\r\n    onDestroy:function(){\r\n        TSCommon.removeEvent(GameCfg.selectedMj, this.onSelectedMj, this);\r\n\r\n        TSCommon.removeEvent(GameCfg.unSelectedMj, this.onUnSelectedMj, this);\r\n    },\r\n\r\n    init:function(weaveKind, weaveItem, nPos, spriteFrame){//, laiziValue, laizipiValue) {\r\n        this.weaveKind = weaveKind;\r\n        this.weaveItem = weaveItem;\r\n        this.nPos = nPos;\r\n\r\n        this.spriteFrame = spriteFrame;\r\n\r\n        // this.laiziValue = laiziValue;\r\n\r\n        // this.laizipiValue = laizipiValue;\r\n\r\n        this.doCards()\r\n    },\r\n\r\n    onSelectedMj:function(event){\r\n        var mjValue = event.data;\r\n        for(var i = 0; i < 4; i++){\r\n            if(this.node.children[i].active && this.node.children[i].cardValue == mjValue){\r\n                this.node.children[i].color =  new cc.Color(150, 150, 227);\r\n            }\r\n        }\r\n    },\r\n\r\n    onUnSelectedMj:function(event){\r\n        for(var i = 0; i < 4; i++){\r\n            if(this.node.children[i].active){\r\n                this.node.children[i].color =  new cc.Color(255, 255, 255);\r\n            }\r\n        }\r\n    },\r\n\r\n    getSpriteFrameNameByMjValueAndPos:function(mjValue, nPos){\r\n        var foreName = null;\r\n        var name = null;\r\n        if(nPos == 1 || nPos == 3){\r\n            foreName = \"hh_dao_\";\r\n        }\r\n        else if(nPos == 2){\r\n            foreName = \"hh_suit_y_\";\r\n        }\r\n        else if(nPos == 4){\r\n            foreName = \"hh_suit_z_\";\r\n        }\r\n\r\n        return Resources.get_frameName(foreName, mjValue);\r\n    },\r\n\r\n    getSpriteSpriteFrameByNameAndPos:function(name, nPos){\r\n\r\n        return this.spriteFrame.getSpriteFrame(name);\r\n    },\r\n\r\n\r\n    addLaiziOrLaizipiIcon:function(mjNode, mjValue){\r\n        mjNode.removeAllChildren();\r\n        var Canvas =  cc.director.getScene().getChildByName('Canvas');\r\n        var MjResourceMgr = Canvas.getComponent(\"MjResourceMgr\");\r\n        //如果是癞子\r\n        // if(mjValue == this.laiziValue || mjValue == this.laizipiValue){\r\n        //     var laiziIcon = new cc.Node();\r\n        //     var sprite = laiziIcon.addComponent(cc.Sprite);\r\n\r\n        //     if(this.nPos == 1){\r\n                \r\n        //         var frame;\r\n        //         if(mjValue == this.m_laiziValue){\r\n        //             frame = MjResourceMgr.m_mj_metop_gang_lai;\r\n        //         }\r\n        //         else{\r\n        //             frame = MjResourceMgr.m_mj_metop_gang_cao;\r\n        //         }\r\n\r\n        //         sprite.spriteFrame = frame;\r\n\r\n        //         laiziIcon.x = laiziIcon.getContentSize().width / 2 - 5;\r\n        //         laiziIcon.y = mjNode.getContentSize().height / 2 - laiziIcon.getContentSize().height / 2 - 3;\r\n        //         mjNode.addChild(laiziIcon);\r\n        //     }\r\n        //     else if(this.nPos == 2){\r\n        //         var frame;\r\n        //         if(mjValue == this.m_laiziValue){\r\n        //             frame = MjResourceMgr.m_mj_right_lai;\r\n        //         }\r\n        //         else{\r\n        //             frame = MjResourceMgr.m_mj_right_cao;\r\n        //         }\r\n\r\n        //         sprite.spriteFrame = frame;\r\n\r\n        //         laiziIcon.x = -(mjNode.getContentSize().width / 2 - laiziIcon.getContentSize().width / 2) + 15;\r\n        //         laiziIcon.y = mjNode.getContentSize().height / 2 - laiziIcon.getContentSize().height / 2 - 5;\r\n\r\n        //         mjNode.addChild(laiziIcon);\r\n        //     }\r\n        //     else if(this.nPos == 3){\r\n        //         var frame;\r\n        //         if(mjValue == this.m_laiziValue){\r\n        //             frame = MjResourceMgr.m_mj_metop_gang_lai\r\n        //         }\r\n        //         else{\r\n        //             frame = MjResourceMgr.m_mj_metop_gang_cao\r\n        //         }\r\n\r\n        //         sprite.spriteFrame = frame;\r\n\r\n        //         laiziIcon.x = mjNode.getContentSize().width / 2 - laiziIcon.getContentSize().width / 2 - 3;\r\n        //         laiziIcon.y = mjNode.getContentSize().height / 2 - laiziIcon.getContentSize().height / 2 - 3;\r\n        //         mjNode.addChild(laiziIcon);\r\n        //     }\r\n        //     else if(this.nPos == 4){\r\n        //         var frame;\r\n        //         if(mjValue == this.m_laiziValue){\r\n        //             frame = MjResourceMgr.m_mj_left_gang_lai;\r\n        //         }\r\n        //         else{\r\n        //             frame = MjResourceMgr.m_mj_left_gang_cao;\r\n        //         }\r\n\r\n        //         sprite.spriteFrame = frame;\r\n\r\n        //         laiziIcon.x = mjNode.getContentSize().width / 2 - laiziIcon.getContentSize().width / 2 - 20;\r\n        //         laiziIcon.y = -(mjNode.getContentSize().height / 2 - laiziIcon.getContentSize().height / 2) + 20;\r\n        //         mjNode.addChild(laiziIcon);\r\n        //     }             \r\n        // } \r\n        // else{\r\n            mjNode.removeAllChildren();\r\n        // }                   \r\n    },\r\n\r\n    doCards:function(){\r\n        if(this.weaveKind == GameDefs.WeaveType.Peng || this.weaveKind == GameDefs.WeaveType.ShunLeft || \r\n            this.weaveKind == GameDefs.WeaveType.ShunMid || this.weaveKind == GameDefs.WeaveType.ShunRight){//} || \r\n            // this.weaveKind == GameDefs.WeaveType.ChaoTianMingGang || this.weaveKind == GameDefs.WeaveType.ChaoTianAnGang){\r\n            for(var i = 0; i < 4; i++){\r\n                if(i == 3){\r\n                    this.node.children[i].active = false;\r\n                    break;\r\n                }\r\n                else{\r\n                    this.node.children[i].active = true;\r\n                    var name = this.getSpriteFrameNameByMjValueAndPos(this.weaveItem[i], this.nPos)\r\n                    this.node.children[i].getComponent(cc.Sprite).spriteFrame = this.getSpriteSpriteFrameByNameAndPos(name, this.nPos);\r\n                    this.node.children[i].cardValue = this.weaveItem[i];\r\n\r\n                    this.addLaiziOrLaizipiIcon(this.node.children[i], this.weaveItem[i]);                    \r\n                }\r\n            }\r\n        }\r\n        else if(this.weaveKind == GameDefs.WeaveType.MingGang || this.weaveKind == GameDefs.WeaveType.XuGang || \r\n            this.weaveKind == GameDefs.WeaveType.AnGang){\r\n                for(var i = 0; i < 4; i++){\r\n                    this.node.children[i].active = true;\r\n                    var name = this.getSpriteFrameNameByMjValueAndPos(this.weaveItem[i], this.nPos)\r\n                    this.node.children[i].getComponent(cc.Sprite).spriteFrame = this.getSpriteSpriteFrameByNameAndPos(name, this.nPos)\r\n                    this.node.children[i].cardValue = this.weaveItem[i];\r\n\r\n                    this.addLaiziOrLaizipiIcon(this.node.children[i], this.weaveItem[i]);\r\n                }\r\n            }\r\n    },\r\n\r\n});\r\n"]}